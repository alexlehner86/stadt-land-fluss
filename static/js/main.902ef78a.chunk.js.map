{"version":3,"sources":["constants/themes.constant.ts","constants/game.constant.ts","components/Header/Header.tsx","components/SectionHeader/SectionHeader.tsx","containers/Dashboard/Dashboard.tsx","components/ToDashboardButton/ToDashboardButton.tsx","components/RejoinRunningGameHint/RejoinRunningGameHint.tsx","containers/GameManual/GameManual.tsx","utils/general.utils.ts","components/GameResultsList/GameResultsList.tsx","components/GameRoundsTable/GameRoundsTable.tsx","components/GameRoundsOverviewButton/GameRoundsOverviewButton.tsx","components/HallOfFameButton/HallOfFameButton.tsx","components/ScoringOptionsList/ScoringOptionsList.tsx","store/app.actions.ts","utils/game.utils.ts","containers/GameResults/GameResults.tsx","components/ChipsArray/ChipsArray.tsx","utils/local-storage.utils.ts","containers/JoinGame/JoinGame.tsx","components/AddCustomCategory/AddCustomCategory.tsx","containers/NewGame/NewGame.tsx","models/pub-nub-data.model.ts","components/AdminPanel/AdminPanel.tsx","components/LetterAnimation/LetterAnimation.tsx","components/LoadingScreen/LoadingScreen.tsx","components/GameRoundChip/GameRoundChip.tsx","components/PhaseEvaluateRound/PhaseEvaluateRound.tsx","components/PhaseFillOutTextfields/PhaseFillOutTextfields.tsx","components/JoinGameLink/JoinGameLink.tsx","components/PlayerList/PlayerList.tsx","components/PhaseWaitingToStart/PhaseWaitingToStart.tsx","components/PubNubEventHandler/PubNubEventHandler.tsx","config/pubnub.config.ts","utils/data-restoration.utils.ts","containers/PlayGame/PlayGame.tsx","App.tsx","constants/app.constant.ts","serviceWorker.ts","store/app.reducer.ts","index.tsx"],"names":["APP_THEME_ID","GamePhase","AppThemes","id","green","animationBackgroundColor","className","displayName","homepageImageUrl","process","muiTheme","createMuiTheme","palette","primary","secondary","red","style","background","blue","deepOrange","orange","indigo","pink","purple","amber","black","blueGrey","Header","state","anchorEl","version","handleManualButtonClick","props","history","push","handleThemePickerClick","event","setState","currentTarget","handleThemePickerMenuClose","handleThemePickerMenuItemClick","selectedTheme","switchTheme","playerNameParagraph","this","playerName","theme","href","target","rel","aria-label","IconButton","size","title","onClick","fontSize","aria-controls","aria-haspopup","Menu","keepMounted","open","Boolean","onClose","map","item","index","MenuItem","key","packageJson","Component","withRouter","connect","playerInfo","name","SectionHeader","Fragment","text","showDivider","Divider","Dashboard","rejoinGameElement","Link","component","RouterLink","to","gameId","src","activeTheme","alt","ToDashboardButton","Button","type","color","variant","startIcon","onReturnToDashboard","STANDARD_ALPHABET","STANDARD_EXCLUDED_LETTERS","STANDARD_CATEGORIES","AVAILABLE_CATEGORIES","RejoinRunningGameHintContext","GAME_OPTION_LABEL","checkForDuplicates","creativeAnswersExtraPoints","onlyPlayerWithValidAnswer","GameManual","returnToDashboard","convertDateToUnixTimestamp","dateToConvert","getTime","convertCollectionToMap","collectionToConvert","dataAsMap","Map","Object","keys","forEach","set","convertMapToCollection","mapToConvert","dataAsCollection","data","useStyles","makeStyles","listItem","flex","justifyContent","margin","listItemText","minWidth","GameResultsList","classes","mostPoints","Math","max","gameResults","result","points","List","ListItem","ListItemIcon","ListItemText","count","singular","plural","StyledTableCell","withStyles","createStyles","head","backgroundColor","main","contrastText","maxWidth","body","TableCell","StyledTableRow","root","action","hover","TableRow","tableContainer","borderRadius","table","firstColumn","fontWeight","invalidInput","textDecoration","creativeAnswerStarIcon","verticalAlign","GameRoundsTable","gameConfig","round","sortedPlayers","TableContainer","Paper","Table","TableHead","player","playerIndex","align","TableBody","categories","category","categoryIndex","scope","playerInput","get","valid","star","Tooltip","placement","veryCreativeAnswer","TabPanel","children","value","other","role","hidden","aria-labelledby","flexGrow","width","padding","paper","GameRoundsOverviewDialog","rounds","React","useState","tabValue","setTabValue","Dialog","DialogContent","AppBar","position","Tabs","onChange","newValue","indicatorColor","textColor","scrollButtons","_","Tab","label","a11yProps","DialogActions","GameRoundsOverviewButton","setOpen","list","paddingBottom","listItemAvatar","marginRight","HallOfFameDialog","hallOfFameData","DialogContentText","ListItemAvatar","Chip","icon","HallOfFameButton","disabled","length","ScoringOptionsList","rules","setDataForNewGame","payload","getRandomnLetters","numberOfLetters","possibleLetters","Error","randomnLetters","lettersToRandomnlySelectFrom","i","randomnLetter","randomnItem","filter","letter","getPlayersInAlphabeticalOrder","players","Array","from","sort","a","b","toLowerCase","getEmptyRoundInputs","numberOfInputs","fill","markEmptyPlayerInputsAsInvalid","playerInputs","input","trim","createGameRoundEvaluation","gameRoundEvaluation","evaluatedPlayer","evaluationsForAllCategories","evaluationForOneCategory","evaluatingPlayer","calculatePointsForRound","scoringOptions","playerId","next","playerInputsOfPlayer1","calculatePointsForCategory","isOnlyPlayerWithValidAnswer","isDuplicateOfOtherPlayersInput","otherPlayersIds","isOnlyPlayer","playerInputText","replace","some","otherPlayersInput","getMinNumberOfInvalids","numberOfPlayers","getNumberOfInvalids","evaluations","markedAsValid","applyValidFlagAndStarFlagToPoints","calculateGameResults","allPlayers","gameRounds","pointsPerPlayer","reduce","total","createHallOfFameData","GameResults","onResetAppState","numberOfRounds","letters","join","dispatch","ChipType","RejoinRunningGameHint","condition","context","hintText","setAppThemeIdInLocalStorage","appTheme","localStorage","setItem","setPlayerInfoInLocalStorage","JSON","stringify","setRunningGameInfoInLocalStorage","getRunningGameConfigFromLocalStorage","storedData","getItem","parse","setRunningGameConfigInLocalStorage","getRunningGameRoundFromLocalStorage","setRunningGameRoundInLocalStorage","removeAllDataOfRunningGameFromLocalStorage","removeItem","JoinGame","idInput","nameInput","validateInputs","handleInputChange","handleSubmit","preventDefault","joinGame","idCreationTimestamp","playerIdCreationTimestamp","Date","isPlayerAdmin","onSetGameData","isRejoiningGame","isAdmin","joinGameForm","onSubmit","noValidate","autoComplete","TextField","fullWidth","required","autoFocus","error","joingame","query","URLSearchParams","location","search","has","prevProps","lessPadding","dialog","CustomCategoryDialog","categoryInput","setCategoryInput","setValidateInputs","handleClose","stopPropagation","trimmedCategoryInput","AddCustomCategory","newCategory","addCustomCategory","CategoryArray","CheckboxName","display","flexWrap","spacing","chip","chipIcon","ChipsArray","chipsArray","chipType","undefined","removeChip","PubNubMessageType","NewGame","availableCategories","isSnackbarOpen","lettersToExclude","numberOfRoundsInput","selectedCategories","snackBarMessage","handleNameInputChange","handleNumberOfRoundsInputChange","handleGameOptionChange","checked","handleLetterToExcludeChange","newLettersToExclude","l","updateCategoryArrays","chipToRemove","removeFromArray","newSelectedCategories","newAvailableCategories","selected","isReadyToStartGame","startNewGame","showSnackBar","message","handleSnackBarClose","uuidv4","xor","numberOfRoundsInputLabel","newGameForm","inputProps","ExpansionPanel","ExpansionPanelSummary","expandIcon","ExpansionPanelDetails","FormGroup","FormControlLabel","control","Checkbox","row","letterIndex","includes","available","newgame","Snackbar","anchorOrigin","vertical","horizontal","autoHideDuration","adminPanel","top","right","menuButton","dialogContent","dialogContentText","KickUserDialog","playerToBeKicked","AdminPanel","setAnchorEl","openDialog","setOpenDialog","setPlayerToBeKicked","otherPlayers","selectedPlayer","kickPlayer","Particle","x","y","radius","ctx","save","translate","fillStyle","fillRect","restore","ParticleAlphabet","callbackWhenAnimationDone","canvas","currentPos","height","particlePositions","particles","tmpCanvas","tmpCtx","time","counter","myInterval","animate","requestAnimationFrame","animateParticles","document","querySelector","getContext","mainElement","find","classList","contains","offsetWidth","offsetHeight","createElement","setInterval","changeLetter","getPixels","clearInterval","makeParticles","num","random","keyword","window","innerWidth","innerHeight","font","fillText","measureText","idata","getImageData","buffer32","Uint32Array","buffer","p","pPos","indexOf","draw","LetterAnimation","lettersToUse","letterToUnveil","lettersForAnimation","LETTER_ANIMATION_LETTER_COUNT","useEffect","init","loadingScreen","left","loadingSpinner","transform","loadingSpinnerSize","LoadingScreen","CircularProgress","centerContent","marginTop","boxShadow","GameRoundChip","currentLetter","currentRound","StyledBadge","badge","border","Badge","PhaseEvaluateRound","playersThatFinishedEvaluation","hasFinishedEvaluation","setHasFinishedEvaluation","currentRoundEvaluation","finishedRound","notFinishedPlayers","createEvaluationButton","indexInSortedPlayers","evaluationForCategory","isInputAcceptedByUser","rejectingPlayers","getRejectingPlayers","tooltipText","hasPlayerTypedText","evaluationButtonForTypedText","evaluatedPlayerId","currentEvaluation","updateEvaluationOfPlayerInput","handleEvaluationButtonClick","badgeContent","autoRejectIconForMissingText","createSearchLink","searchLink","encodeURIComponent","createMarkAsCreativeAnswerToggle","isMarkedAsCreative","updateIsPlayerInputVeryCreativeStatus","markedAsCreative","handleMarkAsCreativeAnswerToggleClick","createPointsChip","evaluatedPlayerInput","isInputValid","inputCssClass","InputProps","spellCheck","startAdornment","InputAdornment","endAdornment","playerEvaluationElements","sendEvaluationFinishedMessage","PhaseFillOutTextfields","gameRoundInputs","newGameRoundInputs","updateCurrentRoundInputs","sendRoundFinishedMessage","PubNubCurrentRoundInputsMessage","currentRoundInputs","PubNubEvaluationOfPlayerInputMessage","evaluationOfPlayerInput","PubNubIsPlayerInputVeryCreativeMessage","isPlayerInputVeryCreative","PubNubKickPlayerMessage","PubNubDataForCurrentGameMessage","dataForCurrentGame","JoinGameLink","url","joinGameLink","slice","OutlinedInput","element","setAttribute","appendChild","select","execCommand","removeChild","copyToClipboard","PlayerList","PhaseWaitingToStart","waitForGameStartElement","sendMessage","startGame","memo","pubNubClient","usePubNub","setUserState","newUserState","channels","gameChannel","getHereNowData","hereNow","includeUUIDs","includeState","response","console","log","totalOccupancy","navigateToDashboard","dataForGameChannel","pubNubUserStates","occupants","occupant","userState","addPlayers","pubNubListeners","messageEvent","processPubNubMessage","presence","presenceEvent","status","statusEvent","channel","messages","setTimeout","addListener","subscribe","withPresence","removeListener","unsubscribeAll","PUBNUB_KEYS","require","PUBNUB_CONFIG","publishKey","subscribeKey","uuid","ssl","shouldUserRespondToRequestGameDataMessage","user","requestingPlayerId","requestingPlayerInfo","playersWithoutRequestingPlayer","cloneDeep","delete","compressGameRoundEvaluation","evaluationsAsArrays","booleanArray","compressedGameRoundEvaluation","decompressGameRoundEvaluation","compressedData","evaluatedPlayerIndex","playerData","playerInputEvaluation","evaluatingPlayerIndex","compressMarkedAsCreativeFlags","markedAsCreativeArrays","restoreGameRoundsOfRunningGameFromLocalStorage","numberOfRoundsToRestore","setPointsAndValidity","minNumberOfInvalids","applyMarkedAsCreativeFlags","markedAsCreativeAnswer","PlayGame","currentPhase","waitingToStart","showLetterAnimation","showLoadingScreen","publish","storeInHistory","ttl","newPlayers","newPlayer","roundFinished","stopRoundAndSendInputs","addPlayerInputForFinishedRound","publisher","processEvaluationOfPlayerInput","processIsPlayerInputVeryCreativeStatus","evaluationFinished","countPlayerAsEvaluationFinished","removePlayerFromGame","requestGameData","sendDataForCurrentGame","sendKickPlayerMessage","restoreDataForCurrentGame","fillOutTextfields","newCurrentRoundInputs","toPubNubMessage","playerInputsForFinishedRound","roundIndex","evaluateRound","newEvaluation","evaluatingPlayerId","playerInputEvaluations","newStatus","processEvaluationsAndStartNextRoundOrFinishGame","onSetDataOfFinishedGame","compressedMarkedAsCreativeFlags","Pubnub","currentPhaseElement","letterAnimationElement","client","setDataOfFinishedGame","backspaceDisabler","App","switchThemeHandler","newTheme","onSetAppTheme","ThemeProvider","basename","path","exact","disable","appThemeId","storedPlayerInfo","getPlayerInfoFromLocalStorage","nowTimestamp","onSetStoredPlayerInfo","runningGameInfo","getRunningGameInfoFromLocalStorage","onSetStoredRunningGameInfo","setAppTheme","setStoredPlayerInfo","setStoredRunningGameInfo","hostname","match","initialState","appStore","createStore","storedRunningGameInfo","ReactDOM","render","store","getElementById","navigator","serviceWorker","ready","then","registration","unregister","catch"],"mappings":"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","file":"static/js/main.902ef78a.chunk.js","sourcesContent":["import green from '@material-ui/core/colors/green';\r\nimport red from '@material-ui/core/colors/red';\r\nimport blue from '@material-ui/core/colors/blue';\r\nimport deepOrange from '@material-ui/core/colors/deepOrange';\r\nimport orange from '@material-ui/core/colors/orange';\r\nimport indigo from '@material-ui/core/colors/indigo';\r\nimport purple from '@material-ui/core/colors/purple';\r\nimport amber from '@material-ui/core/colors/amber';\r\nimport blueGrey from '@material-ui/core/colors/blueGrey';\r\nimport { createMuiTheme, Theme } from '@material-ui/core/styles';\r\nimport CSS from 'csstype';\r\n\r\nexport enum APP_THEME_ID {\r\n    green = 'green',\r\n    blue = 'blue',\r\n    orange = 'orange',\r\n    pink = 'pink',\r\n    black = 'black'\r\n}\r\n\r\nexport interface AppTheme {\r\n    id: APP_THEME_ID;\r\n    /** The background color used by the LetterAnimation component */\r\n    animationBackgroundColor: string;\r\n    /** The name of the CSS class that is applied to the header and the main element */\r\n    className: string;\r\n    /** The text displayed in the header's color picker dropdown */\r\n    displayName: string;\r\n    /** URL of the \"Stadt-Land-Fluss\" image visible on the homepage */\r\n    homepageImageUrl: string;\r\n    muiTheme: Theme;\r\n    style: CSS.Properties;\r\n}\r\n\r\nexport const AppThemes: AppTheme[] = [\r\n    {\r\n        id: APP_THEME_ID.green,\r\n        animationBackgroundColor: 'rgb(31, 121, 52)',\r\n        className: 'green-theme',\r\n        displayName: 'Grn/Wald',\r\n        homepageImageUrl: `${process.env.PUBLIC_URL}/assets/city-country-river-green.jpg`,\r\n        muiTheme: createMuiTheme({ palette: { primary: green, secondary: red } }),\r\n        style: {\r\n            background:\r\n                `linear-gradient(rgba(60, 143, 80, 0.3), rgba(60, 143, 80, 0.3)),\r\n                url('${process.env.PUBLIC_URL}/assets/leaves-pattern.jpg')`\r\n        }\r\n    },\r\n    {\r\n        id: APP_THEME_ID.blue,\r\n        animationBackgroundColor: 'rgb(9, 100, 204)',\r\n        className: 'blue-theme',\r\n        displayName: 'Blau/Meer',\r\n        homepageImageUrl: `${process.env.PUBLIC_URL}/assets/city-country-river-blue.jpg`,\r\n        muiTheme: createMuiTheme({ palette: { primary: blue, secondary: deepOrange } }),\r\n        style: {\r\n            background:\r\n                `linear-gradient(rgba(255, 255, 255, 0.3), rgba(255, 255, 255, 0.3)),\r\n                url('${process.env.PUBLIC_URL}/assets/sea-pattern.jpg')`\r\n        }\r\n    },\r\n    {\r\n        id: APP_THEME_ID.orange,\r\n        animationBackgroundColor: 'rgb(187, 138, 5)',\r\n        className: 'orange-theme',\r\n        displayName: 'Orange/Strand',\r\n        homepageImageUrl: `${process.env.PUBLIC_URL}/assets/city-country-river-orange.jpg`,\r\n        muiTheme: createMuiTheme({ palette: { primary: orange, secondary: indigo } }),\r\n        style: {\r\n            background:\r\n                `linear-gradient(rgba(241, 179, 8, 0.3), rgba(240, 188, 47, 0.3)),\r\n                url('${process.env.PUBLIC_URL}/assets/beach-pattern.jpg')`\r\n        }\r\n    },\r\n    {\r\n        id: APP_THEME_ID.pink,\r\n        animationBackgroundColor: 'rgb(167, 34, 207)',\r\n        className: 'pink-theme',\r\n        displayName: 'Pink/Musik',\r\n        homepageImageUrl: `${process.env.PUBLIC_URL}/assets/city-country-river-pink.jpg`,\r\n        muiTheme: createMuiTheme({ palette: { primary: purple, secondary: amber } }),\r\n        style: {\r\n            background:\r\n                `linear-gradient(rgba(133, 14, 103, 0.3), rgba(133, 14, 103, 0.3)),\r\n                url('${process.env.PUBLIC_URL}/assets/music-pattern.jpg')`\r\n        }\r\n    },\r\n    {\r\n        id: APP_THEME_ID.black,\r\n        animationBackgroundColor: 'rgb(0, 0, 0)',\r\n        className: 'black-theme',\r\n        displayName: 'Schwarz/Goth',\r\n        homepageImageUrl: `${process.env.PUBLIC_URL}/assets/city-country-river-bw.jpg`,\r\n        muiTheme: createMuiTheme({ palette: { primary: blueGrey, secondary: orange } }),\r\n        style: {\r\n            background:\r\n                `linear-gradient(rgba(0, 51, 153, 0.1), rgba(0, 51, 153, 0.1)),\r\n                url('${process.env.PUBLIC_URL}/assets/halloween-pattern.jpg')`\r\n        }\r\n    },\r\n]\r\n","export const DEFAULT_NUMBER_OF_ROUNDS = 3;\r\nexport const MIN_NUMBER_OF_ROUNDS = 1;\r\nexport const MAX_NUMBER_OF_ROUNDS = 15;\r\n\r\nexport const MIN_NUMBER_OF_CATEGORIES = 3;\r\n\r\nexport const STANDARD_ALPHABET = [\r\n    'A', 'B', 'C', 'D', 'E', 'F', 'G', 'H', 'I', 'J', 'K', 'L', 'M',\r\n    'N', 'O', 'P', 'Q', 'R', 'S', 'T', 'U', 'V', 'W', 'X', 'Y', 'Z'\r\n];\r\nexport const STANDARD_EXCLUDED_LETTERS = ['Q', 'X', 'Y']\r\n\r\nexport const STANDARD_CATEGORIES = ['Stadt', 'Land', 'Fluss/Gewsser'];\r\nexport const AVAILABLE_CATEGORIES = [\r\n    'Band/Musiker',\r\n    'Berg/Gebirge',\r\n    'Beruf',\r\n    'Berhmte Person',\r\n    'Buchtitel',\r\n    'Chemisches Element',\r\n    'Dinge die man jeden Tag macht',\r\n    'Etwas Eckiges',\r\n    'Etwas Rundes',\r\n    'Fiktiver Charakter',\r\n    'Film/Serie',\r\n    'Getrnk',\r\n    'Grund fr eine Versptung',\r\n    'Hobby',\r\n    'In Zeiten des Corona-Lockdowns verboten',\r\n    'Knnte ein Trump-Tweet sein',\r\n    'Krperteil',\r\n    'Krankheit',\r\n    'Laster',\r\n    'Marke',\r\n    'Mordwaffe',\r\n    'Pflanze',\r\n    'Pizzasorte',\r\n    'Porno-Knstlername',\r\n    'Religion',\r\n    'Scheidungsgrund',\r\n    'Schimpfwort',\r\n    'See/Meer',\r\n    'Sehenswrdigkeit',\r\n    'Sex (Stellung, Synonym)',\r\n    'Speise',\r\n    'Tier',\r\n    'Title of your Sex Tape',\r\n    'Unntige Superkraft',\r\n    'Videospiel',\r\n    'Was bei einer Zoom-Konferenz schiefgehen kann',\r\n    'Werkzeug',\r\n    'Wort in einer Fremdsprache'\r\n];\r\n\r\nexport enum GamePhase {\r\n    waitingToStart = 'waitingToStart',\r\n    fillOutTextfields = 'fillOutTextfields',\r\n    evaluateRound = 'evaluateRound'\r\n}\r\n\r\nexport const MIN_NUMBER_OF_PLAYERS = 2;\r\n\r\nexport const LETTER_ANIMATION_LETTER_COUNT = 5;\r\nexport const LETTER_ANIMATION_REDRAW_SPEED = 800;\r\n\r\nexport const SAME_WORD_POINTS = 5;\r\nexport const STANDARD_POINTS = 10;\r\nexport const ONLY_ANSWER_POINTS = 20;\r\n/**\r\n * Extra points for answers that are deemed especially creative or funny by other players.\r\n * Are only awarded if the corresponding scoring option was selected.\r\n */\r\nexport const EXTRA_POINTS = 5;\r\n\r\nexport const GAME_OPTION_LABEL = {\r\n    checkForDuplicates: `Wenn zwei oder mehr Spieler einen identischen Begriff in einer Kategorie eintragen,\r\n        so zhlt dieser nur ${SAME_WORD_POINTS} statt ${STANDARD_POINTS} Punkte.`,\r\n    creativeAnswersExtraPoints: `Von Mitspielern als besonders kreativ oder lustig ausgezeichnete Begriffe bringen ${EXTRA_POINTS} Extrapunkte.`,\r\n    onlyPlayerWithValidAnswer: `Wenn ein Spieler als einziger einen zulssigen Begriff in einer Kategorie\r\n        eintrgt, so zhlt dieser Begriff ${ONLY_ANSWER_POINTS} statt ${STANDARD_POINTS} Punkte.`\r\n}\r\n","import './Header.css';\r\nimport { IconButton, Menu, MenuItem } from '@material-ui/core';\r\nimport BrushIcon from '@material-ui/icons/Brush';\r\nimport MenuBookIcon from '@material-ui/icons/MenuBook';\r\nimport React, { Component } from 'react';\r\nimport { connect } from 'react-redux';\r\nimport packageJson from '../../../package.json';\r\nimport { AppTheme, AppThemes } from '../../constants/themes.constant';\r\nimport { AppState } from '../../store/app.reducer';\r\nimport { RouteComponentProps, withRouter } from 'react-router';\r\n\r\ninterface HeaderPropsFromStore {\r\n    playerName: string | null;\r\n}\r\ninterface HeaderProps extends HeaderPropsFromStore, RouteComponentProps {\r\n    switchTheme: (newTheme: AppTheme) => any;\r\n    theme: AppTheme;\r\n}\r\ninterface HeaderState {\r\n    anchorEl: EventTarget | null;\r\n    version: string;\r\n}\r\n\r\nexport class Header extends Component<HeaderProps, HeaderState> {\r\n    public state = {\r\n        anchorEl: null,\r\n        version: ''\r\n    };\r\n\r\n    public render() {\r\n        const playerNameParagraph = (\r\n            <p>Spieler: {this.props.playerName ? this.props.playerName : '-'}</p>\r\n        );\r\n        return (\r\n            <header className={'app-header ' + this.props.theme.className}>\r\n                <h1>Stadt-Land-Fluss</h1>\r\n                {playerNameParagraph}\r\n                <div className=\"about-section\">\r\n                    <p>v{this.state.version}</p>\r\n                    <a\r\n                        href=\"https://github.com/alexlehner86\"\r\n                        target=\"_blank\"\r\n                        rel=\"noopener noreferrer\"\r\n                        aria-label=\"Mehr ber den Autor erfahren (ffnet neues Fenster)\"\r\n                    >Autor</a>\r\n                </div>\r\n                <div className=\"icon-button-wrapper\">\r\n                    <IconButton\r\n                        className=\"slf-icon-button\"\r\n                        size=\"small\"\r\n                        title=\"Spielanleitung\"\r\n                        aria-label=\"Spielanleitung\"\r\n                        onClick={this.handleManualButtonClick}\r\n                    >\r\n                        <MenuBookIcon fontSize=\"small\" />\r\n                    </IconButton>\r\n                    <IconButton\r\n                        className=\"slf-icon-button\"\r\n                        size=\"small\"\r\n                        title=\"Theme ndern\"\r\n                        aria-label=\"Theme ndern\"\r\n                        aria-controls=\"theme-picker-menu\"\r\n                        aria-haspopup=\"true\"\r\n                        onClick={this.handleThemePickerClick}\r\n                    >\r\n                        <BrushIcon fontSize=\"small\" />\r\n                    </IconButton>\r\n                    <Menu\r\n                        id=\"theme-picker-menu\"\r\n                        anchorEl={this.state.anchorEl}\r\n                        keepMounted\r\n                        open={Boolean(this.state.anchorEl)}\r\n                        onClose={this.handleThemePickerMenuClose}\r\n                    >\r\n                        {AppThemes.map((item, index) => (\r\n                            <MenuItem\r\n                                key={'theme-picker-menu-item-' + index}\r\n                                onClick={() => this.handleThemePickerMenuItemClick(item)}\r\n                            >{item.displayName}</MenuItem>\r\n                        ))}\r\n                    </Menu>\r\n                </div>\r\n            </header>\r\n        );\r\n    }\r\n\r\n    public componentDidMount() {\r\n        this.setState({ version: packageJson.version });\r\n    }\r\n\r\n    private handleManualButtonClick = () => {\r\n        this.props.history.push('/manual');\r\n    }\r\n\r\n    private handleThemePickerClick = (event: React.MouseEvent<HTMLButtonElement>) => {\r\n        this.setState({ anchorEl: event.currentTarget });\r\n    };\r\n\r\n    private handleThemePickerMenuClose = () => {\r\n        this.setState({ anchorEl: null });\r\n    };\r\n\r\n    private handleThemePickerMenuItemClick = (selectedTheme: AppTheme) => {\r\n        this.setState({ anchorEl: null });\r\n        this.props.switchTheme(selectedTheme);\r\n    };\r\n}\r\n\r\nconst mapStateToProps = (state: AppState): HeaderPropsFromStore => {\r\n    return {\r\n        playerName: state.playerInfo ? state.playerInfo.name : ''\r\n    };\r\n}\r\nexport default withRouter(connect(mapStateToProps)(Header));\r\n","import './SectionHeader.css';\r\nimport { Divider } from '@material-ui/core';\r\nimport React from 'react';\r\n\r\ninterface SectionHeaderProps {\r\n    showDivider: boolean;\r\n    text: string;\r\n}\r\n\r\nexport const SectionHeader: React.FunctionComponent<SectionHeaderProps> = props => (\r\n    <React.Fragment>\r\n        <h2 className=\"section-header\">{props.text}</h2>\r\n        {props.showDivider ? <Divider /> : null}\r\n    </React.Fragment>\r\n);\r\n","import './Dashboard.css';\r\nimport Link from '@material-ui/core/Link';\r\nimport DirectionsRunIcon from '@material-ui/icons/DirectionsRun';\r\nimport React, { Component } from 'react';\r\nimport { connect } from 'react-redux';\r\nimport { Link as RouterLink } from 'react-router-dom';\r\nimport { SectionHeader } from '../../components/SectionHeader/SectionHeader';\r\nimport { AppTheme } from '../../constants/themes.constant';\r\nimport { AppState } from '../../store/app.reducer';\r\n\r\ninterface DashboardPropsFromStore {\r\n    activeTheme: AppTheme\r\n    gameId: string | null;\r\n}\r\nclass Dashboard extends Component<DashboardPropsFromStore> {\r\n    public render() {\r\n        const rejoinGameElement = (\r\n            <Link component={RouterLink} to=\"/play\" className=\"rejoin-game-link\">\r\n                <DirectionsRunIcon />\r\n                Zurck ins laufende Spiel\r\n            </Link>\r\n        );\r\n        return (\r\n            <div className=\"main-content-wrapper\">\r\n                <div className=\"dashboard-container material-card-style\">\r\n                    <SectionHeader showDivider={true} text=\"Dashboard\"></SectionHeader>\r\n                    <div className=\"link-container\">\r\n                        {this.props.gameId ? rejoinGameElement : null}\r\n                        <Link component={RouterLink} to=\"/newgame\">Neues Spiel</Link>\r\n                        <Link component={RouterLink} to=\"/joingame\">Spiel beitreten</Link>\r\n                        <Link component={RouterLink} to=\"/manual\">Spielanleitung</Link>\r\n                    </div>\r\n                    <img\r\n                        src={this.props.activeTheme.homepageImageUrl}\r\n                        alt=\"Stadt, Land, Fluss\"\r\n                        className=\"dashboard-slf-image\"\r\n                    />\r\n                    <div className=\"img-copyright\">\r\n                        <h3>Credits/Bilder</h3>\r\n                        <a href=\"https://www.vecteezy.com/vector-art/830131-river-city-landscape-with-buildings-hills-and-trees\" target=\"_blank\" rel=\"noopener noreferrer\">Homepage/Stadt-Land-Fluss by pikgura  www.vecteezy.com</a>\r\n                        <a href=\"https://www.vecteezy.com/vector-art/276920-abstract-seamless-pattern-with-tropical-leaves\" target=\"_blank\" rel=\"noopener noreferrer\">Theme Grn/Wald by NadiaGrapes  www.vecteezy.com</a>\r\n                        <a href=\"https://www.freepik.com/free-photos-vectors/background\" target=\"_blank\" rel=\"noopener noreferrer\">Theme Blau/Meer by macrovector  www.freepik.com</a>\r\n                        <a href=\"https://www.vecteezy.com/vector-art/460735-seashell-sand-seamless-pattern\" target=\"_blank\" rel=\"noopener noreferrer\">Theme Orange/Strand by Macrovector  www.vecteezy.com</a>\r\n                        <a href=\"https://www.vecteezy.com/vector-art/454258-music-seamless\" target=\"_blank\" rel=\"noopener noreferrer\">Theme Pink/Musik by Macrovector  www.vecteezy.com</a>\r\n                        <a href=\"https://www.vecteezy.com/vector-art/662038-cat-and-bat-pattern\" target=\"_blank\" rel=\"noopener noreferrer\">Theme Schwarz/Goth by angyee  www.vecteezy.com</a>\r\n                    </div>\r\n                </div>\r\n            </div>\r\n        );\r\n    }\r\n}\r\n\r\nconst mapStateToProps = (state: AppState): DashboardPropsFromStore => {\r\n    return {\r\n        activeTheme: state.activeTheme,\r\n        gameId: state.gameId\r\n    };\r\n}\r\nexport default connect(mapStateToProps)(Dashboard);\r\n","import './ToDashboardButton.css';\r\nimport { Button } from '@material-ui/core';\r\nimport ExitToAppIcon from '@material-ui/icons/ExitToApp';\r\nimport React from 'react';\r\n\r\ninterface ToDashboardButtonProps {\r\n    onReturnToDashboard: () => any;\r\n}\r\n\r\nconst ToDashboardButton: React.FunctionComponent<ToDashboardButtonProps> = props => {\r\n    return (\r\n        <div className=\"button-wrapper to-dashboard-button\">\r\n            <Button\r\n                type=\"button\"\r\n                color=\"default\"\r\n                variant=\"contained\"\r\n                size=\"large\"\r\n                startIcon={<ExitToAppIcon />}\r\n                onClick={props.onReturnToDashboard}\r\n            >Dashboard</Button>\r\n        </div>\r\n    );\r\n}\r\n\r\nexport default ToDashboardButton;\r\n","import './RejoinRunningGameHint.css';\r\nimport { Link } from '@material-ui/core';\r\nimport React from 'react';\r\nimport { Link as RouterLink } from 'react-router-dom';\r\n\r\nexport enum RejoinRunningGameHintContext {\r\n    newgame = 'newgame',\r\n    joingame = 'joingame'\r\n};\r\n\r\ninterface RejoinRunningGameHintProps {\r\n    context: RejoinRunningGameHintContext;\r\n}\r\nexport const RejoinRunningGameHint: React.FunctionComponent<RejoinRunningGameHintProps> = props => {\r\n    const condition = props.context === 'newgame' ? 'ein neues Spiel erstellst' : 'einem anderen Spiel beitrittst';\r\n    const hintText = `Du nimmst bereits an einem laufenden Spiel teil. Wenn du ${condition},\r\n    kannst du nicht mehr in das alte Spiel zurckkehren!`;\r\n\r\n    return (\r\n        <div className=\"material-card-style\">\r\n            <p className=\"rejoin-running-game-hint-text\">\r\n                <span className=\"rejoin-running-game-hint-highlighted\">Achtung: </span>\r\n                {hintText}\r\n            </p>\r\n            <Link component={RouterLink} to=\"/play\" className=\"bold-text\"> Zurck ins laufende Spiel</Link>\r\n        </div>\r\n    );\r\n}\r\n","import './GameManual.css';\r\nimport AddCircleOutlineIcon from '@material-ui/icons/AddCircleOutline';\r\nimport BrushIcon from '@material-ui/icons/Brush';\r\nimport FileCopyIcon from '@material-ui/icons/FileCopy';\r\nimport SettingsIcon from '@material-ui/icons/Settings';\r\nimport StarIcon from '@material-ui/icons/Star';\r\nimport ThumbDownRoundedIcon from '@material-ui/icons/ThumbDownRounded';\r\nimport React, { Component } from 'react';\r\nimport { RouteComponentProps } from 'react-router';\r\nimport { SectionHeader } from '../../components/SectionHeader/SectionHeader';\r\nimport ToDashboardButton from '../../components/ToDashboardButton/ToDashboardButton';\r\nimport { GAME_OPTION_LABEL } from '../../constants/game.constant';\r\n\r\nclass GameManual extends Component<RouteComponentProps> {\r\n    public render() {\r\n        return (\r\n            <div className=\"main-content-wrapper\">\r\n                <div className=\"dashboard-container material-card-style slf-game-manual\">\r\n                    <SectionHeader showDivider={true} text=\"Spielanleitung\"></SectionHeader>\r\n                    <p>\r\n                        Willkommen bei <span>Stadt-Land-Fluss (MALEX-Edition)</span>, einer modernen Version des{' '}\r\n                        <a\r\n                            href=\"https://de.wikipedia.org/wiki/Stadt,_Land,_Fluss\"\r\n                            target=\"_blank\"\r\n                            rel=\"noopener noreferrer\"\r\n                        >Spiele-Klassikers</a>\r\n                        {' '}mit neuen, lustigen Kategorien.\r\n                    </p>\r\n                    <h3>Allgemeines</h3>\r\n                    <p>\r\n                        Auf der Startseite kann man ber <span>Neues Spiel</span> ein neues Spiel erstellen bzw. ber <span>Spiel\r\n                        beitreten</span> einem bereits erstellten Spiel beitreten. Die Website bietet fnf verschiedene Themes zur\r\n                        Auswahl. Das aktuelle Theme kann ber den <BrushIcon fontSize=\"small\" className=\"inline-material-icon\" />-Button\r\n                        rechts im Header gendert werden. Die Theme-Auswahl des Nutzers sowie der zuletzt gewhlte Spielername wird im{' '}\r\n                        <a\r\n                            href=\"https://developer.mozilla.org/en-US/docs/Web/API/Window/localStorage\"\r\n                            target=\"_blank\"\r\n                            rel=\"noopener noreferrer\"\r\n                        >Local Storage</a>\r\n                        {' '}des Browsers gespeichert.\r\n                    </p>\r\n                    <h3>Neues Spiel</h3>\r\n                    <p>\r\n                        Um ein neues Spiel zu erstellen, muss der Nutzer einen Spielernamen eingeben, die Anzahl der zu spielenden\r\n                        Runden festlegen und mindestens drei Kategorien auswhlen. Es stehen 40 Kategorien zur Auswahl, darunter\r\n                        Klassiker wie <span>Stadt</span>, <span>Land</span> und <span>Fluss/Gewsser</span>, jedoch auch\r\n                        neue Kategorien wie <span>Knnte ein Trump-Tweet sein</span>. ber\r\n                        den <AddCircleOutlineIcon fontSize=\"small\" className=\"inline-material-icon\" />-Button am Ende der Kategorien-Liste\r\n                        lsst sich auch jede beliebige, weitere Kategorie hinzufgen und fr das Spiel auswhlen.\r\n                    </p>\r\n                    <p>\r\n                        Im Bereich <span>Weitere Optionen</span> knnen optional weitere Einstellungen vorgenommen werden.\r\n                        Der Nutzer kann bestimmen, welche Buchstaben ausgeschlossen werden sollen. Standardmig sind hier\r\n                        Q, X und Y ausgewhlt. Weiters stehen drei zustzliche <span>Regeln fr die Punktevergabe</span> zur\r\n                        Auswahl, von denen die ersten beiden vorausgewhlt sind:\r\n                    </p>\r\n                    <ul>\r\n                        <li>{GAME_OPTION_LABEL.checkForDuplicates}</li>\r\n                        <li>{GAME_OPTION_LABEL.onlyPlayerWithValidAnswer}</li>\r\n                        <li>{GAME_OPTION_LABEL.creativeAnswersExtraPoints}</li>\r\n                    </ul>\r\n                    <p>\r\n                        Nach einem Klick auf <span>Spiel erstellen</span> gelangt der Nutzer zur Spiel-bersicht, wo alle Settings\r\n                        fr das erstellte Spiel sowie die bisher dem Spiel beigetretenen Mitspieler sichtbar sind. Zu Beginn ist nur der\r\n                        Nutzer, der das Spiel erstellt hat, als Administrator in der Mitspieler-Liste sichtbar. Es mssen mindestens zwei\r\n                        Spieler an einem Spiel teilnehmen, damit dieses starten kann. Unten auf der Seite wird dem Administrator ein Link\r\n                        zum Teilen mit Freunden angeboten. Ein Klick auf den <FileCopyIcon fontSize=\"small\" className=\"inline-material-icon\" />\r\n                        -Button rechts vom Link kopiert diesen in die Zwischenablage. ber diesen Link gelangen andere Mitspieler direkt\r\n                        zur <span>Spiel beitreten</span>-Seite, wo das Feld Spiel-ID bereits vorausgefllt wird.\r\n                    </p>\r\n                    <h3>Spiel beitreten</h3>\r\n                    <p>\r\n                        Um einem bereits erstellten Spiel beizutreten, muss der Nutzer einen Spielernamen sowie die Spiel-ID eingeben.\r\n                        Die Spiel-ID erhlt der Nutzer von einem anderen Mitspieler bzw. sie wird von der Website automatisch in das\r\n                        Feld eingetragen, wenn der Nutzer dem Link des Administrators gefolgt ist.\r\n                    </p>\r\n                    <h3>Spielablauf</h3>\r\n                    <p>\r\n                        Nachdem der Spiel-Administrator das Spiel gestartet hat, luft jede Runde folgendermaen ab:\r\n                    </p>\r\n                    <ol>\r\n                        <li>Eine kurze Animation offenbart den Buchstaben fr die neue Runde.</li>\r\n                        <li>\r\n                            Die Runde startet: Jeder Spieler sieht eine Liste an Eingabefeldern, eines pro Kategorie,\r\n                            zum Eintragen der Begriffe bzw. Phrasen.\r\n                        </li>\r\n                        <li>\r\n                            Abhngig vom gewhlten Spielmodus endet die Runde, sobald der erste Spieler auf den Abschicken-Button\r\n                            rechts unten auf der Seite geklickt hat oder wenn die festgelegte Rundendauer abgelaufen ist.\r\n                        </li>\r\n                        <li>\r\n                            Nachdem die Runde beendet ist, wird jedem Spieler eine bersicht aller Begriffe aller Spieler pro\r\n                            Kategorie angezeigt. Grundstzlich zhlt ein gltiger Begriff 10 Punkte, auer die gewhlten Regeln besagen\r\n                            etwas anderes. Falls ein Spieler in ein Feld nichts eingetragen hat, wird dieses automatisch als 0 Punkte\r\n                            gewertet. ber den <ThumbDownRoundedIcon fontSize=\"small\" className=\"inline-material-icon\" />-Button\r\n                            knnen die Spieler konkrete Antworten ablehnen. Abhngig von der Spieleranzahl fhrt dies dazu, dass\r\n                            der jeweilige Spieler keine Punkte fr die Antwort erhlt. Bei zwei bis drei Spielern reicht die Ablehnung\r\n                            durch einen Mitspieler aus. Bei mehr als drei Spielern mssen mindesten zwei Spieler eine Antwort ablehnen.\r\n                            Die Ablehnung einer Antwort kann durch erneutes Klicken auf den Button wieder zurckgezogen werden.\r\n                            Mit dem <StarIcon fontSize=\"small\" className=\"inline-material-icon\" />-Button knnen Begriffe von Mitspielern\r\n                            als besonders kreativ oder lustig ausgezeichnet werden.\r\n                        </li>\r\n                        <li>\r\n                            ber den Besttigen-Button rechts unten auf der Seite muss ein Spieler signalisieren, dass sie oder er\r\n                            mit der Analyse der Antworten fertig und bereit fr die nchste Runde ist. Erst wenn alle Spieler den\r\n                            Button geklickt haben, startet die nchste Runde (siehe Schritt 1) bzw. endet das Spiel.\r\n                        </li>\r\n                    </ol>\r\n                    <p>\r\n                        Hinweis: Falls ein Mitspieler aus irgendeinem Grund (Browserabsturz, Akku leer etc.) aus dem Spiel fliegt, kann\r\n                        sie oder er ber den <span>Zurck ins laufende Spiel-Button</span> wieder ins Spiel zurckkehren. Dieser findet\r\n                        sich auf der Startseite. Darber hinaus hat der Administrator in einem laufenden Spiel die Mglichkeit, ber\r\n                        den <SettingsIcon fontSize=\"small\" className=\"inline-material-icon\" />-Button (rechts oben, unterhalb des Headers)\r\n                        andere Spieler aus dem Spiel zu werfen. Natrlich nur in Notfllen ;)\r\n                    </p>\r\n                    <h3>Spielende</h3>\r\n                    <p>\r\n                        Am Ende des Spiels gelangt der Nutzer auf die <span>Ergebnisseite</span>, wo ein Ranking der Mitspieler nach\r\n                        erzielten Punkten sowie die Details zum Spiel (Buchstaben, Anzahl Runden, Kategorien etc.) dargestellt werden.\r\n                    </p>\r\n                    <p>\r\n                        Der Button <span>Alle Runden im Detail</span> ffnet einen Dialog, in dem alle Runden des beendeten Spiels\r\n                        im Detail (Antworten, Punkte etc.) dargestellt werden. Falls whrend des Spiels einzelne Begriffe als besonders\r\n                        kreativ oder lustig ausgezeichnet wurden, so kann man ber den <span>Hall of Fame</span>-Button\r\n                        einen Dialog ffnen, der eine Liste mit allen Begriffen anzeigt.\r\n                    </p>\r\n                </div>\r\n                <ToDashboardButton onReturnToDashboard={this.returnToDashboard} />\r\n            </div>\r\n        );\r\n    }\r\n\r\n    private returnToDashboard = () => {\r\n        this.props.history.push('/');\r\n    }\r\n}\r\n\r\nexport default GameManual;\r\n","import { Collection } from \"../models/collection.interface\";\r\n\r\nexport const copyToClipboard = (text: string) => {\r\n    const element = document.createElement('textarea');\r\n    element.value = text;\r\n    element.setAttribute('readonly', '');\r\n    element.style.position = 'absolute';\r\n    element.style.left = '-9999px';\r\n    document.body.appendChild(element);\r\n    element.select();\r\n    document.execCommand('copy');\r\n    document.body.removeChild(element);\r\n};\r\n\r\nexport const createAndFillArray = <T>(length: number, value: T): T[] => {\r\n    return new Array(length).fill(value);\r\n};\r\n\r\nexport const makePluralIfCountIsNotOne = (count: number, singular: string, plural: string): string => {\r\n    return count === 1 ? singular : plural;\r\n};\r\n\r\nexport const convertDateToUnixTimestamp = (dateToConvert: Date): number => dateToConvert.getTime() / 1000 | 0;\r\n\r\nexport const convertCollectionToMap = <T>(collectionToConvert: Collection<T>): Map<string, T> => {\r\n    const dataAsMap = new Map<string, T>();\r\n    Object.keys(collectionToConvert).forEach(key => dataAsMap.set(key, collectionToConvert[key]));\r\n    return dataAsMap;\r\n};\r\n\r\nexport const convertMapToCollection = <T>(mapToConvert: Map<string, T>): Collection<T> => {\r\n    const dataAsCollection: Collection<T> = {};\r\n    mapToConvert.forEach((data, key) => dataAsCollection[key] = data);\r\n    return dataAsCollection;\r\n};\r\n","import { List, ListItem, ListItemIcon, ListItemText } from '@material-ui/core';\r\nimport { makeStyles } from '@material-ui/core/styles';\r\nimport FaceIcon from '@material-ui/icons/Face';\r\nimport InsertEmoticonIcon from '@material-ui/icons/InsertEmoticon';\r\nimport React from 'react';\r\nimport { GameResultForPlayer } from '../../models/game.interface';\r\nimport { makePluralIfCountIsNotOne } from '../../utils/general.utils';\r\n\r\nconst useStyles = makeStyles({\r\n    listItem: {\r\n        flex: '0 0 auto',\r\n        justifyContent: 'center',\r\n        margin: 0,\r\n    },\r\n    listItemText: {\r\n        flex: '0 0 auto',\r\n        minWidth: '6rem',\r\n    },\r\n});\r\n\r\ninterface GameResultsListProps {\r\n    gameResults: GameResultForPlayer[];\r\n}\r\nconst GameResultsList: React.FunctionComponent<GameResultsListProps> = props => {\r\n    const classes = useStyles();\r\n    const mostPoints = Math.max(...props.gameResults.map(result => result.points));\r\n    const getResultIcon = (isWinner: boolean): JSX.Element => {\r\n        return isWinner ? <InsertEmoticonIcon color=\"primary\" fontSize=\"large\" /> : <FaceIcon fontSize=\"large\" />;\r\n    }\r\n    return (\r\n        <List>\r\n            {props.gameResults.map((result, index) => (\r\n                <ListItem key={'results-for-player-' + index} className={classes.listItem}>\r\n                    <ListItemIcon>\r\n                        {getResultIcon(result.points === mostPoints)}\r\n                    </ListItemIcon>\r\n                    <ListItemText\r\n                        className={classes.listItemText}\r\n                        primary={result.playerName}\r\n                        secondary={`${result.points} ${makePluralIfCountIsNotOne(result.points, 'Punkt', 'Punkte')}`}\r\n                    />\r\n                </ListItem>\r\n            ))}\r\n        </List>\r\n    );\r\n}\r\n\r\nexport default GameResultsList;\r\n","import { Tooltip } from '@material-ui/core';\r\nimport Paper from '@material-ui/core/Paper';\r\nimport { createStyles, makeStyles, Theme, withStyles } from '@material-ui/core/styles';\r\nimport Table from '@material-ui/core/Table';\r\nimport TableBody from '@material-ui/core/TableBody';\r\nimport TableCell from '@material-ui/core/TableCell';\r\nimport TableContainer from '@material-ui/core/TableContainer';\r\nimport TableHead from '@material-ui/core/TableHead';\r\nimport TableRow from '@material-ui/core/TableRow';\r\nimport StarIcon from '@material-ui/icons/Star';\r\nimport React from 'react';\r\nimport { GameConfig, GameRound, PlayerInput } from '../../models/game.interface';\r\nimport { PlayerInfo } from '../../models/player.interface';\r\n\r\nconst StyledTableCell = withStyles((theme: Theme) =>\r\n    createStyles({\r\n        head: {\r\n            backgroundColor: theme.palette.primary.main,\r\n            color: theme.palette.primary.contrastText,\r\n            maxWidth: '8rem',\r\n        },\r\n        body: {\r\n            fontSize: 14,\r\n            maxWidth: '8rem',\r\n        },\r\n    }),\r\n)(TableCell);\r\n\r\nconst StyledTableRow = withStyles((theme: Theme) =>\r\n    createStyles({\r\n        root: {\r\n            '&:nth-of-type(odd)': {\r\n                backgroundColor: theme.palette.action.hover,\r\n            },\r\n        },\r\n    }),\r\n)(TableRow);\r\n\r\nconst useStyles = makeStyles((theme: Theme) =>\r\n    createStyles({\r\n        tableContainer: {\r\n            borderRadius: 0,\r\n        },\r\n        table: {\r\n            maxWidth: '80vw',\r\n        },\r\n        firstColumn: {\r\n            fontWeight: 'bold',\r\n        },\r\n        invalidInput: {\r\n            color: 'crimson',\r\n            textDecoration: 'line-through',\r\n        },\r\n        creativeAnswerStarIcon: {\r\n            fontSize: '1rem',\r\n            verticalAlign: 'text-top',\r\n        }\r\n    })\r\n);\r\n\r\ninterface GameRoundsTableProps {\r\n    gameConfig: GameConfig;\r\n    round: GameRound;\r\n    sortedPlayers: PlayerInfo[];\r\n}\r\nconst GameRoundsTable: React.FunctionComponent<GameRoundsTableProps> = props => {\r\n    const classes = useStyles();\r\n    const { gameConfig, round, sortedPlayers } = props;\r\n\r\n    const veryCreativeAnswer = (playerInput: PlayerInput): JSX.Element => (\r\n        <React.Fragment>\r\n            <span>{playerInput.text} (+{playerInput.points},&nbsp;</span>\r\n            <Tooltip\r\n                title=\"Als besonders kreativ markiert\"\r\n                placement=\"bottom\"\r\n            >\r\n                <StarIcon className={classes.creativeAnswerStarIcon} color=\"secondary\" />\r\n            </Tooltip>\r\n            <span>)</span>\r\n        </React.Fragment>\r\n    );\r\n    const createTableRowForCategory = (category: string, categoryIndex: number): JSX.Element => {\r\n        return (\r\n            <StyledTableRow key={`slf-table-row-for-category-${categoryIndex}`}>\r\n                <StyledTableCell component=\"th\" scope=\"row\" className={classes.firstColumn}>{category}</StyledTableCell>\r\n                {sortedPlayers.map((player, playerIndex) => {\r\n                    const playerInput = (round.get(player.id) as PlayerInput[])[categoryIndex];\r\n                    return (\r\n                        <StyledTableCell\r\n                            key={`slf-table-cell-for-category-${categoryIndex}-player-${playerIndex}`}\r\n                            className={!playerInput.valid ? classes.invalidInput : ''}\r\n                            align=\"right\"\r\n                        >\r\n                            {playerInput.valid && playerInput.star ? veryCreativeAnswer(playerInput) : null}\r\n                            {playerInput.valid && !playerInput.star ? `${playerInput.text} (+${playerInput.points})` : null}\r\n                            {!playerInput.valid ? playerInput.text : null}\r\n                        </StyledTableCell>\r\n                    );\r\n                })}\r\n            </StyledTableRow>\r\n        );\r\n    };\r\n    return (\r\n        <TableContainer component={Paper} className={classes.tableContainer}>\r\n            <Table className={classes.table} aria-label=\"Die Spielrunde im Detail\">\r\n                <TableHead>\r\n                    <TableRow>\r\n                        <StyledTableCell>Kategorie</StyledTableCell>\r\n                        {sortedPlayers.map((player, playerIndex) => (\r\n                            <StyledTableCell\r\n                                key={`slf-table-head-cell-for-player-${playerIndex}`}\r\n                                align=\"right\"\r\n                            >{player.name}</StyledTableCell>\r\n                        ))}\r\n                    </TableRow>\r\n                </TableHead>\r\n                <TableBody>\r\n                    {gameConfig.categories.map(createTableRowForCategory)}\r\n                </TableBody>\r\n            </Table>\r\n        </TableContainer>\r\n    );\r\n}\r\n\r\nexport default GameRoundsTable;\r\n","import { Button, Dialog, DialogActions, DialogContent, makeStyles, Theme } from '@material-ui/core';\r\nimport AppBar from '@material-ui/core/AppBar';\r\nimport Tab from '@material-ui/core/Tab';\r\nimport Tabs from '@material-ui/core/Tabs';\r\nimport EventNoteIcon from '@material-ui/icons/EventNote';\r\nimport React, { useState } from 'react';\r\nimport { GameConfig, GameRound } from '../../models/game.interface';\r\nimport { PlayerInfo } from '../../models/player.interface';\r\nimport GameRoundsTable from '../GameRoundsTable/GameRoundsTable';\r\n\r\ninterface TabPanelProps {\r\n    children?: React.ReactNode;\r\n    index: any;\r\n    value: any;\r\n}\r\nconst TabPanel: React.FunctionComponent<TabPanelProps> = props => {\r\n    const { children, value, index, ...other } = props;\r\n    return (\r\n        <div\r\n            role=\"tabpanel\"\r\n            hidden={value !== index}\r\n            id={`scrollable-auto-tabpanel-${index}`}\r\n            aria-labelledby={`scrollable-auto-tab-${index}`}\r\n            {...other}\r\n        >\r\n            {value === index && children}\r\n        </div>\r\n    );\r\n}\r\n\r\nconst a11yProps = (index: any) => ({\r\n    id: `scrollable-auto-tab-${index}`,\r\n    'aria-controls': `scrollable-auto-tabpanel-${index}`,\r\n});\r\n\r\nconst useStyles = makeStyles((theme: Theme) => ({\r\n    root: {\r\n        flexGrow: 1,\r\n        width: '100%',\r\n        padding: '0 !important',\r\n        backgroundColor: theme.palette.background.paper,\r\n    },\r\n}));\r\n\r\nexport interface GameRoundsOverviewDialogProps {\r\n    gameConfig: GameConfig;\r\n    open: boolean;\r\n    rounds: GameRound[];\r\n    sortedPlayers: PlayerInfo[];\r\n    onClose: () => void;\r\n}\r\nconst GameRoundsOverviewDialog: React.FunctionComponent<GameRoundsOverviewDialogProps> = props => {\r\n    const classes = useStyles();\r\n    const { gameConfig, open, rounds, sortedPlayers, onClose } = props;\r\n    const [tabValue, setTabValue] = React.useState(0);\r\n    const handleChange = (event: React.ChangeEvent<{}>, newValue: number) => setTabValue(newValue);\r\n\r\n    return (\r\n        <Dialog onClose={onClose} open={open} maxWidth=\"lg\">\r\n            <DialogContent className={classes.root}>\r\n                <AppBar position=\"static\" color=\"default\">\r\n                    <Tabs\r\n                        value={tabValue}\r\n                        onChange={handleChange}\r\n                        indicatorColor=\"secondary\"\r\n                        textColor=\"primary\"\r\n                        variant=\"scrollable\"\r\n                        scrollButtons=\"auto\"\r\n                    >\r\n                        {rounds.map((_, index) => (\r\n                            <Tab\r\n                                key={`slf-game-rounds-overview-tab-${index}`}\r\n                                label={`Runde ${index + 1}`}\r\n                                {...a11yProps(index)}\r\n                            />\r\n                        ))}\r\n                    </Tabs>\r\n                </AppBar>\r\n                {rounds.map((round, index) => (\r\n                    <TabPanel\r\n                        key={`slf-game-rounds-overview-tab-panel-${index}`}\r\n                        value={tabValue}\r\n                        index={index}\r\n                    >\r\n                        <GameRoundsTable gameConfig={gameConfig} round={round} sortedPlayers={sortedPlayers} />\r\n                    </TabPanel>\r\n                ))}\r\n            </DialogContent>\r\n            <DialogActions>\r\n                <Button type=\"button\" onClick={onClose}>Schlieen</Button>\r\n            </DialogActions>\r\n        </Dialog>\r\n    );\r\n}\r\n\r\ninterface GameRoundsOverviewButtonProps {\r\n    gameConfig: GameConfig;\r\n    rounds: GameRound[];\r\n    sortedPlayers: PlayerInfo[];\r\n}\r\n\r\n/**\r\n * Displays a button that opens a dialog with all player inputs, scoring etc. of all rounds.\r\n * The displayed data is organized in tabs, one tab per round.\r\n */\r\nconst GameRoundsOverviewButton: React.FunctionComponent<GameRoundsOverviewButtonProps> = props => {\r\n    const [open, setOpen] = useState(false);\r\n    const handleClose = () => setOpen(false);\r\n\r\n    return (\r\n        <React.Fragment>\r\n            <Button\r\n                color=\"primary\"\r\n                variant=\"contained\"\r\n                size=\"large\"\r\n                startIcon={<EventNoteIcon />}\r\n                onClick={() => setOpen(true)}\r\n            >Alle Runden im Detail</Button>\r\n            <GameRoundsOverviewDialog\r\n                gameConfig={props.gameConfig}\r\n                open={open}\r\n                rounds={props.rounds}\r\n                sortedPlayers={props.sortedPlayers}\r\n                onClose={handleClose}\r\n            />\r\n        </React.Fragment>\r\n    );\r\n}\r\n\r\nexport default GameRoundsOverviewButton;\r\n","import {\r\n    Button,\r\n    Chip,\r\n    Dialog,\r\n    DialogActions,\r\n    DialogContent,\r\n    DialogContentText,\r\n    Divider,\r\n    List,\r\n    ListItem,\r\n    ListItemAvatar,\r\n    ListItemText,\r\n    makeStyles,\r\n} from '@material-ui/core';\r\nimport FaceIcon from '@material-ui/icons/Face';\r\nimport StarIcon from '@material-ui/icons/Star';\r\nimport React, { useState } from 'react';\r\nimport { HallOfFameEntry } from '../../models/game.interface';\r\n\r\nconst useStyles = makeStyles({\r\n    list: {\r\n        paddingBottom: 0,\r\n    },\r\n    listItem: {\r\n        padding: '0.25rem 0',\r\n    },\r\n    listItemAvatar: {\r\n        marginRight: '1rem',\r\n    },\r\n});\r\n\r\nexport interface HallOfFameDialogProps {\r\n    hallOfFameData: HallOfFameEntry[];\r\n    open: boolean;\r\n    onClose: () => void;\r\n}\r\nconst HallOfFameDialog: React.FunctionComponent<HallOfFameDialogProps> = props => {\r\n    const classes = useStyles();\r\n    const { hallOfFameData, open, onClose } = props;\r\n    return (\r\n        <Dialog onClose={onClose} open={open} maxWidth=\"lg\">\r\n            <DialogContent>\r\n                <DialogContentText>Hall of Fame</DialogContentText>\r\n                <Divider />\r\n                <List className={classes.list}>\r\n                    {hallOfFameData.map((item, index) => (\r\n                        <ListItem key={`slf-hall-of-fame-item-${index}`} className={classes.listItem}>\r\n                            <ListItemAvatar className={classes.listItemAvatar}>\r\n                                <Chip\r\n                                    icon={<FaceIcon />}\r\n                                    color=\"primary\"\r\n                                    label={item.playerName}\r\n                                />\r\n                            </ListItemAvatar>\r\n                            <ListItemText\r\n                                primary={item.text}\r\n                                secondary={item.category}\r\n                            />\r\n                        </ListItem>\r\n                    ))}\r\n                </List>\r\n            </DialogContent>\r\n            <DialogActions>\r\n                <Button type=\"button\" onClick={onClose}>Schlieen</Button>\r\n            </DialogActions>\r\n        </Dialog>\r\n    );\r\n}\r\n\r\ninterface HallOfFameButtonProps {\r\n    hallOfFameData: HallOfFameEntry[];\r\n}\r\n\r\n/**\r\n * Displays a button that opens a dialog with all player inputs that were marked as \"very creative\".\r\n */\r\nconst HallOfFameButton: React.FunctionComponent<HallOfFameButtonProps> = props => {\r\n    const [open, setOpen] = useState(false);\r\n    const handleClose = () => setOpen(false);\r\n\r\n    return (\r\n        <React.Fragment>\r\n            <Button\r\n                color=\"primary\"\r\n                variant=\"contained\"\r\n                size=\"large\"\r\n                startIcon={<StarIcon />}\r\n                disabled={props.hallOfFameData.length === 0}\r\n                onClick={() => setOpen(true)}\r\n            >Hall of Fame</Button>\r\n            <HallOfFameDialog\r\n                hallOfFameData={props.hallOfFameData}\r\n                open={open}\r\n                onClose={handleClose}\r\n            />\r\n        </React.Fragment>\r\n    );\r\n}\r\n\r\nexport default HallOfFameButton;\r\n","import React from 'react';\r\nimport { GAME_OPTION_LABEL } from '../../constants/game.constant';\r\nimport { GameConfigScoringOptions } from '../../models/game.interface';\r\n\r\ninterface ScoringOptionsListProps {\r\n    rules: GameConfigScoringOptions;\r\n}\r\n\r\nconst ScoringOptionsList: React.FunctionComponent<ScoringOptionsListProps> = props => {\r\n    const { rules } = props;\r\n    const createFurtherOptionsElement = (): JSX.Element => (\r\n        <React.Fragment>\r\n            <p>Regeln fr die Punktevergabe:</p>\r\n            <ul>\r\n                {rules.checkForDuplicates ? <li>{GAME_OPTION_LABEL.checkForDuplicates}</li> : null}\r\n                {rules.onlyPlayerWithValidAnswer ? <li>{GAME_OPTION_LABEL.onlyPlayerWithValidAnswer}</li> : null}\r\n                {rules.creativeAnswersExtraPoints ? <li>{GAME_OPTION_LABEL.creativeAnswersExtraPoints}</li> : null}\r\n            </ul>\r\n        </React.Fragment>\r\n    );\r\n    if (rules.checkForDuplicates || rules.onlyPlayerWithValidAnswer || rules.creativeAnswersExtraPoints) {\r\n        return createFurtherOptionsElement();\r\n    }\r\n    return null;\r\n}\r\n\r\nexport default ScoringOptionsList;\r\n","import { Action } from 'redux';\r\nimport { AppTheme } from '../constants/themes.constant';\r\nimport { GameConfig, GameRound, StoredRunningGameInfo } from '../models/game.interface';\r\nimport { PlayerInfo, StoredPlayerInfo } from './../models/player.interface';\r\n\r\nexport const SET_APP_THEME = 'SET_APP_THEME';\r\nexport const SET_STORED_PLAYER_INFO = 'SET_STORED_PLAYER_INFO';\r\nexport const SET_STORED_RUNNING_GAME_INFO = 'SET_STORED_RUNNING_GAME_INFO';\r\nexport const SET_DATA_FOR_NEW_GAME = 'SET_DATA_FOR_NEW_GAME';\r\nexport const SET_DATA_OF_FINISHED_GAME = 'SET_DATA_OF_FINISHED_GAME';\r\nexport const RESET_APP_STATE = 'RESET_APP_STATE';\r\n\r\nexport interface SetAppThemeAction extends Action {\r\n    payload: AppTheme;\r\n}\r\n\r\nexport interface SetStoredPlayerInfoAction extends Action {\r\n    payload: StoredPlayerInfo;\r\n}\r\n\r\nexport interface SetStoredRunningGameInfoAction extends Action {\r\n    payload: StoredRunningGameInfo;\r\n}\r\n\r\nexport interface SetDataForNewGamePayload {\r\n    gameId: string;\r\n    gameConfig: GameConfig | null;\r\n    isRejoiningGame: boolean;\r\n    playerInfo: PlayerInfo | null;\r\n}\r\nexport interface SetDataForNewGameAction extends Action {\r\n    payload: SetDataForNewGamePayload\r\n}\r\n\r\nexport interface SetDataOfFinishedGamePayload {\r\n    allPlayers: Map<string, PlayerInfo>;\r\n    gameConfig: GameConfig;\r\n    gameRounds: GameRound[];\r\n}\r\nexport interface SetDataOfFinishedGameAction extends Action {\r\n    payload: SetDataOfFinishedGamePayload\r\n}\r\n\r\nexport interface ResetAppStateAction extends Action {}\r\n\r\nexport type AppAction = SetAppThemeAction | SetStoredPlayerInfoAction | SetStoredRunningGameInfoAction\r\n    | SetDataForNewGameAction | SetDataOfFinishedGameAction | ResetAppStateAction;\r\n\r\n/*\r\n * Action Creators\r\n */\r\nexport const setAppTheme = (payload: AppTheme): SetAppThemeAction => {\r\n    return { type: SET_APP_THEME, payload }\r\n};\r\nexport const setStoredPlayerInfo = (payload: StoredPlayerInfo): SetStoredPlayerInfoAction => {\r\n    return { type: SET_STORED_PLAYER_INFO, payload }\r\n};\r\nexport const setStoredRunningGameInfo = (payload: StoredRunningGameInfo): SetStoredRunningGameInfoAction => {\r\n    return { type: SET_STORED_RUNNING_GAME_INFO, payload }\r\n};\r\nexport const setDataForNewGame = (payload: SetDataForNewGamePayload): SetDataForNewGameAction => {\r\n    return { type: SET_DATA_FOR_NEW_GAME, payload }\r\n};\r\nexport const setDataOfFinishedGame = (payload: SetDataOfFinishedGamePayload): SetDataOfFinishedGameAction => {\r\n    return { type: SET_DATA_OF_FINISHED_GAME, payload }\r\n};\r\nexport const resetAppState = (): ResetAppStateAction => {\r\n    return { type: RESET_APP_STATE }\r\n};\r\n","import { some } from 'lodash';\r\nimport randomnItem from 'random-item';\r\nimport { ONLY_ANSWER_POINTS, SAME_WORD_POINTS, STANDARD_POINTS } from '../constants/game.constant';\r\nimport { Collection } from '../models/collection.interface';\r\nimport { GameConfigScoringOptions, PlayerInput, HallOfFameEntry } from '../models/game.interface';\r\nimport { PlayerInfo } from '../models/player.interface';\r\nimport { EXTRA_POINTS } from './../constants/game.constant';\r\nimport { GameResultForPlayer, GameRound, GameRoundEvaluation, PlayerInputEvaluation, GameConfig } from './../models/game.interface';\r\nimport { createAndFillArray } from './general.utils';\r\n\r\n/**\r\n* Returns an array of unique letters. The number of letters is defined by the parameter numberOfLetters.\r\n* If the second argument is not provided, then the standard alphabet (excluding Q, X and Y) is used.\r\n*/\r\nexport const getRandomnLetters = (numberOfLetters: number, possibleLetters: string[]): string[] => {\r\n    if (numberOfLetters > possibleLetters.length) {\r\n        throw new Error('Cannot create more randomn unique letters than the number of possibleLetters provided!');\r\n    }\r\n    const randomnLetters: string[] = [];\r\n    let lettersToRandomnlySelectFrom = [...possibleLetters];\r\n    for (let i = 0; i < numberOfLetters; i++) {\r\n        const randomnLetter = randomnItem(lettersToRandomnlySelectFrom);\r\n        randomnLetters.push(randomnLetter);\r\n        lettersToRandomnlySelectFrom = lettersToRandomnlySelectFrom.filter(letter => letter !== randomnLetter);\r\n    }\r\n    return randomnLetters;\r\n};\r\n\r\nexport const getPlayersInAlphabeticalOrder = (players: Map<string, PlayerInfo>): PlayerInfo[] => {\r\n    let playerInfoArray = Array.from(players).map(data => data[1]);\r\n    return playerInfoArray.sort((a, b) => {\r\n        if (a.name.toLowerCase() < b.name.toLowerCase()) { return -1; }\r\n        if (a.name.toLowerCase() > b.name.toLowerCase()) { return 1; }\r\n        return 0;\r\n    });\r\n};\r\n\r\n/**\r\n * Returns an array of PlayerInput objects with empty strings and default settings (isMarkedCreative=false, valid=true, standard points).\r\n */\r\nexport const getEmptyRoundInputs = (numberOfInputs: number): PlayerInput[] => {\r\n    return createAndFillArray<PlayerInput>(numberOfInputs, { points: STANDARD_POINTS, star: false, text: '', valid: true });\r\n};\r\n\r\n/**\r\n* Checks each PlayerInput object whether it contains text.\r\n* If text string is empty, valid is set to false, otherwise to true.\r\n* The text is also trimmed in order to support correct scoring (finding duplicates).\r\n*/\r\nexport const markEmptyPlayerInputsAsInvalid = (playerInputs: PlayerInput[]): PlayerInput[] => {\r\n    return playerInputs.map(input => ({ ...input, text: input.text.trim(), valid: !!input.text }));\r\n};\r\n\r\nexport const createGameRoundEvaluation = (players: Map<string, PlayerInfo>, categories: string[]): GameRoundEvaluation => {\r\n    const gameRoundEvaluation = new Map<string, PlayerInputEvaluation[]>();\r\n    players.forEach(evaluatedPlayer => {\r\n        const evaluationsForAllCategories: PlayerInputEvaluation[] = [];\r\n        categories.forEach(_ => {\r\n            const evaluationForOneCategory: PlayerInputEvaluation = new Map<string, boolean>();\r\n            players.forEach(evaluatingPlayer => {\r\n                // The default evaluation for each input is valid (= true).\r\n                evaluationForOneCategory.set(evaluatingPlayer.id, true);\r\n            });\r\n            evaluationsForAllCategories.push(evaluationForOneCategory);\r\n        });\r\n        gameRoundEvaluation.set(evaluatedPlayer.id, evaluationsForAllCategories);\r\n    });\r\n    return gameRoundEvaluation;\r\n};\r\n\r\n/**\r\n * Calculates the points for the round's inputs according to the active scoring options.\r\n */\r\nexport const calculatePointsForRound = (scoringOptions: GameConfigScoringOptions, round: GameRound) => {\r\n    if (!scoringOptions.checkForDuplicates && !scoringOptions.onlyPlayerWithValidAnswer) { return; }\r\n    const playerId = round.keys().next().value;\r\n    const playerInputsOfPlayer1 = round.get(playerId) as PlayerInput[];\r\n    // Loop through all categories.\r\n    for (let categoryIndex = 0; categoryIndex < playerInputsOfPlayer1.length; categoryIndex++) {\r\n        calculatePointsForCategory(scoringOptions, round, categoryIndex);\r\n    }\r\n};\r\n\r\n/**\r\n * Calculates the points for the round's inputs for one category according to the active scoring options.\r\n */\r\nexport const calculatePointsForCategory = (scoringOptions: GameConfigScoringOptions, round: GameRound, categoryIndex: number) => {\r\n    if (!scoringOptions.checkForDuplicates && !scoringOptions.onlyPlayerWithValidAnswer) { return; }\r\n    Array.from(round.keys()).forEach(playerId => {\r\n        const playerInputs = round.get(playerId) as PlayerInput[];\r\n        // Only check valid inputs.\r\n        if (playerInputs[categoryIndex].valid) {\r\n            if (scoringOptions.onlyPlayerWithValidAnswer && isOnlyPlayerWithValidAnswer(playerId, round, categoryIndex)) {\r\n                playerInputs[categoryIndex].points = ONLY_ANSWER_POINTS;\r\n            } else {\r\n                if (scoringOptions.checkForDuplicates && isDuplicateOfOtherPlayersInput(playerId, round, categoryIndex)) {\r\n                    playerInputs[categoryIndex].points = SAME_WORD_POINTS;\r\n                } else {\r\n                    playerInputs[categoryIndex].points = STANDARD_POINTS;\r\n                }\r\n            }\r\n        }\r\n    });\r\n};\r\n\r\nexport const isOnlyPlayerWithValidAnswer = (playerId: string, round: GameRound, categoryIndex: number): boolean => {\r\n    const otherPlayersIds = Array.from(round.keys()).filter(id => id !== playerId);\r\n    let isOnlyPlayer = true;\r\n    otherPlayersIds.forEach(id => isOnlyPlayer = isOnlyPlayer && !(round.get(id) as PlayerInput[])[categoryIndex].valid);\r\n    return isOnlyPlayer;\r\n};\r\n\r\n/**\r\n * Returns true if a duplicate (removes all non-alphanumeric characters for comparison) for playerId's input was found.\r\n */\r\nexport const isDuplicateOfOtherPlayersInput = (playerId: string, round: GameRound, categoryIndex: number): boolean => {\r\n    const otherPlayersIds = Array.from(round.keys()).filter(id => id !== playerId);\r\n    const playerInputText = (round.get(playerId) as PlayerInput[])[categoryIndex].text.toLowerCase().replace(/[^0-9a-z]/gi, '');\r\n    return some(otherPlayersIds, id => {\r\n        const otherPlayersInput = (round.get(id) as PlayerInput[])[categoryIndex];\r\n        return otherPlayersInput.valid && playerInputText === otherPlayersInput.text.toLowerCase().replace(/[^0-9a-z]/gi, '');\r\n    });\r\n};\r\n\r\n/**\r\n * Determines the minimum number of players that need to mark a player's input as invalid\r\n * for the input text to be set to invalid and not count as a point for the player.\r\n */\r\nexport const getMinNumberOfInvalids = (numberOfPlayers: number): number => {\r\n    return numberOfPlayers <= 3 ? 1 : 2;\r\n};\r\n\r\n/**\r\n * Returns how many players marked the input as invalid.\r\n */\r\nexport const getNumberOfInvalids = (evaluations: PlayerInputEvaluation): number => {\r\n    let count = 0;\r\n    evaluations.forEach(markedAsValid => count = markedAsValid ? count : count + 1);\r\n    return count;\r\n};\r\n\r\n/**\r\n * Returns the players that marked the input as invalid in alphabetical order. Parameters:\r\n * - evaluations: Evaluations of all players for one player's input for one category.\r\n * - players: All players taking part in the running game of \"Stadt-Land-Fluss\".\r\n */\r\nexport const getRejectingPlayers = (evaluations: PlayerInputEvaluation, players: Map<string, PlayerInfo>): PlayerInfo[] => {\r\n    const rejectingPlayers = new Map<string, PlayerInfo>();\r\n    evaluations.forEach((markedAsValid, playerId) => {\r\n        if (!markedAsValid) {\r\n            const playerInfo = players.get(playerId);\r\n            if (playerInfo) {\r\n                rejectingPlayers.set(playerId, playerInfo);\r\n            }\r\n        }\r\n    });\r\n    return getPlayersInAlphabeticalOrder(rejectingPlayers);;\r\n};\r\n\r\n/**\r\n * Adds extra points for \"very creative answers\" if scoring option is active\r\n * and sets invalid answer's points to zero.\r\n */\r\nexport const applyValidFlagAndStarFlagToPoints = (scoringOptions: GameConfigScoringOptions, round: GameRound) => {\r\n    round.forEach(playerInputs => {\r\n        playerInputs.forEach(input => {\r\n            if (!input.valid) {\r\n                input.points = 0;\r\n            } else if (scoringOptions.creativeAnswersExtraPoints && input.star) {\r\n                input.points = input.points + EXTRA_POINTS;\r\n            }\r\n        });\r\n    });\r\n};\r\n\r\n/**\r\n * Calculates game results and sorts them by points in descending order.\r\n */\r\nexport const calculateGameResults = (allPlayers: Map<string, PlayerInfo>, gameRounds: GameRound[]): GameResultForPlayer[] => {\r\n    const gameResults: GameResultForPlayer[] = [];\r\n    const pointsPerPlayer: Collection<GameResultForPlayer> = {};\r\n    allPlayers.forEach((playerInfo, playerId) => pointsPerPlayer[playerId] = { playerName: playerInfo.name, points: 0 });\r\n    gameRounds.forEach(round => {\r\n        round.forEach((playerInputs, playerId) => {\r\n            const points = playerInputs.reduce((total, input) => total + input.points, 0);\r\n            pointsPerPlayer[playerId].points += points;\r\n        });\r\n    });\r\n    Object.keys(pointsPerPlayer).forEach(playerId => gameResults.push(pointsPerPlayer[playerId]));\r\n    return gameResults.sort((a, b) => b.points - a.points);\r\n};\r\n\r\n/**\r\n * Creates a list of entries for the \"Hall of Fame\", the list of answers marked as \"very creative\".\r\n */\r\nexport const createHallOfFameData = (allPlayers: Map<string, PlayerInfo>, gameConfig: GameConfig, gameRounds: GameRound[]): HallOfFameEntry[] => {\r\n    const hallOfFameData: HallOfFameEntry[] = [];\r\n    gameRounds.forEach(round => {\r\n        round.forEach((playerInputs, playerId) => {\r\n            const playerInfo = allPlayers.get(playerId) as PlayerInfo;\r\n            playerInputs.forEach((playerInput, categoryIndex) => {\r\n                if (playerInput.valid && playerInput.star) {\r\n                    hallOfFameData.push({\r\n                        category: gameConfig.categories[categoryIndex],\r\n                        playerName: playerInfo.name,\r\n                        text: playerInput.text\r\n                    });\r\n                }\r\n            });\r\n        });\r\n    });\r\n    return hallOfFameData;\r\n};\r\n","import './GameResults.css';\r\nimport { Divider } from '@material-ui/core';\r\nimport React, { Component, Dispatch } from 'react';\r\nimport { connect } from 'react-redux';\r\nimport { RouterProps } from 'react-router';\r\nimport GameResultsList from '../../components/GameResultsList/GameResultsList';\r\nimport GameRoundsOverviewButton from '../../components/GameRoundsOverviewButton/GameRoundsOverviewButton';\r\nimport HallOfFameButton from '../../components/HallOfFameButton/HallOfFameButton';\r\nimport ScoringOptionsList from '../../components/ScoringOptionsList/ScoringOptionsList';\r\nimport { SectionHeader } from '../../components/SectionHeader/SectionHeader';\r\nimport ToDashboardButton from '../../components/ToDashboardButton/ToDashboardButton';\r\nimport { GameConfig, GameResultForPlayer, HallOfFameEntry } from '../../models/game.interface';\r\nimport { PlayerInfo } from '../../models/player.interface';\r\nimport { AppAction, resetAppState } from '../../store/app.actions';\r\nimport { AppState } from '../../store/app.reducer';\r\nimport { calculateGameResults, getPlayersInAlphabeticalOrder, createHallOfFameData } from '../../utils/game.utils';\r\n\r\ninterface GameResultsDispatchProps {\r\n    onResetAppState: () => void;\r\n}\r\ninterface GameResultsProps extends AppState, GameResultsDispatchProps, RouterProps { }\r\ninterface GameResultsState {\r\n    gameResults: GameResultForPlayer[];\r\n    hallOfFameData: HallOfFameEntry[];\r\n    sortedPlayers: PlayerInfo[];\r\n}\r\n\r\nclass GameResults extends Component<GameResultsProps, GameResultsState> {\r\n    public state: GameResultsState = {\r\n        gameResults: [],\r\n        hallOfFameData: [],\r\n        sortedPlayers: []\r\n    };\r\n\r\n    public render() {\r\n        if (this.props.gameRounds === null) { return null; }\r\n        const gameConfig = this.props.gameConfig as GameConfig;\r\n        return (\r\n            <div className=\"main-content-wrapper\">\r\n                <div className=\"material-card-style\">\r\n                    <SectionHeader showDivider={true} text=\"Ergebnis\"></SectionHeader>\r\n                    <GameResultsList gameResults={this.state.gameResults} />\r\n                    <Divider />\r\n                    <div className=\"slf-game-results-button-wrapper\">\r\n                        <GameRoundsOverviewButton\r\n                            gameConfig={gameConfig}\r\n                            rounds={this.props.gameRounds}\r\n                            sortedPlayers={this.state.sortedPlayers}\r\n                        />\r\n                        <HallOfFameButton hallOfFameData={this.state.hallOfFameData} />\r\n                    </div>\r\n                </div>\r\n                <div className=\"material-card-style\">\r\n                    <SectionHeader showDivider={true} text=\"Spiele-Settings\"></SectionHeader>\r\n                    <p>Runden: {gameConfig.numberOfRounds}</p>\r\n                    <p>Buchstaben: {gameConfig.letters.join(', ')}</p>\r\n                    <p>Kategorien: {gameConfig.categories.join(', ')}</p>\r\n                    <ScoringOptionsList rules={gameConfig.scoringOptions} />\r\n                </div>\r\n                <ToDashboardButton onReturnToDashboard={this.returnToDashboard} />\r\n            </div>\r\n        );\r\n    }\r\n\r\n    public componentDidMount() {\r\n        const { allPlayers, gameConfig, gameRounds} = this.props;\r\n        // If there are no allPlayers or gameRounds present in application state, then reroute user to dashboard.\r\n        if (allPlayers === null || gameRounds === null) {\r\n            this.props.history.push('/');\r\n            return;\r\n        }\r\n        this.setState({\r\n            gameResults: calculateGameResults(allPlayers, gameRounds),\r\n            hallOfFameData: createHallOfFameData(allPlayers, gameConfig as GameConfig, gameRounds),\r\n            sortedPlayers: getPlayersInAlphabeticalOrder(allPlayers)\r\n        });\r\n    }\r\n\r\n    private returnToDashboard = () => {\r\n        this.props.history.push('/');\r\n        this.props.onResetAppState();\r\n    }\r\n}\r\n\r\nconst mapStateToProps = (state: AppState): AppState => state;\r\nconst mapDispatchToProps = (dispatch: Dispatch<AppAction>): GameResultsDispatchProps => {\r\n    return {\r\n        onResetAppState: () => dispatch(resetAppState())\r\n    }\r\n};\r\nexport default connect(mapStateToProps, mapDispatchToProps)(GameResults);\r\n","import Chip from '@material-ui/core/Chip';\r\nimport { createStyles, makeStyles, Theme } from '@material-ui/core/styles';\r\nimport ChevronRightIcon from '@material-ui/icons/ChevronRight';\r\nimport DoneIcon from '@material-ui/icons/Done';\r\nimport React from 'react';\r\n\r\nexport enum ChipType {\r\n    available = 'available',\r\n    selected = 'selected'\r\n}\r\n\r\nconst useStyles = makeStyles((theme: Theme) =>\r\n    createStyles({\r\n        root: {\r\n            display: 'flex',\r\n            justifyContent: 'center',\r\n            flexWrap: 'wrap',\r\n            padding: theme.spacing(0.5),\r\n        },\r\n        chip: {\r\n            margin: theme.spacing(0.5),\r\n        },\r\n        chipIcon: {\r\n            backgroundColor: 'inherit'\r\n        }\r\n    }),\r\n);\r\n\r\ninterface ChipsArrayProps {\r\n    chipsArray: string[];\r\n    chipType: ChipType;\r\n    removeChip: (chip: string) => any;\r\n}\r\n\r\nconst ChipsArray: React.FunctionComponent<ChipsArrayProps> = props => {\r\n    const classes = useStyles();\r\n    return (\r\n        <div className={classes.root}>\r\n            {props.chipsArray.map((chip, index) => (\r\n                <Chip\r\n                    key={`chip-to-${props.chipType}-${index}`}\r\n                    color={props.chipType === 'selected' ? 'primary' : undefined}\r\n                    icon={props.chipType === 'selected' ? <DoneIcon className=\"chip-icon-no-bg\" /> : <ChevronRightIcon />}\r\n                    label={chip}\r\n                    className={classes.chip}\r\n                    onClick={() => props.removeChip(chip)}\r\n                />\r\n            ))}\r\n            {props.children}\r\n        </div>\r\n    );\r\n}\r\n\r\nexport default ChipsArray;\r\n","import { GameConfig, GameRound, PlayerInput, StoredRunningGameInfo } from '../models/game.interface';\r\nimport { StoredPlayerInfo } from '../models/player.interface';\r\nimport { APP_THEME_ID } from './../constants/themes.constant';\r\nimport { convertMapToCollection, convertCollectionToMap } from './general.utils';\r\nimport { MAX_NUMBER_OF_ROUNDS } from '../constants/game.constant';\r\n\r\nconst APP_THEME_LS_KEY = 'SLF-APP-THEME';\r\nconst PLAYER_INFO_LS_KEY = 'SLF-PLAYER-INFO';\r\nconst RUNNING_GAME_INFO_LS_KEY = 'SLF-RUNNING-GAME-INFO';\r\nconst RUNNING_GAME_CONFIG_LS_KEY = 'SLF-RUNNING-GAME-CONFIG';\r\n/** Is used to store a completed round in local storage; e.g. 'SLF-RUNNING-GAME-ROUND-1' */\r\nconst RUNNING_GAME_ROUND_LS_KEY_PREFIX = 'SLF-RUNNING-GAME-ROUND-';\r\n\r\nexport const getAppThemeIdFromLocalStorage = (): string | null =>  localStorage.getItem(APP_THEME_LS_KEY);\r\nexport const setAppThemeIdInLocalStorage = (appTheme: APP_THEME_ID) => localStorage.setItem(APP_THEME_LS_KEY, appTheme);\r\n\r\nexport const getPlayerInfoFromLocalStorage = (): StoredPlayerInfo | null => {\r\n    const storedData = localStorage.getItem(PLAYER_INFO_LS_KEY);\r\n    return storedData ? JSON.parse(storedData) : null;\r\n};\r\nexport const setPlayerInfoInLocalStorage = (data: StoredPlayerInfo) => localStorage.setItem(PLAYER_INFO_LS_KEY, JSON.stringify(data));\r\n\r\nexport const getRunningGameInfoFromLocalStorage = (): StoredRunningGameInfo | null => {\r\n    const storedData = localStorage.getItem(RUNNING_GAME_INFO_LS_KEY);\r\n    return storedData ? JSON.parse(storedData) : null;\r\n};\r\nexport const setRunningGameInfoInLocalStorage = (data: StoredRunningGameInfo) => localStorage.setItem(RUNNING_GAME_INFO_LS_KEY, JSON.stringify(data));\r\n\r\nexport const getRunningGameConfigFromLocalStorage = (): GameConfig | null => {\r\n    const storedData = localStorage.getItem(RUNNING_GAME_CONFIG_LS_KEY);\r\n    return storedData ? JSON.parse(storedData) : null;\r\n};\r\nexport const setRunningGameConfigInLocalStorage = (data: GameConfig) => localStorage.setItem(RUNNING_GAME_CONFIG_LS_KEY, JSON.stringify(data));\r\n\r\nexport const getRunningGameRoundFromLocalStorage = (round: number): GameRound | null => {\r\n    const storedData = localStorage.getItem(RUNNING_GAME_ROUND_LS_KEY_PREFIX + round);\r\n    return storedData ? convertCollectionToMap<PlayerInput[]>(JSON.parse(storedData)) : null;\r\n}\r\nexport const setRunningGameRoundInLocalStorage = (round: number, data: GameRound) => {\r\n    localStorage.setItem(\r\n        RUNNING_GAME_ROUND_LS_KEY_PREFIX + round,\r\n        JSON.stringify(convertMapToCollection<PlayerInput[]>(data))\r\n    );\r\n}\r\n\r\nexport const removeAllDataOfRunningGameFromLocalStorage = () => {\r\n    localStorage.removeItem(RUNNING_GAME_INFO_LS_KEY);\r\n    localStorage.removeItem(RUNNING_GAME_CONFIG_LS_KEY);\r\n    for (let i = 1; i <= MAX_NUMBER_OF_ROUNDS; i++) {\r\n        localStorage.removeItem(RUNNING_GAME_ROUND_LS_KEY_PREFIX + i);\r\n    }\r\n};\r\n","import './JoinGame.css';\r\nimport { Button, TextField } from '@material-ui/core';\r\nimport DirectionsWalkIcon from '@material-ui/icons/DirectionsWalk';\r\nimport React, { ChangeEvent, Component, Dispatch, FormEvent } from 'react';\r\nimport { connect } from 'react-redux';\r\nimport { RouteComponentProps } from 'react-router';\r\nimport {\r\n    RejoinRunningGameHint,\r\n    RejoinRunningGameHintContext,\r\n} from '../../components/RejoinRunningGameHint/RejoinRunningGameHint';\r\nimport { SectionHeader } from '../../components/SectionHeader/SectionHeader';\r\nimport ToDashboardButton from '../../components/ToDashboardButton/ToDashboardButton';\r\nimport { PlayerInfo } from '../../models/player.interface';\r\nimport { AppAction, setDataForNewGame, SetDataForNewGamePayload } from '../../store/app.actions';\r\nimport { AppState } from '../../store/app.reducer';\r\nimport { convertDateToUnixTimestamp } from '../../utils/general.utils';\r\nimport {\r\n    removeAllDataOfRunningGameFromLocalStorage,\r\n    setPlayerInfoInLocalStorage,\r\n    setRunningGameInfoInLocalStorage,\r\n} from '../../utils/local-storage.utils';\r\n\r\ninterface JoinGamePropsFromStore {\r\n    gameId: string | null;\r\n    playerIdCreationTimestamp: number;\r\n    playerInfo: PlayerInfo | null;\r\n}\r\ninterface JoinGameDispatchProps {\r\n    onSetGameData: (payload: SetDataForNewGamePayload) => void\r\n}\r\ninterface JoinGameProps extends JoinGamePropsFromStore, JoinGameDispatchProps, RouteComponentProps { }\r\ninterface JoinGameState {\r\n    idInput: string;\r\n    nameInput: string;\r\n    validateInputs: boolean;\r\n}\r\n\r\nclass JoinGame extends Component<JoinGameProps, JoinGameState> {\r\n    public state: JoinGameState = {\r\n        idInput: '',\r\n        nameInput: this.props.playerInfo ? this.props.playerInfo.name : '',\r\n        validateInputs: false\r\n    };\r\n\r\n    public render() {\r\n        const joinGameForm = (\r\n            <form onSubmit={this.handleSubmit} className=\"app-form\" noValidate autoComplete=\"off\">\r\n                <TextField\r\n                    name=\"nameInput\"\r\n                    label=\"Spielername\"\r\n                    value={this.state.nameInput}\r\n                    onChange={this.handleInputChange}\r\n                    className=\"app-form-input\"\r\n                    variant=\"outlined\"\r\n                    fullWidth\r\n                    required\r\n                    autoFocus\r\n                    error={this.state.validateInputs && !this.state.nameInput}\r\n                />\r\n                <TextField\r\n                    name=\"idInput\"\r\n                    label=\"Spiel-ID\"\r\n                    value={this.state.idInput}\r\n                    onChange={this.handleInputChange}\r\n                    className=\"app-form-input\"\r\n                    variant=\"outlined\"\r\n                    fullWidth\r\n                    required\r\n                    error={this.state.validateInputs && !this.state.idInput}\r\n                />\r\n                <div className=\"button-wrapper\">\r\n                    <Button\r\n                        type=\"submit\"\r\n                        color=\"primary\"\r\n                        variant=\"contained\"\r\n                        size=\"large\"\r\n                        startIcon={<DirectionsWalkIcon />}\r\n                    >Beitreten</Button>\r\n                </div>\r\n            </form>\r\n        );\r\n        return (\r\n            <div className=\"main-content-wrapper\">\r\n                {this.props.gameId ? <RejoinRunningGameHint context={RejoinRunningGameHintContext.joingame} /> : null}\r\n                <div className=\"material-card-style\">\r\n                    <SectionHeader showDivider={true} text=\"Spiel beitreten\"></SectionHeader>\r\n                    {joinGameForm}\r\n                </div>\r\n                <ToDashboardButton onReturnToDashboard={this.returnToDashboard} />\r\n            </div>\r\n        );\r\n    }\r\n\r\n    public componentDidMount() {\r\n        const query = new URLSearchParams(this.props.location.search);\r\n        if (query.has('id')) {\r\n            this.setState({ idInput: query.get('id') as string });\r\n        }\r\n    }\r\n\r\n    public componentDidUpdate(prevProps: JoinGameProps) {\r\n        if (this.props.playerInfo && this.props.playerInfo !== prevProps.playerInfo) {\r\n            this.setState({ nameInput: this.props.playerInfo.name });\r\n        }\r\n    }\r\n\r\n    private handleInputChange = (event: ChangeEvent<HTMLInputElement>) => {\r\n        const { name, value } = event.target;\r\n        this.setState({ [name]: value } as any);\r\n    }\r\n\r\n    private handleSubmit = (event: FormEvent) => {\r\n        event.preventDefault();\r\n        if (this.state.idInput && this.state.nameInput.trim()) {\r\n            this.joinGame();\r\n        } else {\r\n            this.setState({ nameInput: this.state.nameInput.trim(), validateInputs: true });\r\n        }\r\n    }\r\n\r\n    private joinGame = () => {\r\n        const playerInfo = this.props.playerInfo as PlayerInfo;\r\n        const idCreationTimestamp = this.props.playerIdCreationTimestamp\r\n        const { idInput, nameInput } = this.state;\r\n        removeAllDataOfRunningGameFromLocalStorage();\r\n        setPlayerInfoInLocalStorage({ id: playerInfo.id, idCreationTimestamp, name: nameInput.trim() });\r\n        setRunningGameInfoInLocalStorage({ gameId: idInput, idCreationTimestamp: convertDateToUnixTimestamp(new Date()), isPlayerAdmin: false });\r\n        this.props.onSetGameData({\r\n            gameConfig: null,\r\n            gameId: idInput,\r\n            isRejoiningGame: false,\r\n            playerInfo: {\r\n                id: playerInfo.id,\r\n                isAdmin: false,\r\n                name: nameInput.trim()\r\n            }\r\n        });\r\n        this.props.history.push('/play');\r\n    }\r\n\r\n    private returnToDashboard = () => {\r\n        this.props.history.push('/');\r\n    }\r\n}\r\n\r\nconst mapStateToProps = (state: AppState): JoinGamePropsFromStore => {\r\n    return {\r\n        gameId: state.gameId,\r\n        playerIdCreationTimestamp: state.playerIdCreationTimestamp,\r\n        playerInfo: state.playerInfo\r\n    };\r\n}\r\nconst mapDispatchToProps = (dispatch: Dispatch<AppAction>): JoinGameDispatchProps => {\r\n    return {\r\n        onSetGameData: (payload: SetDataForNewGamePayload) => dispatch(setDataForNewGame(payload))\r\n    }\r\n};\r\nexport default connect(mapStateToProps, mapDispatchToProps)(JoinGame);\r\n","import {\r\n    Button,\r\n    Dialog,\r\n    DialogActions,\r\n    DialogContent,\r\n    DialogContentText,\r\n    IconButton,\r\n    TextField,\r\n    Tooltip,\r\n} from '@material-ui/core';\r\nimport { createStyles, makeStyles } from '@material-ui/core/styles';\r\nimport AddCircleOutlineIcon from '@material-ui/icons/AddCircleOutline';\r\nimport React, { FormEvent, useState } from 'react';\r\n\r\nconst useStyles = makeStyles(() =>\r\n    createStyles({\r\n        lessPadding: {\r\n            padding: '0.375rem 0.5rem'\r\n        },\r\n        dialog: {\r\n            minWidth: '20rem'\r\n        }\r\n    }),\r\n);\r\n\r\nexport interface CustomCategoryDialogProps {\r\n    open: boolean;\r\n    onClose: (newCategory: string | null) => void;\r\n}\r\nconst CustomCategoryDialog: React.FunctionComponent<CustomCategoryDialogProps> = props => {\r\n    const classes = useStyles();\r\n    const { onClose, open } = props;\r\n    const [categoryInput, setCategoryInput] = useState('');\r\n    const [validateInputs, setValidateInputs] = useState(false);\r\n\r\n    const handleClose = () => {\r\n        onClose(null);\r\n    };\r\n\r\n    const handleSubmit = (event: FormEvent) => {\r\n        event.preventDefault();\r\n        event.stopPropagation();\r\n        const trimmedCategoryInput = categoryInput.trim();\r\n        if (trimmedCategoryInput !== '') {\r\n            setCategoryInput('');\r\n            setValidateInputs(false);\r\n            onClose(trimmedCategoryInput);\r\n        } else {\r\n            setCategoryInput('');\r\n            setValidateInputs(true);\r\n        }\r\n    };\r\n\r\n    return (\r\n        <Dialog onClose={handleClose} open={open}>\r\n            <form onSubmit={handleSubmit} className={classes.dialog} noValidate autoComplete=\"off\">\r\n                <DialogContent>\r\n                    <DialogContentText>Kategorie hinzufgen</DialogContentText>\r\n                    <TextField\r\n                        id=\"new-category-input\"\r\n                        autoFocus\r\n                        margin=\"dense\"\r\n                        fullWidth\r\n                        required\r\n                        value={categoryInput}\r\n                        error={validateInputs && !categoryInput}\r\n                        onChange={event => setCategoryInput(event.target.value)}\r\n                    />\r\n                </DialogContent>\r\n                <DialogActions>\r\n                    <Button\r\n                        type=\"button\"\r\n                        onClick={handleClose}\r\n                    >Abbrechen</Button>\r\n                    <Button\r\n                        type=\"submit\"\r\n                        color=\"primary\"\r\n                    >Hinzufgen</Button>\r\n                </DialogActions>\r\n            </form>\r\n        </Dialog>\r\n    );\r\n}\r\n\r\ninterface AddCustomCategoryProps {\r\n    addCustomCategory: (newCategory: string) => any;\r\n}\r\nconst AddCustomCategory: React.FunctionComponent<AddCustomCategoryProps> = props => {\r\n    const classes = useStyles();\r\n    const [open, setOpen] = useState(false);\r\n\r\n    const handleClose = (newCategory: string | null) => {\r\n        setOpen(false);\r\n        if (newCategory) {\r\n            props.addCustomCategory(newCategory);\r\n        }\r\n    }\r\n\r\n    return (\r\n        <React.Fragment>\r\n            <Tooltip\r\n                title=\"Kategorie hinzufgen\"\r\n                placement=\"right\"\r\n            >\r\n                <IconButton\r\n                    className={classes.lessPadding}\r\n                    aria-label=\"Kategorie hinzufgen\"\r\n                    onClick={() => setOpen(true)}\r\n                >\r\n                    <AddCircleOutlineIcon />\r\n                </IconButton>\r\n            </Tooltip>\r\n            <CustomCategoryDialog open={open} onClose={newCategory => handleClose(newCategory)} />\r\n        </React.Fragment>\r\n    );\r\n}\r\n\r\nexport default AddCustomCategory;\r\n","import './NewGame.css';\r\nimport {\r\n    Button,\r\n    Checkbox,\r\n    Divider,\r\n    ExpansionPanel,\r\n    ExpansionPanelDetails,\r\n    ExpansionPanelSummary,\r\n    FormControlLabel,\r\n    FormGroup,\r\n    Snackbar,\r\n    TextField,\r\n} from '@material-ui/core';\r\nimport AddCircleIcon from '@material-ui/icons/AddCircle';\r\nimport ExpandMoreIcon from '@material-ui/icons/ExpandMore';\r\nimport { xor } from 'lodash';\r\nimport React, { ChangeEvent, Component, Dispatch, FormEvent } from 'react';\r\nimport { connect } from 'react-redux';\r\nimport { RouteComponentProps } from 'react-router';\r\nimport { v4 as uuidv4 } from 'uuid';\r\nimport AddCustomCategory from '../../components/AddCustomCategory/AddCustomCategory';\r\nimport ChipsArray, { ChipType } from '../../components/ChipsArray/ChipsArray';\r\nimport {\r\n    RejoinRunningGameHint,\r\n    RejoinRunningGameHintContext,\r\n} from '../../components/RejoinRunningGameHint/RejoinRunningGameHint';\r\nimport { SectionHeader } from '../../components/SectionHeader/SectionHeader';\r\nimport ToDashboardButton from '../../components/ToDashboardButton/ToDashboardButton';\r\nimport {\r\n    AVAILABLE_CATEGORIES,\r\n    DEFAULT_NUMBER_OF_ROUNDS,\r\n    GAME_OPTION_LABEL,\r\n    MAX_NUMBER_OF_ROUNDS,\r\n    MIN_NUMBER_OF_CATEGORIES,\r\n    MIN_NUMBER_OF_ROUNDS,\r\n    STANDARD_ALPHABET,\r\n    STANDARD_CATEGORIES,\r\n    STANDARD_EXCLUDED_LETTERS,\r\n} from '../../constants/game.constant';\r\nimport { PlayerInfo } from '../../models/player.interface';\r\nimport { AppAction, setDataForNewGame, SetDataForNewGamePayload } from '../../store/app.actions';\r\nimport { AppState } from '../../store/app.reducer';\r\nimport { getRandomnLetters } from '../../utils/game.utils';\r\nimport { convertDateToUnixTimestamp } from '../../utils/general.utils';\r\nimport {\r\n    removeAllDataOfRunningGameFromLocalStorage,\r\n    setPlayerInfoInLocalStorage,\r\n    setRunningGameInfoInLocalStorage,\r\n} from '../../utils/local-storage.utils';\r\n\r\nenum CategoryArray {\r\n    available = 'available',\r\n    selected = 'selected'\r\n}\r\nenum CheckboxName {\r\n    checkForDuplicates = 'checkForDuplicates',\r\n    creativeAnswersExtraPoints = 'creativeAnswersExtraPoints',\r\n    onlyPlayerWithValidAnswer = 'onlyPlayerWithValidAnswer'\r\n}\r\n\r\ninterface NewGamePropsFromStore {\r\n    gameId: string | null;\r\n    playerIdCreationTimestamp: number;\r\n    playerInfo: PlayerInfo | null;\r\n}\r\ninterface NewGameDispatchProps {\r\n    onSetGameData: (payload: SetDataForNewGamePayload) => void\r\n}\r\ninterface NewGameProps extends NewGamePropsFromStore, NewGameDispatchProps, RouteComponentProps { }\r\ninterface NewGameState {\r\n    availableCategories: string[];\r\n    [CheckboxName.checkForDuplicates]: boolean;\r\n    [CheckboxName.creativeAnswersExtraPoints]: boolean;\r\n    isSnackbarOpen: boolean;\r\n    lettersToExclude: string[];\r\n    nameInput: string;\r\n    numberOfRoundsInput: number;\r\n    [CheckboxName.onlyPlayerWithValidAnswer]: boolean;\r\n    selectedCategories: string[];\r\n    snackBarMessage: string;\r\n    validateInputs: boolean;\r\n}\r\n\r\nclass NewGame extends Component<NewGameProps, NewGameState> {\r\n    public state: NewGameState = {\r\n        availableCategories: AVAILABLE_CATEGORIES,\r\n        checkForDuplicates: true,\r\n        creativeAnswersExtraPoints: false,\r\n        isSnackbarOpen: false,\r\n        lettersToExclude: [...STANDARD_EXCLUDED_LETTERS],\r\n        nameInput: this.props.playerInfo ? this.props.playerInfo.name : '',\r\n        numberOfRoundsInput: DEFAULT_NUMBER_OF_ROUNDS,\r\n        onlyPlayerWithValidAnswer: true,\r\n        selectedCategories: STANDARD_CATEGORIES,\r\n        snackBarMessage: '',\r\n        validateInputs: false\r\n    };\r\n\r\n    public render() {\r\n        const numberOfRoundsInputLabel = `Anzahl Runden (${MIN_NUMBER_OF_ROUNDS}-${MAX_NUMBER_OF_ROUNDS})`;\r\n        const newGameForm = (\r\n            <form onSubmit={this.handleSubmit} className=\"app-form\" noValidate autoComplete=\"off\">\r\n                <TextField\r\n                    name=\"nameInput\"\r\n                    label=\"Spielername (max. 20 Zeichen)\"\r\n                    value={this.state.nameInput}\r\n                    onChange={this.handleNameInputChange}\r\n                    className=\"app-form-input\"\r\n                    variant=\"outlined\"\r\n                    fullWidth\r\n                    required\r\n                    autoFocus\r\n                    error={this.state.validateInputs && !this.state.nameInput}\r\n                    inputProps={{ 'maxLength': '20' }}\r\n                />\r\n                <TextField\r\n                    name=\"numberOfRoundsInput\"\r\n                    label={numberOfRoundsInputLabel}\r\n                    type=\"number\"\r\n                    value={this.state.numberOfRoundsInput}\r\n                    onChange={this.handleNumberOfRoundsInputChange}\r\n                    variant=\"outlined\"\r\n                    fullWidth\r\n                    required\r\n                    inputProps={{ 'min': MIN_NUMBER_OF_ROUNDS, 'max': MAX_NUMBER_OF_ROUNDS }}\r\n                />\r\n                <ExpansionPanel className=\"more-options-expansion-panel\">\r\n                    <ExpansionPanelSummary\r\n                        expandIcon={<ExpandMoreIcon />}\r\n                        aria-controls=\"panel1a-content\"\r\n                        id=\"panel1a-header\"\r\n                    >\r\n                        Weitere Optionen\r\n                    </ExpansionPanelSummary>\r\n                    <ExpansionPanelDetails>\r\n                        <FormGroup className=\"game-options-list\">\r\n                            <FormControlLabel\r\n                                control={\r\n                                    <Checkbox\r\n                                        checked={this.state.checkForDuplicates}\r\n                                        name={CheckboxName.checkForDuplicates}\r\n                                        color=\"primary\"\r\n                                        onChange={this.handleGameOptionChange}\r\n                                    />\r\n                                }\r\n                                label={GAME_OPTION_LABEL.checkForDuplicates}\r\n                            />\r\n                            <FormControlLabel\r\n                                control={\r\n                                    <Checkbox\r\n                                        checked={this.state.onlyPlayerWithValidAnswer}\r\n                                        name={CheckboxName.onlyPlayerWithValidAnswer}\r\n                                        color=\"primary\"\r\n                                        onChange={this.handleGameOptionChange}\r\n                                    />\r\n                                }\r\n                                label={GAME_OPTION_LABEL.onlyPlayerWithValidAnswer}\r\n                            />\r\n                            <FormControlLabel\r\n                                control={\r\n                                    <Checkbox\r\n                                        checked={this.state.creativeAnswersExtraPoints}\r\n                                        name={CheckboxName.creativeAnswersExtraPoints}\r\n                                        color=\"primary\"\r\n                                        onChange={this.handleGameOptionChange}\r\n                                    />\r\n                                }\r\n                                label={GAME_OPTION_LABEL.creativeAnswersExtraPoints}\r\n                            />\r\n                        </FormGroup>\r\n                        <Divider />\r\n                        <p className=\"category-array-label\">Folgende Buchstaben ausschlieen:</p>\r\n                        <FormGroup row className=\"letters-to-exclude\">\r\n                            {STANDARD_ALPHABET.map((letter, letterIndex) => (\r\n                                <FormControlLabel\r\n                                    key={`slf-letters-to-exclude-${letterIndex}`}\r\n                                    control={\r\n                                        <Checkbox\r\n                                            checked={this.state.lettersToExclude.includes(letter)}\r\n                                            color=\"primary\"\r\n                                            onChange={(event) => this.handleLetterToExcludeChange(event, letter)}\r\n                                        />\r\n                                    }\r\n                                    label={letter}\r\n                                />\r\n                            ))}\r\n                        </FormGroup>\r\n                    </ExpansionPanelDetails>\r\n                </ExpansionPanel>\r\n                <p className=\"category-array-label\">Ausgewhlte Kategorien (mind. {MIN_NUMBER_OF_CATEGORIES}):</p>\r\n                <ChipsArray\r\n                    chipsArray={this.state.selectedCategories}\r\n                    chipType={ChipType.selected}\r\n                    removeChip={(chipToRemove) => this.updateCategoryArrays(chipToRemove, CategoryArray.selected)}\r\n                />\r\n                <p className=\"category-array-label\">Verfgbare Kategorien:</p>\r\n                <ChipsArray\r\n                    chipsArray={this.state.availableCategories}\r\n                    chipType={ChipType.available}\r\n                    removeChip={(chipToRemove) => this.updateCategoryArrays(chipToRemove, CategoryArray.available)}\r\n                >\r\n                    <AddCustomCategory addCustomCategory={this.addCustomCategory} />\r\n                </ChipsArray>\r\n                <div className=\"button-wrapper add-margin-top\">\r\n                    <Button\r\n                        type=\"submit\"\r\n                        color=\"primary\"\r\n                        variant=\"contained\"\r\n                        size=\"large\"\r\n                        startIcon={<AddCircleIcon />}\r\n                    >Spiel erstellen</Button>\r\n                </div>\r\n            </form>\r\n        );\r\n        return (\r\n            <div className=\"main-content-wrapper\">\r\n                {this.props.gameId ? <RejoinRunningGameHint context={RejoinRunningGameHintContext.newgame} /> : null}\r\n                <div className=\"material-card-style\">\r\n                    <SectionHeader showDivider={true} text=\"Neues Spiel\" />\r\n                    {newGameForm}\r\n                </div>\r\n                <ToDashboardButton onReturnToDashboard={this.returnToDashboard} />\r\n                <Snackbar\r\n                    anchorOrigin={{ vertical: 'bottom', horizontal: 'center' }}\r\n                    open={this.state.isSnackbarOpen}\r\n                    autoHideDuration={3000}\r\n                    onClose={this.handleSnackBarClose}\r\n                    message={this.state.snackBarMessage}\r\n                />\r\n            </div>\r\n        );\r\n    }\r\n\r\n    public componentDidUpdate(prevProps: NewGameProps) {\r\n        if (this.props.playerInfo && this.props.playerInfo !== prevProps.playerInfo) {\r\n            this.setState({ nameInput: this.props.playerInfo.name });\r\n        }\r\n    }\r\n\r\n    private handleNameInputChange = (event: ChangeEvent<HTMLInputElement>) => {\r\n        this.setState({ nameInput: event.target.value });\r\n    }\r\n\r\n    private handleNumberOfRoundsInputChange = (event: ChangeEvent<HTMLInputElement>) => {\r\n        let value = +event.target.value;\r\n        if (value >= MIN_NUMBER_OF_ROUNDS && value <= MAX_NUMBER_OF_ROUNDS) {\r\n            this.setState({ numberOfRoundsInput: value });\r\n        }\r\n    }\r\n\r\n    private handleGameOptionChange = (event: React.ChangeEvent<HTMLInputElement>) => {\r\n        this.setState({ ...this.state, [event.target.name]: event.target.checked });\r\n    }\r\n\r\n    private handleLetterToExcludeChange = (event: React.ChangeEvent<HTMLInputElement>, letter: string) => {\r\n        const { lettersToExclude } = this.state;\r\n        const newLettersToExclude = event.target.checked ? [...lettersToExclude, letter] : lettersToExclude.filter(l => l !== letter);\r\n        this.setState({ lettersToExclude: newLettersToExclude });\r\n    }\r\n\r\n    private updateCategoryArrays = (chipToRemove: string, removeFromArray: CategoryArray) => {\r\n        let newSelectedCategories: string[];\r\n        let newAvailableCategories: string[];\r\n        if (removeFromArray === CategoryArray.selected) {\r\n            newSelectedCategories = this.state.selectedCategories.filter(category => category !== chipToRemove);\r\n            newAvailableCategories = [...this.state.availableCategories];\r\n            newAvailableCategories.push(chipToRemove);\r\n        } else {\r\n            newAvailableCategories = this.state.availableCategories.filter(category => category !== chipToRemove);\r\n            newSelectedCategories = [...this.state.selectedCategories];\r\n            newSelectedCategories.push(chipToRemove);\r\n        }\r\n        this.setState({\r\n            availableCategories: newAvailableCategories,\r\n            selectedCategories: newSelectedCategories\r\n        });\r\n    }\r\n\r\n    private addCustomCategory = (newCategory: string) => {\r\n        this.setState({ availableCategories: [...this.state.availableCategories, newCategory] });\r\n    }\r\n\r\n    private handleSubmit = (event: FormEvent) => {\r\n        event.preventDefault();\r\n        if (this.isReadyToStartGame()) {\r\n            this.startNewGame();\r\n        } else {\r\n            this.setState({ nameInput: this.state.nameInput.trim(), validateInputs: true });\r\n        }\r\n    }\r\n\r\n    private isReadyToStartGame = (): boolean => {\r\n        if (this.state.selectedCategories.length < MIN_NUMBER_OF_CATEGORIES) {\r\n            this.showSnackBar(`Du musst mindestens ${MIN_NUMBER_OF_CATEGORIES} Kategorien auswhlen!`);\r\n            return false;\r\n        }\r\n        if (STANDARD_ALPHABET.length - this.state.lettersToExclude.length < this.state.numberOfRoundsInput) {\r\n            this.showSnackBar(`Du hast zu viele Buchstaben ausgeschlossen!`);\r\n            return false;\r\n        }\r\n        return !!this.state.nameInput.trim();\r\n    }\r\n\r\n    private showSnackBar = (message: string) =>  this.setState({ isSnackbarOpen: true, snackBarMessage: message});\r\n    private handleSnackBarClose = () =>  this.setState({ isSnackbarOpen: false });\r\n\r\n    private startNewGame = () => {\r\n        const playerInfo = this.props.playerInfo as PlayerInfo;\r\n        const idCreationTimestamp = this.props.playerIdCreationTimestamp\r\n        const { nameInput, numberOfRoundsInput, selectedCategories } = this.state;\r\n        const gameId = uuidv4(); //  e.g. '9b1deb4d-3b7d-4bad-9bdd-2b0d7b3dcb6d'\r\n        removeAllDataOfRunningGameFromLocalStorage();\r\n        setPlayerInfoInLocalStorage({ id: playerInfo.id, idCreationTimestamp, name: nameInput.trim() });\r\n        setRunningGameInfoInLocalStorage({ gameId, idCreationTimestamp: convertDateToUnixTimestamp(new Date()), isPlayerAdmin: true });\r\n        this.props.onSetGameData({\r\n            gameConfig: {\r\n                categories: selectedCategories,\r\n                letters: getRandomnLetters(numberOfRoundsInput, xor(STANDARD_ALPHABET, this.state.lettersToExclude)),\r\n                numberOfRounds: numberOfRoundsInput,\r\n                scoringOptions: {\r\n                    checkForDuplicates: this.state.checkForDuplicates,\r\n                    creativeAnswersExtraPoints: this.state.creativeAnswersExtraPoints,\r\n                    onlyPlayerWithValidAnswer: this.state.onlyPlayerWithValidAnswer\r\n                }\r\n            },\r\n            gameId,\r\n            isRejoiningGame: false,\r\n            playerInfo: {\r\n                id: playerInfo.id,\r\n                isAdmin: true,\r\n                name: nameInput.trim()\r\n            }\r\n        });\r\n        this.props.history.push('/play');\r\n    }\r\n\r\n    private returnToDashboard = () => {\r\n        this.props.history.push('/');\r\n    }\r\n}\r\n\r\nconst mapStateToProps = (state: AppState): NewGamePropsFromStore => {\r\n    return {\r\n        gameId: state.gameId,\r\n        playerIdCreationTimestamp: state.playerIdCreationTimestamp,\r\n        playerInfo: state.playerInfo\r\n    };\r\n}\r\nconst mapDispatchToProps = (dispatch: Dispatch<AppAction>): NewGameDispatchProps => {\r\n    return {\r\n        onSetGameData: (payload: SetDataForNewGamePayload) => dispatch(setDataForNewGame(payload))\r\n    }\r\n};\r\nexport default connect(mapStateToProps, mapDispatchToProps)(NewGame);\r\n","import { GamePhase } from '../constants/game.constant';\r\nimport { Collection } from './collection.interface';\r\nimport { EvaluationOfPlayerInput, GameConfig, IsPlayerInputVeryCreativeStatus, PlayerInput } from './game.interface';\r\nimport { PlayerInfo } from './player.interface';\r\n\r\nexport interface PubNubUserState {\r\n    gameConfig?: GameConfig;\r\n    playerInfo: PlayerInfo;\r\n}\r\n\r\nexport enum PubNubMessageType {\r\n    currentRoundInputs = 'currentRoundInputs',\r\n    dataForCurrentGame = 'dataForCurrentGame',\r\n    evaluationFinished = 'evaluationFinished',\r\n    evaluationOfPlayerInput = 'evaluationOfPlayerInput',\r\n    isPlayerInputVeryCreative = 'isPlayerInputVeryCreative',\r\n    kickPlayer = 'kickPlayer',\r\n    requestGameData = 'requestGameData',\r\n    roundFinished = 'roundFinished',\r\n    startGame = 'startGame'\r\n}\r\n\r\nexport interface PubNubMessage {\r\n    type: PubNubMessageType;\r\n    payload?: any;\r\n}\r\n\r\nexport class PubNubCurrentRoundInputsMessage {\r\n    constructor(private payload: PlayerInput[]) {}\r\n\r\n    public toPubNubMessage(): PubNubMessage {\r\n        return {\r\n            type: PubNubMessageType.currentRoundInputs,\r\n            payload: this.payload\r\n        }\r\n    }\r\n}\r\n\r\nexport class PubNubEvaluationOfPlayerInputMessage {\r\n    constructor(private payload: EvaluationOfPlayerInput) {}\r\n\r\n    public toPubNubMessage(): PubNubMessage {\r\n        return {\r\n            type: PubNubMessageType.evaluationOfPlayerInput,\r\n            payload: this.payload\r\n        }\r\n    }\r\n}\r\n\r\nexport class PubNubIsPlayerInputVeryCreativeMessage {\r\n    constructor(private payload: IsPlayerInputVeryCreativeStatus) {}\r\n\r\n    public toPubNubMessage(): PubNubMessage {\r\n        return {\r\n            type: PubNubMessageType.isPlayerInputVeryCreative,\r\n            payload: this.payload\r\n        }\r\n    }\r\n}\r\n\r\nexport class PubNubKickPlayerMessage {\r\n    constructor(private payload: string) {}\r\n\r\n    public toPubNubMessage(): PubNubMessage {\r\n        return {\r\n            type: PubNubMessageType.kickPlayer,\r\n            payload: this.payload\r\n        }\r\n    }\r\n}\r\n\r\nexport interface PubNubDataForCurrentGameMessagePayload {\r\n    compressedGameRoundEvaluation: boolean[][][];\r\n    compressedMarkedAsCreativeFlags: boolean[][];\r\n    currentPhase: GamePhase;\r\n    currentRound: number;\r\n    playersThatFinishedEvaluation: Collection<boolean>;\r\n    requestingPlayerId: string;\r\n    sortedPlayers: PlayerInfo[];\r\n}\r\nexport class PubNubDataForCurrentGameMessage {\r\n    constructor(private payload: PubNubDataForCurrentGameMessagePayload) {}\r\n\r\n    public toPubNubMessage(): PubNubMessage {\r\n        return {\r\n            type: PubNubMessageType.dataForCurrentGame,\r\n            payload: this.payload\r\n        }\r\n    }\r\n}\r\n","import {\r\n    Button,\r\n    Dialog,\r\n    DialogActions,\r\n    DialogContent,\r\n    DialogContentText,\r\n    IconButton,\r\n    ListItemIcon,\r\n    ListItemText,\r\n    Menu,\r\n    MenuItem,\r\n} from '@material-ui/core';\r\nimport { createStyles, makeStyles } from '@material-ui/core/styles';\r\nimport CancelIcon from '@material-ui/icons/Cancel';\r\nimport SettingsIcon from '@material-ui/icons/Settings';\r\nimport React, { useState } from 'react';\r\nimport { PlayerInfo } from '../../models/player.interface';\r\nimport { getPlayersInAlphabeticalOrder } from '../../utils/game.utils';\r\n\r\nconst useStyles = makeStyles(_ =>\r\n    createStyles({\r\n        adminPanel: {\r\n            position: 'absolute',\r\n            top: '1rem',\r\n            right: '1rem'\r\n        },\r\n        menuButton: {\r\n            background: 'radial-gradient(circle, rgba(255,255,255,1) 0%, rgba(255,255,255,0.5) 35%, rgba(255,255,255,0) 60%);'\r\n        },\r\n        dialogContent: {\r\n            maxWidth: '23rem'\r\n        },\r\n        dialogContentText: {\r\n            color: 'black'\r\n        }\r\n    }),\r\n);\r\n\r\nexport interface KickUserDialogProps {\r\n    open: boolean;\r\n    playerToBeKicked: PlayerInfo | null;\r\n    onClose: (kickPlayer: boolean) => void;\r\n}\r\nconst KickUserDialog: React.FunctionComponent<KickUserDialogProps> = props => {\r\n    const classes = useStyles();\r\n    const { onClose, open } = props;\r\n\r\n    return (\r\n        <Dialog onClose={() => onClose(false)} open={open}>\r\n            <DialogContent classes={{ root: classes.dialogContent }}>\r\n                {props.playerToBeKicked ? (\r\n                    <DialogContentText classes={{ root: classes.dialogContentText }}>\r\n                        \"With great power comes great responsibility\"  Willst du {props.playerToBeKicked.name} wirklich aus dem Spiel werfen?\r\n                    </DialogContentText>\r\n                ) : null}\r\n            </DialogContent>\r\n            <DialogActions>\r\n                <Button\r\n                    type=\"button\"\r\n                    onClick={() => onClose(false)}\r\n                >Abbrechen</Button>\r\n                <Button\r\n                    type=\"button\"\r\n                    color=\"primary\"\r\n                    onClick={() => onClose(true)}\r\n                >Rauswerfen</Button>\r\n            </DialogActions>\r\n        </Dialog>\r\n    );\r\n}\r\n\r\ninterface AdminPanelProps {\r\n    allPlayers: Map<string, PlayerInfo>;\r\n    kickPlayer: (playerId: string) => void;\r\n}\r\nconst AdminPanel: React.FunctionComponent<AdminPanelProps> = props => {\r\n    const classes = useStyles();\r\n    const [anchorEl, setAnchorEl] = useState<null | HTMLElement>(null);\r\n    const [openDialog, setOpenDialog] = useState(false);\r\n    const [playerToBeKicked, setPlayerToBeKicked] = useState<PlayerInfo | null>(null);\r\n\r\n    const handleClick = (event: React.MouseEvent<HTMLButtonElement>) => {\r\n        setAnchorEl(event.currentTarget);\r\n    };\r\n    const handleMenuItemClick = (selectedPlayer: PlayerInfo) => {\r\n        setAnchorEl(null);\r\n        setPlayerToBeKicked(selectedPlayer);\r\n        setOpenDialog(true);\r\n    };\r\n    const handleAdminPanelClose = () => {\r\n        setAnchorEl(null);\r\n    };\r\n    const handleKickUserDialogClose = (kickPlayer: boolean) => {\r\n        setOpenDialog(false);\r\n        if (kickPlayer && playerToBeKicked) {\r\n            props.kickPlayer(playerToBeKicked.id);\r\n        }\r\n    };\r\n\r\n    const otherPlayers = new Map<string, PlayerInfo>();\r\n    props.allPlayers.forEach((playerInfo, playerId) => {\r\n        if (!playerInfo.isAdmin) { otherPlayers.set(playerId, playerInfo); }\r\n    });\r\n    const sortedPlayers = getPlayersInAlphabeticalOrder(otherPlayers);\r\n    return (\r\n        <div className={classes.adminPanel}>\r\n            <IconButton\r\n                className={classes.menuButton}\r\n                title=\"Admin-Panel ffnen\"\r\n                aria-label=\"Admin-Panel ffnen\"\r\n                aria-controls=\"admin-panel\"\r\n                aria-haspopup=\"true\"\r\n                onClick={handleClick}\r\n            >\r\n                <SettingsIcon color=\"primary\" />\r\n            </IconButton>\r\n            <Menu\r\n                id=\"admin-panel\"\r\n                anchorEl={anchorEl}\r\n                keepMounted\r\n                open={Boolean(anchorEl)}\r\n                onClose={handleAdminPanelClose}\r\n            >\r\n                {sortedPlayers.map((playerInfo, playerIndex) => (\r\n                    <MenuItem\r\n                        key={`menu-item-delete-player-${playerIndex}`}\r\n                        title={`${playerInfo.name} aus dem Spiel werfen`}\r\n                        onClick={() => handleMenuItemClick(playerInfo)}\r\n                    >\r\n                        <ListItemIcon>\r\n                            <CancelIcon color=\"secondary\" />\r\n                        </ListItemIcon>\r\n                        <ListItemText primary={playerInfo.name} />\r\n                    </MenuItem>\r\n                ))}\r\n            </Menu>\r\n            <KickUserDialog\r\n                open={openDialog}\r\n                playerToBeKicked={playerToBeKicked}\r\n                onClose={handleKickUserDialogClose}\r\n            />\r\n        </div>\r\n    );\r\n}\r\n\r\nexport default AdminPanel;\r\n","import './LetterAnimation.css';\r\nimport React, { useEffect } from 'react';\r\nimport {\r\n    LETTER_ANIMATION_LETTER_COUNT,\r\n    LETTER_ANIMATION_REDRAW_SPEED,\r\n    STANDARD_ALPHABET,\r\n} from '../../constants/game.constant';\r\nimport { AppTheme, AppThemes } from '../../constants/themes.constant';\r\nimport { getRandomnLetters } from '../../utils/game.utils';\r\n\r\n// Thanks to Georgi Nikoloff for the great animation source code: https://codepen.io/gbnikolov/pen/jEqQdG\r\n// I rewrote the code in Typescript, refactored it a bit and adapted it to the needs of this application.\r\n\r\nclass Particle {\r\n    private radius = 3.5;\r\n\r\n    constructor(\r\n        public x: number,\r\n        public y: number\r\n    ) { }\r\n\r\n    public draw(ctx: CanvasRenderingContext2D) {\r\n        ctx.save();\r\n        ctx.translate(this.x, this.y);\r\n        ctx.fillStyle = 'white';\r\n        ctx.fillRect(0, 0, this.radius, this.radius);\r\n        ctx.restore();\r\n    };\r\n}\r\n\r\nclass ParticleAlphabet {\r\n    private canvas: HTMLCanvasElement;\r\n    private ctx: CanvasRenderingContext2D;\r\n    private currentPos: number;\r\n    private width: number;\r\n    private height: number;\r\n    private particlePositions: any[];\r\n    private particles: Particle[];\r\n    private tmpCanvas: HTMLCanvasElement;\r\n    private tmpCtx: CanvasRenderingContext2D;\r\n    private time: string;\r\n    private counter = 0;\r\n    private myInterval: any;\r\n    private activeTheme: AppTheme;\r\n\r\n    constructor(\r\n        public letters: string[],\r\n        public callbackWhenAnimationDone: () => void\r\n    ) {\r\n        this.canvas = document.querySelector('#letter-animation-canvas') as HTMLCanvasElement;\r\n        this.ctx = this.canvas.getContext('2d') as CanvasRenderingContext2D;\r\n        const mainElement = document.querySelector('main') as HTMLElement;\r\n        this.activeTheme = AppThemes.find(theme => mainElement.classList.contains(theme.className)) as AppTheme;\r\n        this.width = mainElement.offsetWidth;\r\n        this.height = mainElement.offsetHeight;\r\n        this.particlePositions = [];\r\n        this.particles = [];\r\n        this.tmpCanvas = document.createElement('canvas');\r\n        this.tmpCtx = this.tmpCanvas.getContext('2d') as CanvasRenderingContext2D;\r\n\r\n        this.canvas.width = this.width;\r\n        this.canvas.height = this.height;\r\n        this.particlePositions = [];\r\n        this.currentPos = 0;\r\n        this.time = '';\r\n    }\r\n\r\n    public init() {\r\n        this.myInterval = setInterval(() => {\r\n            if (this.counter < this.letters.length) {\r\n                this.changeLetter();\r\n                this.getPixels(this.tmpCanvas, this.tmpCtx);\r\n            }\r\n            this.counter++;\r\n            if (this.counter > this.letters.length + 1) {\r\n                clearInterval(this.myInterval);\r\n                this.callbackWhenAnimationDone();\r\n            }\r\n        }, LETTER_ANIMATION_REDRAW_SPEED);\r\n\r\n        this.makeParticles(1000);\r\n        this.animate();\r\n    }\r\n\r\n    private changeLetter() {\r\n        this.time = this.letters[this.currentPos];\r\n        this.currentPos++;\r\n        if (this.currentPos >= this.letters.length) {\r\n            this.currentPos = 0;\r\n        }\r\n    }\r\n\r\n    private makeParticles(num: number) {\r\n        for (var i = 0; i <= num; i++) {\r\n            const x = this.width / 2 + Math.random() * 400 - 200;\r\n            const y = this.height / 2 + Math.random() * 400 - 200;\r\n            this.particles.push(new Particle(x, y));\r\n        }\r\n    }\r\n\r\n    private getPixels(canvas: any, ctx: any) {\r\n        const keyword = this.time,\r\n            gridX = 6,\r\n            gridY = 6;\r\n        canvas.width = window.innerWidth;\r\n        canvas.height = window.innerHeight;\r\n        ctx.fillStyle = 'red';\r\n        ctx.font = 'italic bold 330px Noto Serif';\r\n        ctx.fillText(keyword, canvas.width / 2 - ctx.measureText(keyword).width / 2, canvas.height / 2 + 100);\r\n        const idata = ctx.getImageData(0, 0, canvas.width, canvas.height);\r\n        const buffer32 = new Uint32Array(idata.data.buffer);\r\n        if (this.particlePositions.length > 0) this.particlePositions = [];\r\n        for (let y = 0; y < canvas.height; y += gridY) {\r\n            for (let x = 0; x < canvas.width; x += gridX) {\r\n                if (buffer32[y * canvas.width + x]) {\r\n                    this.particlePositions.push({ x: x, y: y });\r\n                }\r\n            }\r\n        }\r\n    }\r\n\r\n    private animateParticles() {\r\n        let p, pPos;\r\n        for (let i = 0, num = this.particles.length; i < num; i++) {\r\n            p = this.particles[i];\r\n            pPos = this.particlePositions[i];\r\n            if (this.particles.indexOf(p) === this.particlePositions.indexOf(pPos)) {\r\n                p.x += (pPos.x - p.x) * .3;\r\n                p.y += (pPos.y - p.y) * .3;\r\n                p.draw(this.ctx);\r\n            }\r\n        }\r\n    }\r\n\r\n    private animate = () => {\r\n        requestAnimationFrame(this.animate);\r\n        this.ctx.fillStyle = this.activeTheme.animationBackgroundColor;\r\n        this.ctx.fillRect(0, 0, this.width, this.height);\r\n        this.animateParticles();\r\n    }\r\n}\r\n\r\ninterface LetterAnimationProps {\r\n    letterToUnveil: string;\r\n    callbackWhenAnimationDone: () => void;\r\n}\r\nexport const LetterAnimation: React.FunctionComponent<LetterAnimationProps> = props => {\r\n    const lettersToUse = [...STANDARD_ALPHABET].filter(letter => letter !== props.letterToUnveil);\r\n    const lettersForAnimation = [...getRandomnLetters(LETTER_ANIMATION_LETTER_COUNT - 1, lettersToUse), props.letterToUnveil];\r\n    useEffect(() => {\r\n        const particleAlphabet = new ParticleAlphabet(lettersForAnimation, props.callbackWhenAnimationDone);\r\n        particleAlphabet.init();\r\n    });\r\n    return (\r\n        <canvas id=\"letter-animation-canvas\"></canvas>\r\n    );\r\n}\r\n","import { CircularProgress } from '@material-ui/core';\r\nimport { createStyles, makeStyles } from '@material-ui/core/styles';\r\nimport React from 'react';\r\n\r\nconst loadingSpinnerSize = 60;\r\n\r\nconst useStyles = makeStyles(_ =>\r\n    createStyles({\r\n        loadingScreen: {\r\n            position: 'absolute',\r\n            top: '0',\r\n            left: '0',\r\n            height: '100%',\r\n            width: '100%',\r\n            backgroundColor: 'rgba(0, 0, 0, 0.5)'\r\n        },\r\n        loadingSpinner: {\r\n            position: 'absolute',\r\n            top: '50%',\r\n            left: '50%',\r\n            transform: 'translate(-50%, -50%)',\r\n            width: loadingSpinnerSize + 'px'\r\n        }\r\n    }),\r\n);\r\n\r\nconst LoadingScreen: React.FunctionComponent = () => {\r\n    const classes = useStyles();\r\n    return (\r\n        <div className={classes.loadingScreen}>\r\n            <div className={classes.loadingSpinner}>\r\n                <CircularProgress color=\"secondary\" size={loadingSpinnerSize} />\r\n            </div>\r\n        </div>\r\n    );\r\n}\r\n\r\nexport default LoadingScreen;\r\n","import Chip from '@material-ui/core/Chip';\r\nimport { createStyles, makeStyles } from '@material-ui/core/styles';\r\nimport EmojiObjectsIcon from '@material-ui/icons/EmojiObjects';\r\nimport React from 'react';\r\n\r\nconst useStyles = makeStyles(_ =>\r\n    createStyles({\r\n        centerContent: {\r\n            display: 'flex',\r\n            justifyContent: 'center'\r\n        },\r\n        chip: {\r\n            height: '3rem',\r\n            marginTop: '1rem',\r\n            borderRadius: '5px',\r\n            fontSize: '1.2rem',\r\n            boxShadow: '0 2px 4px rgba(0,0,0,.501961)'\r\n        }\r\n    }),\r\n);\r\n\r\ninterface GameRoundChipProps {\r\n    currentLetter: string;\r\n    currentRound: number;\r\n    numberOfRounds: number;\r\n}\r\n\r\nconst GameRoundChip: React.FunctionComponent<GameRoundChipProps> = props => {\r\n    const classes = useStyles();\r\n    const { currentLetter, currentRound, numberOfRounds } = props;\r\n    return (\r\n        <div className={classes.centerContent}>\r\n            <Chip\r\n                color=\"primary\"\r\n                icon={<EmojiObjectsIcon />}\r\n                label={`Runde ${currentRound} von ${numberOfRounds}: ${currentLetter}`}\r\n                className={classes.chip}\r\n            />\r\n        </div>\r\n    );\r\n}\r\n\r\nexport default GameRoundChip;\r\n","import './PhaseEvaluateRound.css';\r\nimport {\r\n    Badge,\r\n    Chip,\r\n    createStyles,\r\n    IconButton,\r\n    InputAdornment,\r\n    TextField,\r\n    Theme,\r\n    Tooltip,\r\n    withStyles,\r\n} from '@material-ui/core';\r\nimport CheckCircleIcon from '@material-ui/icons/CheckCircle';\r\nimport RadioButtonUncheckedIcon from '@material-ui/icons/RadioButtonUnchecked';\r\nimport SearchIcon from '@material-ui/icons/Search';\r\nimport StarIcon from '@material-ui/icons/Star';\r\nimport StarBorderIcon from '@material-ui/icons/StarBorder';\r\nimport ThumbDownRoundedIcon from '@material-ui/icons/ThumbDownRounded';\r\nimport React, { useState } from 'react';\r\nimport { EXTRA_POINTS } from '../../constants/game.constant';\r\nimport {\r\n    EvaluationOfPlayerInput,\r\n    GameConfig,\r\n    GameRound,\r\n    GameRoundEvaluation,\r\n    IsPlayerInputVeryCreativeStatus,\r\n    PlayerInput,\r\n    PlayerInputEvaluation,\r\n} from '../../models/game.interface';\r\nimport { PlayerInfo } from '../../models/player.interface';\r\nimport { getPlayersInAlphabeticalOrder, getRejectingPlayers } from '../../utils/game.utils';\r\nimport GameRoundChip from '../GameRoundChip/GameRoundChip';\r\nimport { SectionHeader } from '../SectionHeader/SectionHeader';\r\n\r\nconst StyledBadge = withStyles((theme: Theme) =>\r\n    createStyles({\r\n        badge: {\r\n            right: -3,\r\n            top: '100%',\r\n            border: `2px solid ${theme.palette.background.paper}`,\r\n            padding: '0 4px',\r\n        },\r\n    }),\r\n)(Badge);\r\n\r\ninterface PhaseEvaluateRoundProps {\r\n    allPlayers: Map<string, PlayerInfo>;\r\n    currentRound: number;\r\n    currentRoundEvaluation: GameRoundEvaluation;\r\n    gameConfig: GameConfig;\r\n    gameRounds: GameRound[];\r\n    /** Player info for the user of this instance of the \"Stadt-Land-Fluss\" app. */\r\n    playerInfo: PlayerInfo;\r\n    playersThatFinishedEvaluation: Map<string, boolean>;\r\n    sendEvaluationFinishedMessage: () => void;\r\n    updateEvaluationOfPlayerInput: (newEvaluation: EvaluationOfPlayerInput) => void;\r\n    updateIsPlayerInputVeryCreativeStatus: (newStatus: IsPlayerInputVeryCreativeStatus) => void;\r\n}\r\nconst PhaseEvaluateRound: React.FunctionComponent<PhaseEvaluateRoundProps> = props => {\r\n    const [hasFinishedEvaluation, setHasFinishedEvaluation] = useState(props.playersThatFinishedEvaluation.has(props.playerInfo.id));\r\n    const { allPlayers, currentRound, currentRoundEvaluation, gameConfig, playerInfo, playersThatFinishedEvaluation } = props;\r\n    // Retrieve data for finished round; e.g. if current round is 1, then data is at index 0.\r\n    const finishedRound = props.gameRounds[currentRound - 1];\r\n    const currentLetter = gameConfig.letters[currentRound - 1];\r\n    const sortedPlayers = getPlayersInAlphabeticalOrder(allPlayers);\r\n    const notFinishedPlayers: string[] = [];\r\n    sortedPlayers.forEach(player => {\r\n        if (!playersThatFinishedEvaluation.has(player.id)) { notFinishedPlayers.push(player.name); }\r\n    });\r\n\r\n    /**\r\n      * Toggles the user's evaluation of a player's input for a category,\r\n      * but only if the user hasn't accepted the round evaluation yet.\r\n      */\r\n    const handleEvaluationButtonClick = (\r\n        categoryIndex: number, evaluatedPlayerId: string, currentEvaluation: boolean\r\n    ) => {\r\n        if (!hasFinishedEvaluation) {\r\n            props.updateEvaluationOfPlayerInput({ categoryIndex, evaluatedPlayerId, markedAsValid: !currentEvaluation });\r\n        }\r\n    }\r\n    /**\r\n     * Displays a button that allows the user to reject a player's input for a category.\r\n     * A badge attached to the button shows the total number of rejections. If the player\r\n     * didn't type any text, then a not clickable thumb down icon is shown instead,\r\n     * which indicates that the input was automatically rejected by the application.\r\n     */\r\n    const createEvaluationButton = (categoryIndex: number, indexInSortedPlayers: number): JSX.Element => {\r\n        const evaluatedPlayer = sortedPlayers[indexInSortedPlayers];\r\n        const allEvaluationsForPlayer = currentRoundEvaluation.get(evaluatedPlayer.id) as PlayerInputEvaluation[];\r\n        const evaluationForCategory = allEvaluationsForPlayer[categoryIndex];\r\n        const isInputAcceptedByUser = evaluationForCategory.get(playerInfo.id) as boolean;\r\n        const rejectingPlayers = getRejectingPlayers(evaluationForCategory, allPlayers);\r\n        const tooltipText = rejectingPlayers.length === 0 ? 'Keine Ablehnungen' :\r\n            'Abgelehnt von ' + rejectingPlayers.map(p => p.name).join(', ');\r\n        const hasPlayerTypedText = !!(finishedRound.get(evaluatedPlayer.id) as PlayerInput[])[categoryIndex].text;\r\n\r\n        const evaluationButtonForTypedText = (\r\n            <Tooltip\r\n                key={`slf-evaluation-tooltip-${categoryIndex}-${indexInSortedPlayers}`}\r\n                title={tooltipText}\r\n            >\r\n                <IconButton\r\n                    className=\"slf-evaluation-button\"\r\n                    color={isInputAcceptedByUser ? 'default' : 'secondary'}\r\n                    onClick={() => handleEvaluationButtonClick(categoryIndex, evaluatedPlayer.id, isInputAcceptedByUser)}\r\n                >\r\n                    <StyledBadge badgeContent={rejectingPlayers.length} color=\"secondary\">\r\n                        <ThumbDownRoundedIcon />\r\n                    </StyledBadge>\r\n                </IconButton>\r\n            </Tooltip>\r\n        );\r\n        const autoRejectIconForMissingText = (\r\n            <Tooltip\r\n                key={`slf-evaluation-tooltip-${categoryIndex}-${indexInSortedPlayers}`}\r\n                title=\"Automatisch abgelehnt\"\r\n            >\r\n                <ThumbDownRoundedIcon color=\"secondary\" className=\"slf-auto-reject-icon\" />\r\n            </Tooltip>\r\n        );\r\n\r\n        return (\r\n            <div\r\n                key={`slf-evaluation-button-wrapper-${categoryIndex}-${indexInSortedPlayers}`}\r\n                className=\"slf-evaluation-button-wrapper\"\r\n            >\r\n                {hasPlayerTypedText ? evaluationButtonForTypedText : autoRejectIconForMissingText}\r\n            </div>\r\n        );\r\n    }\r\n    /**\r\n     * Creates a search link for a specific category and player input.\r\n     */\r\n    const createSearchLink = (categoryIndex: number, indexInSortedPlayers: number): JSX.Element => {\r\n        const category = gameConfig.categories[categoryIndex];\r\n        const evaluatedPlayer = sortedPlayers[indexInSortedPlayers];\r\n        const playerInput = (finishedRound.get(evaluatedPlayer.id) as PlayerInput[])[categoryIndex].text;\r\n        const searchLink = `https://www.ecosia.org/search?q=${encodeURIComponent(category)}+${encodeURIComponent(playerInput)}`\r\n        return (\r\n            <a\r\n                className=\"slf-evaluation-search-link\"\r\n                href={searchLink}\r\n                target=\"_blank\"\r\n                rel=\"noopener noreferrer\"\r\n                aria-label=\"Begriff nachschlagen\"\r\n            >\r\n                <Tooltip\r\n                    title=\"Begriff nachschlagen\"\r\n                    placement=\"bottom\"\r\n                >\r\n                    <SearchIcon color=\"primary\" fontSize=\"small\" />\r\n                </Tooltip>\r\n            </a>\r\n        );\r\n    }\r\n    /**\r\n      * Toggles the \"marked as very creative\" status of a player's input for a category,\r\n      * but only if the user hasn't accepted the round evaluation yet and isn't trying to mark their own answer as \"very creative\".\r\n      */\r\n    const handleMarkAsCreativeAnswerToggleClick = (\r\n        categoryIndex: number, evaluatedPlayerId: string, isMarkedAsCreative: boolean\r\n    ) => {\r\n        if (!hasFinishedEvaluation && props.playerInfo.id !== evaluatedPlayerId) {\r\n            props.updateIsPlayerInputVeryCreativeStatus({ categoryIndex, evaluatedPlayerId, markedAsCreative: !isMarkedAsCreative });\r\n        }\r\n    }\r\n    /**\r\n     * Creates a \"mark as creative answer\" toggle button for a specific category and player input.\r\n     */\r\n    const createMarkAsCreativeAnswerToggle = (categoryIndex: number, indexInSortedPlayers: number): JSX.Element => {\r\n        const evaluatedPlayer = sortedPlayers[indexInSortedPlayers];\r\n        const playerInput = (finishedRound.get(evaluatedPlayer.id) as PlayerInput[])[categoryIndex];\r\n        return (\r\n            <Tooltip\r\n                title={playerInput.star ? 'Besonders kreativ? Nope!' : 'Als besonders kreativ markieren'}\r\n                placement=\"bottom\"\r\n            >\r\n                <IconButton\r\n                    className=\"slf-mark-as-creative-button\"\r\n                    color=\"primary\"\r\n                    size=\"small\"\r\n                    onClick={() => handleMarkAsCreativeAnswerToggleClick(categoryIndex, evaluatedPlayer.id, playerInput.star)}\r\n                >\r\n                    {playerInput.star ? <StarIcon /> : <StarBorderIcon />}\r\n                </IconButton>\r\n            </Tooltip>\r\n        );\r\n    }\r\n    const createPointsChip = (evaluatedPlayerInput: PlayerInput): JSX.Element => {\r\n        const points = gameConfig.scoringOptions.creativeAnswersExtraPoints && evaluatedPlayerInput.star\r\n            ? evaluatedPlayerInput.points + EXTRA_POINTS : evaluatedPlayerInput.points;\r\n        return <Chip label={`+${points}`} color=\"primary\" />;\r\n    }\r\n    /**\r\n     * Creates a text input showing the player's input for a category. If the player input isn't an empty string,\r\n     * then on the right side of the textfield a search link and clickable evaluation button are displayed.\r\n     */\r\n    const playerEvaluationElements = (categoryIndex: number, indexInSortedPlayers: number): JSX.Element => {\r\n        const evaluatedPlayer = sortedPlayers[indexInSortedPlayers];\r\n        const evaluatedPlayerInput = (finishedRound.get(evaluatedPlayer.id) as PlayerInput[])[categoryIndex];\r\n        const hasPlayerTypedText = !!evaluatedPlayerInput.text;\r\n        const isInputValid = evaluatedPlayerInput.valid;\r\n        const inputCssClass = isInputValid ? (evaluatedPlayerInput.star ? 'very-creative-player-input' : '') : 'invalid-player-input';\r\n        return (\r\n            <div\r\n                key={`slf-evaluation-textfield-wrapper-${categoryIndex}-${indexInSortedPlayers}`}\r\n                className=\"slf-evaluation-textfield-wrapper\"\r\n            >\r\n                <TextField\r\n                    key={'slf-textfield-category-no-' + categoryIndex + '-player-' + indexInSortedPlayers}\r\n                    value={evaluatedPlayerInput.text}\r\n                    variant=\"outlined\"\r\n                    fullWidth\r\n                    InputProps={{\r\n                        className: inputCssClass,\r\n                        spellCheck: false,\r\n                        startAdornment: <InputAdornment position=\"start\">{evaluatedPlayer.name}:</InputAdornment>,\r\n                        endAdornment: <InputAdornment position=\"end\">\r\n                            <div className=\"slf-evaluation-textfield-end-adornment\">\r\n                                {hasPlayerTypedText ? createSearchLink(categoryIndex, indexInSortedPlayers) : null}\r\n                                {isInputValid ? createMarkAsCreativeAnswerToggle(categoryIndex, indexInSortedPlayers) : null}\r\n                                {isInputValid ? createPointsChip(evaluatedPlayerInput) : null}\r\n                            </div>\r\n                        </InputAdornment>\r\n                    }}\r\n                />\r\n                {createEvaluationButton(categoryIndex, indexInSortedPlayers)}\r\n            </div>\r\n        );\r\n    }\r\n    /**\r\n     * Creates a section for each category of the current game. It displays the category in the header,\r\n     * followed by one textfield for each player showing their input for the finished round.\r\n     * If the input isn't empty, a search link and clickable evaluation button are displayed.\r\n     */\r\n    const createCategorySection = (category: string, categoryIndex: number): JSX.Element => (\r\n        <div\r\n            key={'slf-evaluation-for-category-no-' + categoryIndex}\r\n            className=\"material-card-style\"\r\n        >\r\n            <SectionHeader showDivider={false} text={category}></SectionHeader>\r\n            {sortedPlayers.map((_, indexInSortedPlayers) => playerEvaluationElements(categoryIndex, indexInSortedPlayers))}\r\n        </div>\r\n    );\r\n    const onAcceptEvaluationButtonClick = () => {\r\n        if (!hasFinishedEvaluation) {\r\n            setHasFinishedEvaluation(true);\r\n            props.sendEvaluationFinishedMessage();\r\n        }\r\n    }\r\n\r\n    return (\r\n        <React.Fragment>\r\n            <GameRoundChip\r\n                currentLetter={currentLetter}\r\n                currentRound={currentRound}\r\n                numberOfRounds={gameConfig.numberOfRounds}\r\n            />\r\n            <form className=\"app-form\" noValidate autoComplete=\"off\">\r\n                {gameConfig.categories.map(createCategorySection)}\r\n                <div className=\"material-card-style\">\r\n                    Besttigung ausstehend: <span className=\"bold-text\">{notFinishedPlayers.join(', ')}</span>\r\n                </div>\r\n                <IconButton\r\n                    type=\"button\"\r\n                    className=\"fixed-bottom-right-button\"\r\n                    color=\"secondary\"\r\n                    title=\"Besttigen\"\r\n                    aria-label=\"Besttigen\"\r\n                    onClick={onAcceptEvaluationButtonClick}\r\n                >\r\n                    {hasFinishedEvaluation ? <CheckCircleIcon /> : <RadioButtonUncheckedIcon />}\r\n                </IconButton>\r\n            </form>\r\n        </React.Fragment>\r\n    );\r\n}\r\n\r\nexport default PhaseEvaluateRound;\r\n","import { IconButton, InputAdornment, TextField } from '@material-ui/core';\r\nimport EmailIcon from '@material-ui/icons/Email';\r\nimport React, { ChangeEvent } from 'react';\r\nimport { GameConfig, PlayerInput } from '../../models/game.interface';\r\nimport GameRoundChip from '../GameRoundChip/GameRoundChip';\r\nimport { SectionHeader } from '../SectionHeader/SectionHeader';\r\n\r\ninterface PhaseFillOutTextfieldsProps {\r\n    currentRound: number;\r\n    gameConfig: GameConfig;\r\n    gameRoundInputs: PlayerInput[];\r\n    updateCurrentRoundInputs: (newCurrentRoundInputs: PlayerInput[]) => void;\r\n    sendRoundFinishedMessage: () => void;\r\n}\r\n\r\nconst PhaseFillOutTextfields: React.FunctionComponent<PhaseFillOutTextfieldsProps> = props => {\r\n    const { currentRound, gameConfig, gameRoundInputs } = props;\r\n    const currentLetter = gameConfig.letters[currentRound - 1];\r\n\r\n    const handleInputChange = (event: ChangeEvent<HTMLInputElement | HTMLTextAreaElement>, index: number) => {\r\n        const newGameRoundInputs = [...gameRoundInputs];\r\n        newGameRoundInputs[index] = { ...newGameRoundInputs[index], text: event.target.value };\r\n        props.updateCurrentRoundInputs(newGameRoundInputs);\r\n    };\r\n    const createTextfieldElement = (category: string, index: number): JSX.Element => (\r\n        <div\r\n            key={'slf-input-for-category-no-' + index}\r\n            className=\"material-card-style\"\r\n        >\r\n            <SectionHeader showDivider={false} text={category}></SectionHeader>\r\n            <TextField\r\n                value={gameRoundInputs[index].text}\r\n                onChange={event => handleInputChange(event, index)}\r\n                variant=\"outlined\"\r\n                fullWidth\r\n                InputProps={{\r\n                    startAdornment: <InputAdornment position=\"start\">{currentLetter}:</InputAdornment>,\r\n                    spellCheck: false\r\n                }}\r\n            />\r\n        </div>\r\n    );\r\n\r\n    return (\r\n        <React.Fragment>\r\n            <GameRoundChip\r\n                currentLetter={currentLetter}\r\n                currentRound={currentRound}\r\n                numberOfRounds={gameConfig.numberOfRounds}\r\n            />\r\n            <form className=\"app-form\" noValidate autoComplete=\"off\">\r\n                {gameConfig.categories.map(createTextfieldElement)}\r\n                <IconButton\r\n                    type=\"button\"\r\n                    className=\"fixed-bottom-right-button\"\r\n                    color=\"secondary\"\r\n                    title=\"Abschicken\"\r\n                    aria-label=\"Abschicken\"\r\n                    onClick={() => props.sendRoundFinishedMessage()}\r\n                >\r\n                    <EmailIcon />\r\n                </IconButton>\r\n            </form>\r\n        </React.Fragment>\r\n    );\r\n}\r\n\r\nexport default PhaseFillOutTextfields;\r\n","import './JoinGameLink.css';\r\nimport { IconButton, InputAdornment, OutlinedInput, Snackbar } from '@material-ui/core';\r\nimport FileCopyIcon from '@material-ui/icons/FileCopy';\r\nimport React, { useState } from 'react';\r\nimport { copyToClipboard } from '../../utils/general.utils';\r\n\r\ninterface JoinGameLinkProps {\r\n    gameId: string;\r\n}\r\n\r\nexport const JoinGameLink: React.FunctionComponent<JoinGameLinkProps> = props => {\r\n    const [open, setOpen] = useState(false);\r\n    const handleClick = () => {\r\n        copyToClipboard(joinGameLink)\r\n        setOpen(true);\r\n    };\r\n    const handleClose = () => {\r\n        setOpen(false);\r\n    };\r\n\r\n    const url = window.location.href;\r\n    // Cut off \"/play\" from the end of the url and add route plus game id.\r\n    const joinGameLink = url.slice(0, url.length - 5) + '/joingame?id=' + props.gameId;\r\n\r\n    return (\r\n        <React.Fragment>\r\n            <p className=\"join-game-link-label\">Teile diesen Link mit Freunden:</p>\r\n            <OutlinedInput\r\n                name=\"idInput\"\r\n                value={joinGameLink}\r\n                className=\"app-form-input\"\r\n                disabled\r\n                fullWidth\r\n                endAdornment={\r\n                    <InputAdornment position=\"end\">\r\n                        <IconButton\r\n                            title=\"Link kopieren\"\r\n                            aria-label=\"Link kopieren\"\r\n                            onClick={handleClick}\r\n                        >\r\n                            <FileCopyIcon />\r\n                        </IconButton>\r\n                    </InputAdornment>\r\n                }\r\n            />\r\n            <Snackbar\r\n                anchorOrigin={{ vertical: 'bottom', horizontal: 'center' }}\r\n                open={open}\r\n                autoHideDuration={1500}\r\n                onClose={handleClose}\r\n                message=\"Der Link wurde in Zwischenablage kopiert.\"\r\n            />\r\n        </React.Fragment>\r\n    );\r\n}\r\n","import Chip from '@material-ui/core/Chip';\r\nimport { createStyles, makeStyles, Theme } from '@material-ui/core/styles';\r\nimport FaceIcon from '@material-ui/icons/Face';\r\nimport React from 'react';\r\nimport { PlayerInfo } from '../../models/player.interface';\r\nimport { getPlayersInAlphabeticalOrder } from '../../utils/game.utils';\r\n\r\nconst useStyles = makeStyles((theme: Theme) =>\r\n    createStyles({\r\n        root: {\r\n            display: 'flex',\r\n            flexWrap: 'wrap',\r\n            padding: theme.spacing(0.5),\r\n        },\r\n        chip: {\r\n            margin: theme.spacing(0.5),\r\n        },\r\n    }),\r\n);\r\n\r\ninterface PlayerListProps {\r\n    players: Map<string, PlayerInfo>;\r\n}\r\nconst PlayerList: React.FunctionComponent<PlayerListProps> = props => {\r\n    const classes = useStyles();\r\n    const sortedPlayers = getPlayersInAlphabeticalOrder(props.players);\r\n    return (\r\n        <div className={classes.root}>\r\n            {sortedPlayers.map((playerInfo, index) => (\r\n                <Chip\r\n                    key={`player-name-${index}`}\r\n                    icon={<FaceIcon />}\r\n                    color={playerInfo.isAdmin ? 'secondary' : 'primary'}\r\n                    label={playerInfo.isAdmin ? `${playerInfo.name} (Admin)` : playerInfo.name}\r\n                    className={classes.chip}\r\n                />\r\n            ))}\r\n        </div>\r\n    );\r\n}\r\n\r\nexport default PlayerList;\r\n","import './PhaseWaitingToStart.css';\r\nimport { Button, Divider } from '@material-ui/core';\r\nimport PlayCircleFilled from '@material-ui/icons/PlayCircleFilled';\r\nimport React from 'react';\r\nimport { MIN_NUMBER_OF_PLAYERS } from '../../constants/game.constant';\r\nimport { GameConfig } from '../../models/game.interface';\r\nimport { PlayerInfo } from '../../models/player.interface';\r\nimport { PubNubMessage, PubNubMessageType } from '../../models/pub-nub-data.model';\r\nimport { JoinGameLink } from '../JoinGameLink/JoinGameLink';\r\nimport PlayerList from '../PlayerList/PlayerList';\r\nimport ScoringOptionsList from '../ScoringOptionsList/ScoringOptionsList';\r\nimport { SectionHeader } from '../SectionHeader/SectionHeader';\r\n\r\ninterface PhaseWaitingToStartProps {\r\n    allPlayers: Map<string, PlayerInfo>;\r\n    gameConfig: GameConfig | null;\r\n    gameId: string;\r\n    playerInfo: PlayerInfo;\r\n    sendMessage: (message: PubNubMessage) => void;\r\n}\r\n\r\nconst PhaseWaitingToStart: React.FunctionComponent<PhaseWaitingToStartProps> = props => {\r\n    const { allPlayers, gameId, playerInfo } = props;\r\n    const gameConfig = props.gameConfig as GameConfig;\r\n    const waitForGameStartElement = (\r\n        <p className=\"wait-for-start-animation\">Warte auf Spielbeginn <span>.</span><span>.</span><span>.</span></p>\r\n    );\r\n    const createGameSettingsElement = (): JSX.Element => (\r\n        <React.Fragment>\r\n            <Divider />\r\n            <h3>Spiel-bersicht:</h3>\r\n            <p>ID: {props.gameId}</p>\r\n            <p>Runden: {gameConfig.numberOfRounds}</p>\r\n            <p>Kategorien: {gameConfig.categories.join(', ')}</p>\r\n            <ScoringOptionsList rules={gameConfig.scoringOptions} />\r\n        </React.Fragment>\r\n    );\r\n    const createStartGameButton = (): JSX.Element => (\r\n        <div className=\"button-wrapper add-margin-top\">\r\n            <Button\r\n                color=\"primary\"\r\n                variant=\"contained\"\r\n                size=\"large\"\r\n                startIcon={<PlayCircleFilled />}\r\n                disabled={allPlayers.size < MIN_NUMBER_OF_PLAYERS}\r\n                onClick={() => props.sendMessage({ type: PubNubMessageType.startGame })}\r\n            >Starten</Button>\r\n        </div>\r\n    );\r\n    const createInvitePlayersElement = (): JSX.Element => (\r\n        <div className=\"material-card-style\">\r\n            <JoinGameLink gameId={gameId as string} />\r\n        </div>\r\n    );\r\n\r\n    return (\r\n        <React.Fragment>\r\n            <div className=\"material-card-style\">\r\n                <SectionHeader showDivider={true} text=\"Gleich geht's los...\"></SectionHeader>\r\n                <div className=\"players-wrapper\">\r\n                    <h3>Mitspieler ({props.allPlayers.size}):</h3>\r\n                    <PlayerList players={props.allPlayers} />\r\n                </div>\r\n                {props.gameConfig ? createGameSettingsElement() : null}\r\n                <Divider />\r\n                {playerInfo.isAdmin ? createStartGameButton() : waitForGameStartElement}\r\n            </div>\r\n            {playerInfo.isAdmin ? createInvitePlayersElement() : null}\r\n        </React.Fragment>\r\n    );\r\n}\r\n\r\nexport default PhaseWaitingToStart;\r\n","import Pubnub from 'pubnub';\r\nimport { usePubNub } from 'pubnub-react';\r\nimport React, { useEffect } from 'react';\r\nimport { GameConfig } from '../../models/game.interface';\r\nimport { PlayerInfo } from '../../models/player.interface';\r\nimport { PubNubUserState } from '../../models/pub-nub-data.model';\r\n\r\ninterface PubNubEventHandlerProps {\r\n    gameChannel: string;\r\n    gameConfig: GameConfig | null;\r\n    isRejoiningGame: boolean;\r\n    playerInfo: PlayerInfo;\r\n    navigateToDashboard: () => void;\r\n    addPlayers: (...newPlayers: PubNubUserState[]) => void;\r\n    processPubNubMessage: (event: Pubnub.MessageEvent) => void;\r\n}\r\n\r\nconst PubNubEventHandler: React.FunctionComponent<PubNubEventHandlerProps> = props => {\r\n    const pubNubClient = usePubNub();\r\n\r\n    const setUserStateAndGetHereNowIfGameIsOpen = () => {\r\n        pubNubClient.history(\r\n            { channel: props.gameChannel, count: 10 },\r\n            (_, response) => {\r\n                // If a new user wants to join the game but the channel's history already includes messages, then the game\r\n                // has already started and user can't join. They get rerouted to the dashboard page by PlayGame component.\r\n                if (!props.isRejoiningGame && response.messages.length > 0) {\r\n                    props.navigateToDashboard();\r\n                    return;\r\n                }\r\n                // Only if player is joining game for the first time, set user state and retrieve hereNowData.\r\n                if (!props.isRejoiningGame) {\r\n                    setUserState();\r\n                    getHereNowData();\r\n                    // Safeguard against the possibility of two players joining exactly at the same time:\r\n                    // We call hereNowData again after 3 seconds, to make sure we get all player info.\r\n                    setTimeout(getHereNowData, 3000);\r\n                }\r\n            }\r\n        );\r\n    };\r\n    const setUserState = () => {\r\n        let newUserState: PubNubUserState;\r\n        if (props.playerInfo.isAdmin) {\r\n            newUserState = { gameConfig: props.gameConfig as GameConfig, playerInfo: props.playerInfo };\r\n        } else {\r\n            newUserState = { playerInfo: props.playerInfo };\r\n        }\r\n        // Set this user's state in game channel.\r\n        pubNubClient.setState({\r\n            channels: [props.gameChannel],\r\n            state: newUserState\r\n        });\r\n    };\r\n    const getHereNowData = () => {\r\n        pubNubClient.hereNow(\r\n            { channels: [props.gameChannel], includeUUIDs: true, includeState: true },\r\n            (_, response) => {\r\n                console.log('PubNub hereNow', response);\r\n                // If player tries to rejoin but they are the only player left in game channel, then the game \r\n                // is already over and the user gets rerouted to dashboard page by PlayGame component.\r\n                if (props.isRejoiningGame && response.totalOccupancy <= 1) {\r\n                    props.navigateToDashboard();\r\n                    return;\r\n                }\r\n                // Response includes states of players that joined before.\r\n                const dataForGameChannel = response.channels[props.gameChannel];\r\n                if (dataForGameChannel) {\r\n                    const pubNubUserStates: PubNubUserState[] = [];\r\n                    dataForGameChannel.occupants.forEach(occupant => {\r\n                        const userState = occupant.state as PubNubUserState;\r\n                        // Safeguard in case that a user's state should be missing or corrupted.\r\n                        if (!!userState && !!userState.playerInfo) {\r\n                            pubNubUserStates.push(userState);\r\n                        }\r\n                    });\r\n                    props.addPlayers(...pubNubUserStates);\r\n                }\r\n            }\r\n        );\r\n    };\r\n\r\n    useEffect(() => {\r\n        const pubNubListeners: Pubnub.ListenerParameters = {\r\n            message: messageEvent => {\r\n                console.log('PubNub message event', messageEvent);\r\n                // Make sure that message is controlled game message with 'type' attribute.\r\n                if (messageEvent.message.type) {\r\n                    props.processPubNubMessage(messageEvent);\r\n                }\r\n            },\r\n            presence: presenceEvent => {\r\n                console.log('PubNub presence event', presenceEvent);\r\n                // Check for 'state-change' events and process state from new player.\r\n                if (presenceEvent.action === 'state-change') {\r\n                    const userState = presenceEvent.state as PubNubUserState;\r\n                    if (userState.playerInfo.id !== props.playerInfo.id) {\r\n                        props.addPlayers(userState);\r\n                    }\r\n                }\r\n            },\r\n            status: statusEvent => {\r\n                console.log('PubNub status event', statusEvent);\r\n                if (statusEvent.category === 'PNConnectedCategory') {\r\n                    console.log('Player is connected to PubNub game channel');\r\n                    setUserStateAndGetHereNowIfGameIsOpen();\r\n                }\r\n            }\r\n        };\r\n        pubNubClient.addListener(pubNubListeners);\r\n        pubNubClient.subscribe({\r\n            channels: [props.gameChannel],\r\n            withPresence: true\r\n        });\r\n        // When this component is destroyed, we unsubscribe from game channel.\r\n        return () => {\r\n            pubNubClient.removeListener(pubNubListeners);\r\n            pubNubClient.unsubscribeAll();\r\n        }\r\n    });\r\n    return null;\r\n};\r\n\r\nexport default React.memo(PubNubEventHandler);\r\n","import PubNub from 'pubnub';\r\n\r\nconst PUBNUB_KEYS = require('./pubnub.config.json');\r\n\r\nexport const PUBNUB_CONFIG: PubNub.PubnubConfig = {\r\n    publishKey: PUBNUB_KEYS.publishKey,\r\n    subscribeKey: PUBNUB_KEYS.subscribeKey,\r\n    uuid: undefined, //  is set by PlayGame component,\r\n    ssl: true\r\n};\r\n","import { cloneDeep } from 'lodash';\r\nimport {\r\n    GameConfigScoringOptions,\r\n    GameRound,\r\n    GameRoundEvaluation,\r\n    PlayerInput,\r\n    PlayerInputEvaluation,\r\n} from '../models/game.interface';\r\nimport { PlayerInfo } from '../models/player.interface';\r\nimport { calculatePointsForRound, getNumberOfInvalids } from './game.utils';\r\nimport { getRunningGameRoundFromLocalStorage } from './local-storage.utils';\r\n\r\nexport const shouldUserRespondToRequestGameDataMessage = (user: PlayerInfo, allPlayers: Map<string, PlayerInfo>, requestingPlayerId: string): boolean => {\r\n    // User should not respond to their own message.\r\n    if (user.id === requestingPlayerId) { return false; }\r\n    // If user is admin, then they should respond to the message.\r\n    if (user.isAdmin) { return true; }\r\n    // If the requesting user is the admin, then an algorithm determines who of\r\n    // the remaining players is the one to respond to the admin's message.\r\n    const requestingPlayerInfo = allPlayers.get(requestingPlayerId);\r\n    if (requestingPlayerInfo && requestingPlayerInfo.isAdmin) {\r\n        const playersWithoutRequestingPlayer = cloneDeep(allPlayers);\r\n        playersWithoutRequestingPlayer.delete(requestingPlayerId);\r\n        const playersSortedById = Array.from(playersWithoutRequestingPlayer).map(data => data[1]).sort((a, b) => {\r\n            if (a.id < b.id) { return -1; }\r\n            if (a.id > b.id) { return 1; }\r\n            return 0;\r\n        });\r\n        return playersSortedById[0].id === user.id;\r\n    }\r\n    return false;\r\n};\r\n\r\n/**\r\n * Transforms the GameRoundEvaluation object from a nested Map into a nested array.\r\n * The order of the players in sortedPlayers defines the order of the information in the arrays.\r\n */\r\nexport const compressGameRoundEvaluation = (gameRoundEvaluation: GameRoundEvaluation, sortedPlayers: PlayerInfo[]): boolean[][][] => {\r\n    const evaluationsAsArrays = new Map<string, boolean[][]>();\r\n    gameRoundEvaluation.forEach((data, playerId) => {\r\n        evaluationsAsArrays.set(playerId, data.map(item => {\r\n            const booleanArray: boolean[] = [];\r\n            sortedPlayers.forEach(player => booleanArray.push(item.get(player.id) as boolean));\r\n            return booleanArray;\r\n        }));\r\n    });\r\n    const compressedGameRoundEvaluation: boolean[][][] = [];\r\n    sortedPlayers.forEach(player => compressedGameRoundEvaluation.push(evaluationsAsArrays.get(player.id) as boolean[][]));\r\n    return compressedGameRoundEvaluation;\r\n};\r\n\r\n/**\r\n * Transforms the GameRoundEvaluation object from a nested array into a nested Map.\r\n * The order of the players in sortedPlayers defines the order of the information in the arrays.\r\n */\r\nexport const decompressGameRoundEvaluation = (compressedData: boolean[][][], sortedPlayers: PlayerInfo[]): GameRoundEvaluation => {\r\n    const gameRoundEvaluation: GameRoundEvaluation = new Map<string, PlayerInputEvaluation[]>();\r\n    sortedPlayers.forEach((evaluatedPlayer, evaluatedPlayerIndex) => {\r\n        const evaluations: PlayerInputEvaluation[] = compressedData[evaluatedPlayerIndex].map(playerData => {\r\n            const playerInputEvaluation = new Map<string, boolean>();\r\n            sortedPlayers.forEach((evaluatingPlayer, evaluatingPlayerIndex) => playerInputEvaluation.set(evaluatingPlayer.id, playerData[evaluatingPlayerIndex]));\r\n            return playerInputEvaluation;\r\n        });\r\n        gameRoundEvaluation.set(evaluatedPlayer.id, evaluations);\r\n    });\r\n    return gameRoundEvaluation;\r\n};\r\n\r\n/**\r\n * Transforms the GameRoundEvaluation object from a nested Map into a nested array.\r\n * The order of the players in sortedPlayers defines the order of the information in the arrays.\r\n */\r\nexport const compressMarkedAsCreativeFlags = (round: GameRound, sortedPlayers: PlayerInfo[]): boolean[][] => {\r\n    const markedAsCreativeArrays: boolean[][] = [];\r\n    sortedPlayers.forEach(player => {\r\n        const playerInputs = round.get(player.id) as PlayerInput[];\r\n        markedAsCreativeArrays.push(playerInputs.map(input => input.star));\r\n    });\r\n    return markedAsCreativeArrays;\r\n};\r\n\r\nexport const restoreGameRoundsOfRunningGameFromLocalStorage = (numberOfRoundsToRestore: number): GameRound[] => {\r\n    const gameRounds: GameRound[] = [];\r\n    for (let round = 1; round <= numberOfRoundsToRestore; round++) {\r\n        const data = getRunningGameRoundFromLocalStorage(round);\r\n        if (data) {\r\n            gameRounds.push(data);\r\n        }\r\n    }\r\n    return gameRounds;\r\n};\r\n\r\n/**\r\n * Sets points and validity of player inputs for a player who is rejoining the game in evaluation phase.\r\n */\r\nexport const setPointsAndValidity = (\r\n    scoringOptions: GameConfigScoringOptions, gameRoundEvaluation: GameRoundEvaluation, minNumberOfInvalids: number, round: GameRound\r\n) => {\r\n    // First evaluate validity\r\n    round.forEach((playerInputs, playerId) => {\r\n        const evaluations = gameRoundEvaluation.get(playerId) as PlayerInputEvaluation[];\r\n        playerInputs.forEach((input, categoryIndex) => {\r\n            // Only evaluate validity for originally valid inputs (not empty text inputs).\r\n            if (input.valid) {\r\n                input.valid = getNumberOfInvalids(evaluations[categoryIndex]) < minNumberOfInvalids;\r\n            }\r\n        });\r\n    });\r\n    // Second calculate points\r\n    calculatePointsForRound(scoringOptions, round);\r\n};\r\n\r\n/**\r\n * Applies the \"marked as very creative\" flags to the player inputs for a player who is rejoining the game in evaluation phase.\r\n */\r\nexport const applyMarkedAsCreativeFlags = (compressedData: boolean[][], sortedPlayers: PlayerInfo[], round: GameRound) => {\r\n    sortedPlayers.forEach((player, playerIndex) => {\r\n        const markedAsCreativeAnswer = compressedData[playerIndex];\r\n        (round.get(player.id) as PlayerInput[]).forEach((input, categoryIndex) => input.star = markedAsCreativeAnswer[categoryIndex]);\r\n    });\r\n};\r\n","import { cloneDeep } from 'lodash';\r\nimport Pubnub from 'pubnub';\r\nimport { PubNubProvider } from 'pubnub-react';\r\nimport React, { Component, Dispatch } from 'react';\r\nimport { connect } from 'react-redux';\r\nimport { RouterProps } from 'react-router';\r\nimport AdminPanel from '../../components/AdminPanel/AdminPanel';\r\nimport { LetterAnimation } from '../../components/LetterAnimation/LetterAnimation';\r\nimport LoadingScreen from '../../components/LoadingScreen/LoadingScreen';\r\nimport PhaseEvaluateRound from '../../components/PhaseEvaluateRound/PhaseEvaluateRound';\r\nimport PhaseFillOutTextfields from '../../components/PhaseFillOutTextfields/PhaseFillOutTextfields';\r\nimport PhaseWaitingToStart from '../../components/PhaseWaitingToStart/PhaseWaitingToStart';\r\nimport PubNubEventHandler from '../../components/PubNubEventHandler/PubNubEventHandler';\r\nimport { PUBNUB_CONFIG } from '../../config/pubnub.config';\r\nimport { GamePhase } from '../../constants/game.constant';\r\nimport {\r\n    EvaluationOfPlayerInput,\r\n    GameConfig,\r\n    GameRound,\r\n    GameRoundEvaluation,\r\n    IsPlayerInputVeryCreativeStatus,\r\n    PlayerInput,\r\n    PlayerInputEvaluation,\r\n} from '../../models/game.interface';\r\nimport { PlayerInfo } from '../../models/player.interface';\r\nimport {\r\n    PubNubCurrentRoundInputsMessage,\r\n    PubNubDataForCurrentGameMessage,\r\n    PubNubDataForCurrentGameMessagePayload,\r\n    PubNubEvaluationOfPlayerInputMessage,\r\n    PubNubIsPlayerInputVeryCreativeMessage,\r\n    PubNubKickPlayerMessage,\r\n    PubNubMessage,\r\n    PubNubMessageType,\r\n    PubNubUserState,\r\n} from '../../models/pub-nub-data.model';\r\nimport { AppAction, resetAppState, setDataOfFinishedGame, SetDataOfFinishedGamePayload } from '../../store/app.actions';\r\nimport { AppState } from '../../store/app.reducer';\r\nimport {\r\n    applyMarkedAsCreativeFlags,\r\n    compressGameRoundEvaluation,\r\n    compressMarkedAsCreativeFlags,\r\n    decompressGameRoundEvaluation,\r\n    restoreGameRoundsOfRunningGameFromLocalStorage,\r\n    setPointsAndValidity,\r\n    shouldUserRespondToRequestGameDataMessage,\r\n} from '../../utils/data-restoration.utils';\r\nimport {\r\n    applyValidFlagAndStarFlagToPoints,\r\n    calculatePointsForCategory,\r\n    calculatePointsForRound,\r\n    createGameRoundEvaluation,\r\n    getEmptyRoundInputs,\r\n    getMinNumberOfInvalids,\r\n    getNumberOfInvalids,\r\n    getPlayersInAlphabeticalOrder,\r\n    markEmptyPlayerInputsAsInvalid,\r\n} from '../../utils/game.utils';\r\nimport { convertCollectionToMap, convertMapToCollection } from '../../utils/general.utils';\r\nimport {\r\n    getRunningGameConfigFromLocalStorage,\r\n    removeAllDataOfRunningGameFromLocalStorage,\r\n    setRunningGameConfigInLocalStorage,\r\n    setRunningGameRoundInLocalStorage,\r\n} from '../../utils/local-storage.utils';\r\n\r\ninterface PlayGamePropsFromStore {\r\n    gameConfig: GameConfig | null;\r\n    gameId: string | null;\r\n    isRejoiningGame: boolean;\r\n    /** Player info for the user of this instance of the \"Stadt-Land-Fluss\" app. */\r\n    playerInfo: PlayerInfo;\r\n}\r\ninterface PlayGameDispatchProps {\r\n    onSetDataOfFinishedGame: (payload: SetDataOfFinishedGamePayload) => void;\r\n    onResetAppState: () => void;\r\n}\r\ninterface PlayGameProps extends PlayGamePropsFromStore, PlayGameDispatchProps, RouterProps { }\r\nexport interface PlayGameState {\r\n    allPlayers: Map<string, PlayerInfo>;\r\n    currentPhase: GamePhase;\r\n    currentRound: number;\r\n    currentRoundEvaluation: GameRoundEvaluation;\r\n    currentRoundInputs: PlayerInput[];\r\n    gameConfig: GameConfig | null;\r\n    gameRounds: GameRound[];\r\n    playersThatFinishedEvaluation: Map<string, boolean>;\r\n    showLetterAnimation: boolean;\r\n    showLoadingScreen: boolean;\r\n}\r\n\r\nclass PlayGame extends Component<PlayGameProps, PlayGameState> {\r\n    public state: PlayGameState = {\r\n        allPlayers: new Map<string, PlayerInfo>(),\r\n        currentPhase: GamePhase.waitingToStart,\r\n        currentRound: 1,\r\n        currentRoundEvaluation: new Map<string, PlayerInputEvaluation[]>(),\r\n        currentRoundInputs: [],\r\n        gameConfig: null,\r\n        gameRounds: [],\r\n        playersThatFinishedEvaluation: new Map<string, boolean>(),\r\n        showLetterAnimation: false,\r\n        showLoadingScreen: true\r\n    };\r\n    private pubNubClient: any;\r\n\r\n    public render() {\r\n        // This check serves as a route guard. If gameId and playerInfo aren't present in application state,\r\n        // then the user wasn't redirected here from the NewGame or JoinGame component.\r\n        if (this.props.gameId === null || this.props.playerInfo === null) { return null; }\r\n\r\n        const { gameId, playerInfo } = this.props;\r\n        const { showLetterAnimation, showLoadingScreen } = this.state;\r\n        if (!this.pubNubClient) {\r\n            this.pubNubClient = new Pubnub({ ...PUBNUB_CONFIG, uuid: playerInfo.id });\r\n        }\r\n\r\n        let currentPhaseElement: JSX.Element | null = null;\r\n        switch (this.state.currentPhase) {\r\n            case GamePhase.waitingToStart:\r\n                currentPhaseElement = (\r\n                    <PhaseWaitingToStart\r\n                        allPlayers={this.state.allPlayers}\r\n                        gameConfig={this.state.gameConfig}\r\n                        gameId={gameId}\r\n                        playerInfo={playerInfo}\r\n                        sendMessage={this.sendMessage}\r\n                    />\r\n                );\r\n                break;\r\n            case GamePhase.fillOutTextfields:\r\n                currentPhaseElement = (\r\n                    <PhaseFillOutTextfields\r\n                        currentRound={this.state.currentRound}\r\n                        gameConfig={this.state.gameConfig as GameConfig}\r\n                        gameRoundInputs={this.state.currentRoundInputs}\r\n                        updateCurrentRoundInputs={this.updateCurrentRoundInputs}\r\n                        sendRoundFinishedMessage={this.sendRoundFinishedMessage}\r\n                    />\r\n                );\r\n                break;\r\n            case GamePhase.evaluateRound:\r\n                currentPhaseElement = (\r\n                    <PhaseEvaluateRound\r\n                        allPlayers={this.state.allPlayers}\r\n                        currentRound={this.state.currentRound}\r\n                        currentRoundEvaluation={this.state.currentRoundEvaluation}\r\n                        gameConfig={this.state.gameConfig as GameConfig}\r\n                        gameRounds={this.state.gameRounds}\r\n                        playerInfo={playerInfo}\r\n                        playersThatFinishedEvaluation={this.state.playersThatFinishedEvaluation}\r\n                        sendEvaluationFinishedMessage={this.sendEvaluationFinishedMessage}\r\n                        updateEvaluationOfPlayerInput={this.updateEvaluationOfPlayerInput}\r\n                        updateIsPlayerInputVeryCreativeStatus={this.updateIsPlayerInputVeryCreativeStatus}\r\n                    />\r\n                );\r\n                break;\r\n            default:\r\n        }\r\n        const letterAnimationElement = (\r\n            <LetterAnimation\r\n                letterToUnveil={this.state.gameConfig ? this.state.gameConfig.letters[this.state.currentRound - 1] : ''}\r\n                callbackWhenAnimationDone={this.callbackWhenAnimationDone}\r\n            />\r\n        );\r\n        const adminPanel = <AdminPanel allPlayers={this.state.allPlayers} kickPlayer={this.sendKickPlayerMessage} />;\r\n\r\n        return (\r\n            <PubNubProvider client={this.pubNubClient}>\r\n                {/* The props passed to PubNubEventHandler must never be changed,\r\n                    in order to ensure that the component is not rerendered!\r\n                    (PubNubEventHandler is wrapped in React.memo) */}\r\n                <PubNubEventHandler\r\n                    gameChannel={this.props.gameId}\r\n                    gameConfig={this.props.gameConfig}\r\n                    isRejoiningGame={this.props.isRejoiningGame}\r\n                    playerInfo={this.props.playerInfo}\r\n                    navigateToDashboard={this.navigateToDashboard}\r\n                    addPlayers={this.addPlayers}\r\n                    processPubNubMessage={this.processPubNubMessage}\r\n                />\r\n                {showLetterAnimation ? letterAnimationElement : null}\r\n                {showLoadingScreen ? <LoadingScreen /> : null}\r\n                {!showLoadingScreen && !showLetterAnimation ? (\r\n                    <div className=\"main-content-wrapper\">\r\n                        {currentPhaseElement}\r\n                    </div>\r\n                ) : null}\r\n                {playerInfo.isAdmin && this.state.allPlayers.size > 1 ? adminPanel : null}\r\n            </PubNubProvider>\r\n        );\r\n    }\r\n\r\n    public componentDidMount() {\r\n        const { gameConfig, gameId, isRejoiningGame, playerInfo } = this.props;\r\n        // If gameId and playerInfo aren't present in application state, then reroute user to dashboard.\r\n        if (gameId === null || playerInfo === null) {\r\n            this.props.history.push('/');\r\n            return;\r\n        }\r\n        // If player is rejoining the game, we need to request the game data from the other players.\r\n        if (isRejoiningGame) {\r\n            this.sendMessage({ type: PubNubMessageType.requestGameData });\r\n        } else {\r\n            const allPlayers = new Map<string, PlayerInfo>();\r\n            allPlayers.set(playerInfo.id, playerInfo);\r\n            // If user is the game admin, the gameConfig can be taken from application state\r\n            // and we can hide the loading screen and show PhaseWaitingToStart component right away.\r\n            if (playerInfo.isAdmin) {\r\n                setRunningGameConfigInLocalStorage(gameConfig as GameConfig);\r\n                this.setState({ allPlayers, gameConfig, showLoadingScreen: false });\r\n            } else {\r\n                this.setState({ allPlayers });\r\n            }\r\n        }\r\n    }\r\n\r\n    private sendMessage = (message: PubNubMessage) => {\r\n        this.pubNubClient.publish(\r\n            {\r\n                channel: this.props.gameId as string,\r\n                message,\r\n                storeInHistory: true,\r\n                ttl: 1 // time to live (in hours)\r\n            },\r\n            (status: any, response: any) => console.log('PubNub Publish:', status, response)\r\n        );\r\n    };\r\n\r\n    private callbackWhenAnimationDone = () => {\r\n        this.setState({ showLetterAnimation: false });\r\n    }\r\n\r\n    private navigateToDashboard = () => {\r\n        removeAllDataOfRunningGameFromLocalStorage();\r\n        this.props.onResetAppState();\r\n        this.props.history.push('/');\r\n    }\r\n\r\n    /**\r\n     * Called by PubNubEventHandler when it receives a PubNub presence event with action 'state-change'.\r\n     * It processes information about players that had already joined the game before this user joined\r\n     * (hereNow result) or about a player that joins the game after this user joined.\r\n     */\r\n    private addPlayers = (...newPlayers: PubNubUserState[]) => {\r\n        // Ignore information about players that try to join after the game has already started.\r\n        if (this.state.currentPhase !== GamePhase.waitingToStart) { return; }\r\n        let gameConfig: GameConfig | null = null;\r\n        const allPlayers = cloneDeep(this.state.allPlayers);\r\n        newPlayers.forEach(newPlayer => {\r\n            allPlayers.set(newPlayer.playerInfo.id, newPlayer.playerInfo);\r\n            // If we are not the game admin, we obtain the game config from the admin's PubNubUserState.\r\n            if (newPlayer.gameConfig && !this.state.gameConfig) {\r\n                gameConfig = newPlayer.gameConfig;\r\n            }\r\n        });\r\n        // Only after we received the gameConfig from the admin, we hide the loading screen\r\n        // and render the PhaseWaitingToStart component instead.\r\n        if (gameConfig) {\r\n            setRunningGameConfigInLocalStorage(gameConfig);\r\n            this.setState({ allPlayers, gameConfig, showLoadingScreen: false });\r\n        } else {\r\n            this.setState({ allPlayers });\r\n        }\r\n    }\r\n\r\n    /**\r\n     * PubNubEventHandler calls this method when it receives a PubNub message with attribute 'type'.\r\n     */\r\n    private processPubNubMessage = (event: Pubnub.MessageEvent) => {\r\n        const message = event.message as PubNubMessage;\r\n        switch (message.type) {\r\n            case PubNubMessageType.startGame:\r\n                this.startGame();\r\n                break;\r\n            case PubNubMessageType.roundFinished:\r\n                this.stopRoundAndSendInputs();\r\n                break;\r\n            case PubNubMessageType.currentRoundInputs:\r\n                this.addPlayerInputForFinishedRound(event.publisher, message.payload);\r\n                break;\r\n            case PubNubMessageType.evaluationOfPlayerInput:\r\n                this.processEvaluationOfPlayerInput(event.publisher, message.payload);\r\n                break;\r\n            case PubNubMessageType.isPlayerInputVeryCreative:\r\n                this.processIsPlayerInputVeryCreativeStatus(message.payload);\r\n                break;\r\n            case PubNubMessageType.evaluationFinished:\r\n                this.countPlayerAsEvaluationFinished(event.publisher);\r\n                break;\r\n            case PubNubMessageType.kickPlayer:\r\n                this.removePlayerFromGame(message.payload)\r\n                break;\r\n            case PubNubMessageType.requestGameData:\r\n                if (shouldUserRespondToRequestGameDataMessage(this.props.playerInfo, this.state.allPlayers, event.publisher)) {\r\n                    if (this.state.allPlayers.has(event.publisher)) {\r\n                        // Only send data to a rejoining player who hasn't been kicked out by the admin.\r\n                        this.sendDataForCurrentGame(event.publisher);\r\n                    } else {\r\n                        // Send kickPlayer message again for kicked out player that tried to rejoin game.\r\n                        this.sendKickPlayerMessage(event.publisher);\r\n                    }\r\n                }\r\n                break;\r\n            case PubNubMessageType.dataForCurrentGame:\r\n                this.restoreDataForCurrentGame(message.payload);\r\n                break;\r\n            default:\r\n        }\r\n    }\r\n\r\n    /**\r\n    * This method is called when the PubNub message 'startGame' is received.\r\n    */\r\n    private startGame = () => {\r\n        const gameConfig = this.state.gameConfig as GameConfig;\r\n        const currentRoundEvaluation = createGameRoundEvaluation(this.state.allPlayers, gameConfig.categories);\r\n        this.setState({\r\n            currentPhase: GamePhase.fillOutTextfields,\r\n            currentRoundEvaluation,\r\n            currentRoundInputs: getEmptyRoundInputs(gameConfig.categories.length),\r\n            showLetterAnimation: true\r\n        });\r\n    }\r\n\r\n    private updateCurrentRoundInputs = (newCurrentRoundInputs: PlayerInput[]) => {\r\n        this.setState({ currentRoundInputs: newCurrentRoundInputs });\r\n    }\r\n\r\n    private sendRoundFinishedMessage = () => {\r\n        this.setState({ showLoadingScreen: true });\r\n        this.sendMessage({ type: PubNubMessageType.roundFinished });\r\n    }\r\n\r\n    /**\r\n     * This method is called when the PubNub message 'roundFinished' is received.\r\n     */\r\n    private stopRoundAndSendInputs = () => {\r\n        // Prepare new GameRound object for addPlayerInputForFinishedRound method\r\n        // as well as new currentRoundEvaluation object for evaluation phase.\r\n        const gameRounds: GameRound[] = [...this.state.gameRounds, new Map<string, PlayerInput[]>()];\r\n        this.setState({ gameRounds, showLoadingScreen: true });\r\n        // Send this player's text inputs of current round to other players (and herself/himself).\r\n        const message = new PubNubCurrentRoundInputsMessage(markEmptyPlayerInputsAsInvalid(this.state.currentRoundInputs));\r\n        this.sendMessage(message.toPubNubMessage());\r\n    }\r\n\r\n    /**\r\n     * This method is called when the PubNub message 'currentRoundInputs' is received.\r\n     */\r\n    private addPlayerInputForFinishedRound = (playerId: string, playerInputsForFinishedRound: PlayerInput[]) => {\r\n        const gameRounds = cloneDeep(this.state.gameRounds);\r\n        const roundIndex = this.state.currentRound - 1;\r\n        gameRounds[roundIndex].set(playerId, playerInputsForFinishedRound);\r\n        // Did we collect the inputs from all players?\r\n        if (gameRounds[roundIndex].size === this.state.allPlayers.size) {\r\n            // If yes, then calculate points and start the evaluation of the finished round.\r\n            calculatePointsForRound((this.state.gameConfig as GameConfig).scoringOptions, gameRounds[roundIndex]);\r\n            setRunningGameRoundInLocalStorage(this.state.currentRound, gameRounds[roundIndex]);\r\n            this.setState({ currentPhase: GamePhase.evaluateRound, gameRounds, showLoadingScreen: false });\r\n        } else {\r\n            // If no, then only store the updated gameRounds object in state.\r\n            this.setState({ gameRounds });\r\n        }\r\n    }\r\n\r\n    /**\r\n     * Is called by PhaseEvaluateRound component in order to communicate a player input evaluation via a\r\n     * PubNub message. This message is then processed by all players in the game (including the user who sent it).\r\n     */\r\n    private updateEvaluationOfPlayerInput = (newEvaluation: EvaluationOfPlayerInput) => {\r\n        const message = new PubNubEvaluationOfPlayerInputMessage(newEvaluation);\r\n        this.sendMessage(message.toPubNubMessage());\r\n    }\r\n\r\n    /**\r\n     * This method is called when the PubNub message 'evaluationOfPlayerInput' is received.\r\n     * It processes the new evaluation and changes data in currentRoundEvaluation and gameRounds accordingly.\r\n     */\r\n    private processEvaluationOfPlayerInput = (evaluatingPlayerId: string, newEvaluation: EvaluationOfPlayerInput) => {\r\n        if (!this.state.allPlayers.has(evaluatingPlayerId)) { return; }\r\n        const { categoryIndex, evaluatedPlayerId, markedAsValid } = newEvaluation;\r\n        const currentRoundEvaluation = cloneDeep(this.state.currentRoundEvaluation);\r\n        const playerInputEvaluations = currentRoundEvaluation.get(evaluatedPlayerId) as PlayerInputEvaluation[];\r\n        playerInputEvaluations[categoryIndex].set(evaluatingPlayerId, markedAsValid);\r\n        const gameRounds = cloneDeep(this.state.gameRounds);\r\n        const isInputValid = getNumberOfInvalids(playerInputEvaluations[categoryIndex]) < getMinNumberOfInvalids(this.state.allPlayers.size);\r\n        const finishedRound = gameRounds[this.state.currentRound - 1];\r\n        (finishedRound.get(evaluatedPlayerId) as PlayerInput[])[categoryIndex].valid = isInputValid;\r\n        calculatePointsForCategory((this.state.gameConfig as GameConfig).scoringOptions, finishedRound, categoryIndex);\r\n        this.setState({ currentRoundEvaluation, gameRounds });\r\n    }\r\n\r\n    /**\r\n     * Is called by PhaseEvaluateRound component in order to communicate the \"marked as very creative\" status of a player input\r\n     * via a PubNub message. This message is then processed by all players in the game (including the user who sent it).\r\n     */\r\n    private updateIsPlayerInputVeryCreativeStatus = (newStatus: IsPlayerInputVeryCreativeStatus) => {\r\n        const message = new PubNubIsPlayerInputVeryCreativeMessage(newStatus);\r\n        this.sendMessage(message.toPubNubMessage());\r\n    }\r\n    \r\n    /**\r\n     * This method is called when the PubNub message 'isPlayerInputVeryCreative' is received.\r\n     * It processes the new status and changes data in gameRounds accordingly.\r\n     */\r\n    private processIsPlayerInputVeryCreativeStatus = (newStatus: IsPlayerInputVeryCreativeStatus) => {\r\n        const { categoryIndex, evaluatedPlayerId, markedAsCreative } = newStatus;\r\n        const gameRounds = cloneDeep(this.state.gameRounds);\r\n        const finishedRound = gameRounds[this.state.currentRound - 1];\r\n        (finishedRound.get(evaluatedPlayerId) as PlayerInput[])[categoryIndex].star = markedAsCreative;\r\n        this.setState({ gameRounds });\r\n    }\r\n\r\n    /**\r\n     * Is called by PhaseEvaluateRound component in order to communicate to all players\r\n     * that the user of this instance of the game has finished evaluating the current round.\r\n     */\r\n    private sendEvaluationFinishedMessage = () => this.sendMessage({ type: PubNubMessageType.evaluationFinished });\r\n\r\n    /**\r\n     * This method is called when the PubNub message 'evaluationFinished' is received.\r\n     */\r\n    private countPlayerAsEvaluationFinished = (evaluatingPlayerId: string) => {\r\n        const playersThatFinishedEvaluation = cloneDeep(this.state.playersThatFinishedEvaluation);\r\n        playersThatFinishedEvaluation.set(evaluatingPlayerId, true);\r\n        if (playersThatFinishedEvaluation.size === this.state.allPlayers.size) {\r\n            this.processEvaluationsAndStartNextRoundOrFinishGame();\r\n        } else {\r\n            this.setState({ playersThatFinishedEvaluation });\r\n        }\r\n    }\r\n\r\n    private processEvaluationsAndStartNextRoundOrFinishGame = () => {\r\n        const { allPlayers, currentRound } = this.state;\r\n        const gameConfig = this.state.gameConfig as GameConfig;\r\n        const gameRounds = cloneDeep(this.state.gameRounds);\r\n        applyValidFlagAndStarFlagToPoints(gameConfig.scoringOptions, gameRounds[currentRound - 1]);\r\n        if (currentRound === gameConfig.numberOfRounds) {\r\n            // Finish game and show results.\r\n            removeAllDataOfRunningGameFromLocalStorage();\r\n            this.props.onSetDataOfFinishedGame({ allPlayers, gameConfig, gameRounds });\r\n            this.props.history.push('/results');\r\n        } else {\r\n            // Save finished game round in local storage and start next round of the game.\r\n            setRunningGameRoundInLocalStorage(this.state.currentRound, gameRounds[currentRound - 1]);\r\n            this.setState({\r\n                currentPhase: GamePhase.fillOutTextfields,\r\n                currentRoundEvaluation: createGameRoundEvaluation(allPlayers, gameConfig.categories),\r\n                currentRoundInputs: getEmptyRoundInputs(gameConfig.categories.length),\r\n                currentRound: currentRound + 1,\r\n                gameRounds,\r\n                playersThatFinishedEvaluation: new Map<string, boolean>(),\r\n                showLetterAnimation: true\r\n            });\r\n        }\r\n    }\r\n\r\n    private sendKickPlayerMessage = (playerId: string) => {\r\n        const message = new PubNubKickPlayerMessage(playerId);\r\n        this.sendMessage(message.toPubNubMessage());\r\n    }\r\n\r\n    /**\r\n     * This method is called when the PubNub message 'kickPlayer' is received.\r\n     */\r\n    private removePlayerFromGame = (playerId: string) => {\r\n        // If the player to be removed is the user of this game instance, then navigate to dashboard.\r\n        if (this.props.playerInfo.id === playerId) {\r\n            removeAllDataOfRunningGameFromLocalStorage();\r\n            this.props.onResetAppState();\r\n            this.props.history.push('/');\r\n            return;\r\n        }\r\n        if (this.state.allPlayers.has(playerId)) {\r\n            // Remove player's data from component's state.\r\n            const allPlayers = cloneDeep(this.state.allPlayers);\r\n            allPlayers.delete(playerId);\r\n            const currentRoundEvaluation = cloneDeep(this.state.currentRoundEvaluation);\r\n            currentRoundEvaluation.delete(playerId);\r\n            const gameRounds = cloneDeep(this.state.gameRounds);\r\n            gameRounds.forEach(round => round.delete(playerId));\r\n            const playersThatFinishedEvaluation = cloneDeep(this.state.playersThatFinishedEvaluation);\r\n            playersThatFinishedEvaluation.delete(playerId);\r\n            this.setState({ allPlayers, currentRoundEvaluation, gameRounds, playersThatFinishedEvaluation });\r\n            // If we're currently in evaluation phase, check if remaining players have finished evaluation.\r\n            if (this.state.currentPhase === GamePhase.evaluateRound && playersThatFinishedEvaluation.size === allPlayers.size) {\r\n                this.processEvaluationsAndStartNextRoundOrFinishGame();\r\n            }\r\n        }\r\n    }\r\n\r\n    private sendDataForCurrentGame = (requestingPlayerId: string) => {\r\n        const { allPlayers, currentPhase, currentRound, currentRoundEvaluation, gameRounds } = this.state;\r\n        const sortedPlayers = getPlayersInAlphabeticalOrder(allPlayers);\r\n        const compressedGameRoundEvaluation = currentPhase === GamePhase.evaluateRound\r\n            ? compressGameRoundEvaluation(currentRoundEvaluation, sortedPlayers) : [];\r\n        const compressedMarkedAsCreativeFlags = currentPhase === GamePhase.evaluateRound\r\n            ? compressMarkedAsCreativeFlags(gameRounds[currentRound - 1], sortedPlayers) : [];\r\n        const message = new PubNubDataForCurrentGameMessage({\r\n            compressedGameRoundEvaluation,\r\n            compressedMarkedAsCreativeFlags,\r\n            currentPhase,\r\n            currentRound,\r\n            playersThatFinishedEvaluation: convertMapToCollection<boolean>(this.state.playersThatFinishedEvaluation),\r\n            requestingPlayerId,\r\n            sortedPlayers\r\n        });\r\n        this.sendMessage(message.toPubNubMessage());\r\n    }\r\n\r\n    /**\r\n     * This method is called when the PubNub message 'dataForCurrentGame' is received.\r\n     */\r\n    private restoreDataForCurrentGame = (payload: PubNubDataForCurrentGameMessagePayload) => {\r\n        // Only process the information and update state if the message was meant for this user.\r\n        if (this.props.playerInfo.id !== payload.requestingPlayerId) { return; }\r\n\r\n        const gameConfig = getRunningGameConfigFromLocalStorage();\r\n        // If we're in the evaluation phase, then we also need to restore the data for the current round.\r\n        // Otherwise we only need to restore the data of the finished rounds.\r\n        const numberOfRoundsToRestore = payload.currentPhase === GamePhase.evaluateRound ? payload.currentRound : payload.currentRound - 1;\r\n        const gameRounds = restoreGameRoundsOfRunningGameFromLocalStorage(numberOfRoundsToRestore);\r\n        if (gameConfig && gameRounds.length === numberOfRoundsToRestore) {\r\n            const allPlayers = new Map<string, PlayerInfo>();\r\n            payload.sortedPlayers.forEach(player => allPlayers.set(player.id, player));\r\n            let currentRoundEvaluation: GameRoundEvaluation;\r\n            // If we are in evaluation phase, then we received the current evaluations and the\r\n            // \"marked as very creative\" data, which we need to apply to the player inputs.\r\n            if (payload.currentPhase === GamePhase.evaluateRound) {\r\n                const round = gameRounds[payload.currentRound - 1];\r\n                currentRoundEvaluation = decompressGameRoundEvaluation(payload.compressedGameRoundEvaluation, payload.sortedPlayers);\r\n                setPointsAndValidity(gameConfig.scoringOptions, currentRoundEvaluation, getMinNumberOfInvalids(allPlayers.size), round);\r\n                applyMarkedAsCreativeFlags(payload.compressedMarkedAsCreativeFlags, payload.sortedPlayers, round);\r\n            } else {\r\n                currentRoundEvaluation = createGameRoundEvaluation(allPlayers, gameConfig.categories);\r\n            }\r\n            this.setState({\r\n                allPlayers,\r\n                currentPhase: payload.currentPhase,\r\n                currentRound: payload.currentRound,\r\n                currentRoundEvaluation,\r\n                currentRoundInputs: getEmptyRoundInputs(gameConfig.categories.length),\r\n                gameConfig,\r\n                gameRounds,\r\n                playersThatFinishedEvaluation: convertCollectionToMap<boolean>(payload.playersThatFinishedEvaluation),\r\n                showLoadingScreen: false\r\n            });\r\n        } else {\r\n            console.log('Error: Can\\'t restore game session because data is missing in local storage!');\r\n            this.navigateToDashboard();\r\n        }\r\n    }\r\n}\r\n\r\nconst mapStateToProps = (state: AppState): PlayGamePropsFromStore => {\r\n    return {\r\n        gameConfig: state.gameConfig,\r\n        gameId: state.gameId,\r\n        isRejoiningGame: state.isRejoiningGame,\r\n        playerInfo: state.playerInfo as PlayerInfo\r\n    };\r\n}\r\nconst mapDispatchToProps = (dispatch: Dispatch<AppAction>): PlayGameDispatchProps => {\r\n    return {\r\n        onSetDataOfFinishedGame: (payload: SetDataOfFinishedGamePayload) => dispatch(setDataOfFinishedGame(payload)),\r\n        onResetAppState: () => dispatch(resetAppState())\r\n    }\r\n};\r\nexport default connect(mapStateToProps, mapDispatchToProps)(PlayGame);\r\n","import './App.css';\r\nimport { ThemeProvider } from '@material-ui/core';\r\nimport React, { Component, Dispatch } from 'react';\r\nimport { connect } from 'react-redux';\r\nimport { HashRouter, Route, Switch } from 'react-router-dom';\r\nimport { v4 as uuidv4 } from 'uuid';\r\nimport Header from './components/Header/Header';\r\nimport {\r\n    MAX_GAME_ID_VALIDITY_DURATION_IN_SECONDS,\r\n    MAX_PLAYER_ID_VALIDITY_DURATION_IN_SECONDS as MAX_PLAYER_ID_VALIDITY_IN_SECONDS,\r\n} from './constants/app.constant';\r\nimport { AppTheme, AppThemes } from './constants/themes.constant';\r\nimport Dashboard from './containers/Dashboard/Dashboard';\r\nimport GameManual from './containers/GameManual/GameManual';\r\nimport GameResults from './containers/GameResults/GameResults';\r\nimport JoinGame from './containers/JoinGame/JoinGame';\r\nimport NewGame from './containers/NewGame/NewGame';\r\nimport PlayGame from './containers/PlayGame/PlayGame';\r\nimport { StoredRunningGameInfo } from './models/game.interface';\r\nimport { StoredPlayerInfo } from './models/player.interface';\r\nimport { AppAction, setStoredPlayerInfo, setStoredRunningGameInfo, setAppTheme } from './store/app.actions';\r\nimport { convertDateToUnixTimestamp } from './utils/general.utils';\r\nimport {\r\n    getAppThemeIdFromLocalStorage,\r\n    getPlayerInfoFromLocalStorage,\r\n    getRunningGameInfoFromLocalStorage,\r\n    removeAllDataOfRunningGameFromLocalStorage,\r\n    setAppThemeIdInLocalStorage,\r\n    setPlayerInfoInLocalStorage,\r\n} from './utils/local-storage.utils';\r\nimport { AppState } from './store/app.reducer';\r\n\r\nconst backspaceDisabler = require('backspace-disabler');\r\n\r\ninterface AppPropsFromStore {\r\n    activeTheme: AppTheme;\r\n}\r\ninterface AppDispatchProps {\r\n    onSetAppTheme: (payload: AppTheme) => void,\r\n    onSetStoredPlayerInfo: (payload: StoredPlayerInfo) => void,\r\n    onSetStoredRunningGameInfo: (payload: StoredRunningGameInfo) => void\r\n}\r\ninterface AppProps extends AppPropsFromStore, AppDispatchProps { }\r\nclass App extends Component<AppProps> {\r\n\r\n    public render() {\r\n        return (\r\n            <ThemeProvider theme={this.props.activeTheme.muiTheme}>\r\n                <div className=\"app-container\">\r\n                    <HashRouter basename={process.env.PUBLIC_URL}>\r\n                        <Header\r\n                            theme={this.props.activeTheme}\r\n                            switchTheme={this.switchThemeHandler}\r\n                        />\r\n                        <main\r\n                            className={'app-main ' + this.props.activeTheme.className}\r\n                            style={this.props.activeTheme.style}\r\n                        >\r\n                            <Switch>\r\n                                <Route path=\"/manual\" exact component={GameManual} />\r\n                                <Route path=\"/newgame\" exact component={NewGame} />\r\n                                <Route path=\"/joingame\" exact component={JoinGame} />\r\n                                <Route path=\"/play\" exact component={PlayGame} />\r\n                                <Route path=\"/results\" exact component={GameResults} />\r\n                                <Route path=\"/\" component={Dashboard} />\r\n                            </Switch>\r\n                        </main>\r\n                    </HashRouter>\r\n                </div>\r\n            </ThemeProvider>\r\n        );\r\n    }\r\n\r\n    public componentDidMount() {\r\n        // Prevent browser back on backspace (e.g. in Firefox).\r\n        backspaceDisabler.disable();\r\n        const appThemeId = getAppThemeIdFromLocalStorage();\r\n        if (appThemeId) {\r\n            const appTheme = AppThemes.find(theme => theme.id === appThemeId);\r\n            if (appTheme) {\r\n                this.props.onSetAppTheme(appTheme);\r\n            }\r\n        }\r\n        let storedPlayerInfo = getPlayerInfoFromLocalStorage();\r\n        const nowTimestamp = convertDateToUnixTimestamp(new Date());\r\n        // If no stored player info was found or player's id is past validity, create a new uuid and store in local storage.\r\n        if (!storedPlayerInfo || nowTimestamp - storedPlayerInfo.idCreationTimestamp > MAX_PLAYER_ID_VALIDITY_IN_SECONDS) {\r\n            storedPlayerInfo = { id: uuidv4(), idCreationTimestamp: nowTimestamp, name: storedPlayerInfo ? storedPlayerInfo.name : '' };\r\n            setPlayerInfoInLocalStorage(storedPlayerInfo);\r\n        }\r\n        this.props.onSetStoredPlayerInfo(storedPlayerInfo);\r\n        const runningGameInfo = getRunningGameInfoFromLocalStorage();\r\n        if (runningGameInfo) {\r\n            // A running game is only valid for the time specified in the max validity constant.\r\n            if (nowTimestamp - runningGameInfo.idCreationTimestamp <= MAX_GAME_ID_VALIDITY_DURATION_IN_SECONDS) {\r\n                this.props.onSetStoredRunningGameInfo(runningGameInfo);\r\n            } else {\r\n                removeAllDataOfRunningGameFromLocalStorage();\r\n            }\r\n        }\r\n    }\r\n\r\n    private switchThemeHandler = (newTheme: AppTheme) => {\r\n        this.props.onSetAppTheme(newTheme);\r\n        setAppThemeIdInLocalStorage(newTheme.id);\r\n    }\r\n}\r\n\r\nconst mapStateToProps = (state: AppState): AppPropsFromStore => {\r\n    return {\r\n        activeTheme: state.activeTheme\r\n    };\r\n}\r\nconst mapDispatchToProps = (dispatch: Dispatch<AppAction>): AppDispatchProps => {\r\n    return {\r\n        onSetAppTheme: (payload: AppTheme) => dispatch(setAppTheme(payload)),\r\n        onSetStoredPlayerInfo: (payload: StoredPlayerInfo) => dispatch(setStoredPlayerInfo(payload)),\r\n        onSetStoredRunningGameInfo: (payload: StoredRunningGameInfo) => dispatch(setStoredRunningGameInfo(payload))\r\n    }\r\n};\r\nexport default connect(mapStateToProps, mapDispatchToProps)(App);\r\n","/** 7 days in seconds */\r\nexport const MAX_PLAYER_ID_VALIDITY_DURATION_IN_SECONDS = 7 * 24 * 60 * 60;\r\n/** 1 hour in seconds */\r\nexport const MAX_GAME_ID_VALIDITY_DURATION_IN_SECONDS = 60 * 60;\r\n","// This optional code is used to register a service worker.\n// register() is not called by default.\n\n// This lets the app load faster on subsequent visits in production, and gives\n// it offline capabilities. However, it also means that developers (and users)\n// will only see deployed updates on subsequent visits to a page, after all the\n// existing tabs open on the page have been closed, since previously cached\n// resources are updated in the background.\n\n// To learn more about the benefits of this model and instructions on how to\n// opt-in, read https://bit.ly/CRA-PWA\n\nconst isLocalhost = Boolean(\n  window.location.hostname === 'localhost' ||\n    // [::1] is the IPv6 localhost address.\n    window.location.hostname === '[::1]' ||\n    // 127.0.0.0/8 are considered localhost for IPv4.\n    window.location.hostname.match(\n      /^127(?:\\.(?:25[0-5]|2[0-4][0-9]|[01]?[0-9][0-9]?)){3}$/\n    )\n);\n\ntype Config = {\n  onSuccess?: (registration: ServiceWorkerRegistration) => void;\n  onUpdate?: (registration: ServiceWorkerRegistration) => void;\n};\n\nexport function register(config?: Config) {\n  if (process.env.NODE_ENV === 'production' && 'serviceWorker' in navigator) {\n    // The URL constructor is available in all browsers that support SW.\n    const publicUrl = new URL(\n      process.env.PUBLIC_URL,\n      window.location.href\n    );\n    if (publicUrl.origin !== window.location.origin) {\n      // Our service worker won't work if PUBLIC_URL is on a different origin\n      // from what our page is served on. This might happen if a CDN is used to\n      // serve assets; see https://github.com/facebook/create-react-app/issues/2374\n      return;\n    }\n\n    window.addEventListener('load', () => {\n      const swUrl = `${process.env.PUBLIC_URL}/service-worker.js`;\n\n      if (isLocalhost) {\n        // This is running on localhost. Let's check if a service worker still exists or not.\n        checkValidServiceWorker(swUrl, config);\n\n        // Add some additional logging to localhost, pointing developers to the\n        // service worker/PWA documentation.\n        navigator.serviceWorker.ready.then(() => {\n          console.log(\n            'This web app is being served cache-first by a service ' +\n              'worker. To learn more, visit https://bit.ly/CRA-PWA'\n          );\n        });\n      } else {\n        // Is not localhost. Just register service worker\n        registerValidSW(swUrl, config);\n      }\n    });\n  }\n}\n\nfunction registerValidSW(swUrl: string, config?: Config) {\n  navigator.serviceWorker\n    .register(swUrl)\n    .then(registration => {\n      registration.onupdatefound = () => {\n        const installingWorker = registration.installing;\n        if (installingWorker == null) {\n          return;\n        }\n        installingWorker.onstatechange = () => {\n          if (installingWorker.state === 'installed') {\n            if (navigator.serviceWorker.controller) {\n              // At this point, the updated precached content has been fetched,\n              // but the previous service worker will still serve the older\n              // content until all client tabs are closed.\n              console.log(\n                'New content is available and will be used when all ' +\n                  'tabs for this page are closed. See https://bit.ly/CRA-PWA.'\n              );\n\n              // Execute callback\n              if (config && config.onUpdate) {\n                config.onUpdate(registration);\n              }\n            } else {\n              // At this point, everything has been precached.\n              // It's the perfect time to display a\n              // \"Content is cached for offline use.\" message.\n              console.log('Content is cached for offline use.');\n\n              // Execute callback\n              if (config && config.onSuccess) {\n                config.onSuccess(registration);\n              }\n            }\n          }\n        };\n      };\n    })\n    .catch(error => {\n      console.error('Error during service worker registration:', error);\n    });\n}\n\nfunction checkValidServiceWorker(swUrl: string, config?: Config) {\n  // Check if the service worker can be found. If it can't reload the page.\n  fetch(swUrl, {\n    headers: { 'Service-Worker': 'script' }\n  })\n    .then(response => {\n      // Ensure service worker exists, and that we really are getting a JS file.\n      const contentType = response.headers.get('content-type');\n      if (\n        response.status === 404 ||\n        (contentType != null && contentType.indexOf('javascript') === -1)\n      ) {\n        // No service worker found. Probably a different app. Reload the page.\n        navigator.serviceWorker.ready.then(registration => {\n          registration.unregister().then(() => {\n            window.location.reload();\n          });\n        });\n      } else {\n        // Service worker found. Proceed as normal.\n        registerValidSW(swUrl, config);\n      }\n    })\n    .catch(() => {\n      console.log(\n        'No internet connection found. App is running in offline mode.'\n      );\n    });\n}\n\nexport function unregister() {\n  if ('serviceWorker' in navigator) {\n    navigator.serviceWorker.ready\n      .then(registration => {\n        registration.unregister();\n      })\n      .catch(error => {\n        console.error(error.message);\n      });\n  }\n}\n","import { AppTheme, AppThemes } from '../constants/themes.constant';\r\nimport { GameConfig, GameRound } from '../models/game.interface';\r\nimport { PlayerInfo } from '../models/player.interface';\r\nimport {\r\n    AppAction,\r\n    RESET_APP_STATE,\r\n    SET_APP_THEME,\r\n    SET_DATA_FOR_NEW_GAME,\r\n    SET_DATA_OF_FINISHED_GAME,\r\n    SET_STORED_PLAYER_INFO,\r\n    SET_STORED_RUNNING_GAME_INFO,\r\n    SetAppThemeAction,\r\n    SetDataForNewGameAction,\r\n    SetDataOfFinishedGameAction,\r\n    SetStoredPlayerInfoAction,\r\n    SetStoredRunningGameInfoAction,\r\n} from './app.actions';\r\n\r\nexport interface AppState {\r\n    activeTheme: AppTheme;\r\n    allPlayers: Map<string, PlayerInfo> | null;\r\n    gameId: string | null;\r\n    gameConfig: GameConfig | null;\r\n    gameRounds: GameRound[] | null;\r\n    isRejoiningGame: boolean;\r\n    playerIdCreationTimestamp: number;\r\n    playerInfo: PlayerInfo | null;\r\n}\r\n\r\nconst initialState: AppState = {\r\n    activeTheme: AppThemes[0],\r\n    allPlayers: null,\r\n    gameId: null,\r\n    gameConfig: null,\r\n    gameRounds: null,\r\n    isRejoiningGame: false,\r\n    playerIdCreationTimestamp: 0,\r\n    playerInfo: null\r\n};\r\n\r\nexport const appReducer = (state: AppState = initialState, action: AppAction): AppState => {\r\n    switch (action.type) {\r\n        case SET_APP_THEME:\r\n            return { ...state, activeTheme: (action as SetAppThemeAction).payload };\r\n        case SET_STORED_PLAYER_INFO:\r\n            const storedPlayerInfo = (action as SetStoredPlayerInfoAction).payload;\r\n            return {\r\n                ...state,\r\n                isRejoiningGame: false,\r\n                playerIdCreationTimestamp: storedPlayerInfo.idCreationTimestamp,\r\n                playerInfo: {\r\n                    id: storedPlayerInfo.id,\r\n                    isAdmin: false,\r\n                    name: storedPlayerInfo.name\r\n                }\r\n            };\r\n        case SET_STORED_RUNNING_GAME_INFO:\r\n            const storedRunningGameInfo = (action as SetStoredRunningGameInfoAction).payload;\r\n            return {\r\n                ...state,\r\n                isRejoiningGame: true,\r\n                gameId: storedRunningGameInfo.gameId,\r\n                playerInfo: {\r\n                    ...state.playerInfo as PlayerInfo,\r\n                    isAdmin: storedRunningGameInfo.isPlayerAdmin\r\n                }\r\n            };\r\n        case SET_DATA_FOR_NEW_GAME:\r\n            return {\r\n                ...state,\r\n                ...(action as SetDataForNewGameAction).payload\r\n            };\r\n        case SET_DATA_OF_FINISHED_GAME:\r\n            return {\r\n                ...state,\r\n                ...(action as SetDataOfFinishedGameAction).payload,\r\n                // Set gameId to null to prevent player from manually opening PlayGame route.\r\n                gameId: null\r\n            };\r\n        case RESET_APP_STATE:\r\n            return {\r\n                ...state,\r\n                allPlayers: null,\r\n                gameId: null,\r\n                gameConfig: null,\r\n                gameRounds: null,\r\n            };\r\n        default:\r\n            return state\r\n    }\r\n};\r\n","import './index.css';\r\nimport React from 'react';\r\nimport ReactDOM from 'react-dom';\r\nimport { createStore } from 'redux';\r\nimport App from './App';\r\nimport * as serviceWorker from './serviceWorker';\r\nimport { appReducer } from './store/app.reducer';\r\nimport { Provider } from 'react-redux';\r\n\r\nexport const appStore = createStore(appReducer);\r\n\r\nReactDOM.render(\r\n  <Provider store={appStore}><App /></Provider>,\r\n  document.getElementById('root')\r\n);\r\n\r\n// If you want your app to work offline and load faster, you can change\r\n// unregister() to register() below. Note this comes with some pitfalls.\r\n// Learn more about service workers: https://bit.ly/CRA-PWA\r\nserviceWorker.unregister();\r\n"],"sourceRoot":""}